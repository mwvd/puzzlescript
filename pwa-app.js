!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=376)}([function(t,e,n){"use strict";function r(t,e,n,r,i,o,a){try{var s=t[o](a),u=s.value}catch(t){return void n(t)}s.done?e(u):Promise.resolve(u).then(r,i)}function i(t){return function(){var e=this,n=arguments;return new Promise(function(i,o){var a=t.apply(e,n);function s(t){r(a,i,o,s,u,"next",t)}function u(t){r(a,i,o,s,u,"throw",t)}s(void 0)})}}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var s,u,l;function c(t){var e=[];return t.forEach(function(t){t.forEach(function(t){e.push(t)})}),e}function f(t){var e;return function(){e&&clearTimeout(e),e=setTimeout(function(){t()},10)}}function h(t){switch(t){case s.UP:return s.DOWN;case s.DOWN:return s.UP;case s.LEFT:return s.RIGHT;case s.RIGHT:return s.LEFT;default:throw new Error('BUG: Invalid direction: "'.concat(t,'"'))}}function d(t,e){if(t.size!==e.size)return!1;var n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;if(!t.has(s))return!1}}catch(t){r=!0,i=t}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return!0}function v(t,e){var n=new Set(t),r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;n.add(u)}}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}function p(t,e){var n=new Set,r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;t.has(u)&&n.add(u)}}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}function y(t,e){var n=new Set(t),r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;n.delete(u)}}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}n.d(e,"d",function(){return s}),n.d(e,"b",function(){return u}),n.d(e,"e",function(){return l}),n.d(e,"g",function(){return c}),n.d(e,"f",function(){return f}),n.d(e,"i",function(){return h}),n.d(e,"n",function(){return d}),n.d(e,"l",function(){return v}),n.d(e,"o",function(){return p}),n.d(e,"m",function(){return y}),n.d(e,"h",function(){return _}),n.d(e,"k",function(){return S}),n.d(e,"q",function(){return k}),n.d(e,"j",function(){return E}),n.d(e,"c",function(){return m}),n.d(e,"p",function(){return T}),n.d(e,"a",function(){return O}),function(t){t.UP="UP",t.DOWN="DOWN",t.LEFT="LEFT",t.RIGHT="RIGHT",t.ACTION="ACTION",t.STATIONARY="STATIONARY",t.RANDOMDIR="RANDOMDIR"}(s||(s={})),function(t){t.UP="UP",t.DOWN="DOWN",t.LEFT="LEFT",t.RIGHT="RIGHT",t.ACTION="ACTION",t.UNDO="UNDO",t.RESTART="RESTART"}(u||(u={})),function(t){t.RELATIVE_LEFT="<",t.RELATIVE_RIGHT=">",t.RELATIVE_UP="^",t.RELATIVE_DOWN="V"}(l||(l={}));var g,m,b=1,w=null;function _(t){if(w){if(w.length<=b-1)throw new Error("BUG: the list of random values for testing was too short.\n            See calls to setRandomValuesForTesting([...]).\n            The list was [".concat(w,"]. Index being requested is ").concat(b-1));var e=w[b-1];return b++,e}var n=1e4*Math.sin(b++);return Math.round((n-Math.floor(n))*(t-1))}function S(){b=1}function k(t){var e=t.getPlayer().getSprites(),n=new Set(e),r=!0,i=!1,o=void 0;try{for(var s,u=n[Symbol.iterator]();!(r=(s=u.next()).done);r=!0){var l=s.value.getCollisionLayer(),c=!0,f=!1,h=void 0;try{for(var d,v=t.objects[Symbol.iterator]();!(c=(d=v.next()).done);c=!0){var y=d.value;y.getCollisionLayer()===l&&n.add(y)}}catch(t){f=!0,h=t}finally{try{c||null==v.return||v.return()}finally{if(f)throw h}}}}catch(t){i=!0,o=t}finally{try{r||null==u.return||u.return()}finally{if(i)throw o}}var g=!0,m=!1,b=void 0;try{for(var w,_=t.winConditions[Symbol.iterator]();!(g=(w=_.next()).done);g=!0){var S=w.value,k=!0,E=!1,T=void 0;try{for(var O,x=S.a11yGetTiles()[Symbol.iterator]();!(k=(O=x.next()).done);k=!0){var C=O.value,M=!0,R=!1,I=void 0;try{for(var A,L=C.getSprites()[Symbol.iterator]();!(M=(A=L.next()).done);M=!0){var P=A.value;n.add(P)}}catch(t){R=!0,I=t}finally{try{M||null==L.return||L.return()}finally{if(R)throw I}}}}catch(t){E=!0,T=t}finally{try{k||null==x.return||x.return()}finally{if(E)throw T}}}}catch(t){m=!0,b=t}finally{try{g||null==_.return||_.return()}finally{if(m)throw b}}var N=!0,D=!1,G=void 0;try{for(var B,F=t.rules[Symbol.iterator]();!(N=(B=F.next()).done);N=!0){var j=B.value,U=!0,W=!1,H=void 0;try{for(var q,z=j.a11yGetConditionSprites()[Symbol.iterator]();!(U=(q=z.next()).done);U=!0){var V=q.value;if(p(V,n).size>0){var K=!0,Y=!1,J=void 0;try{for(var X,$=V[Symbol.iterator]();!(K=(X=$.next()).done);K=!0){var Z=X.value;n.add(Z)}}catch(t){Y=!0,J=t}finally{try{K||null==$.return||$.return()}finally{if(Y)throw J}}}}}catch(t){W=!0,H=t}finally{try{U||null==z.return||z.return()}finally{if(W)throw H}}}}catch(t){D=!0,G=t}finally{try{N||null==F.return||F.return()}finally{if(D)throw G}}var Q=t.getMagicBackgroundSprite();return Q&&n.delete(Q),new Set(a(n).filter(function(t){return!t.isTransparent()}))}function E(t,e){return new Promise(function(n){var r=setInterval(function(){var t=e();t&&(clearInterval(r),n(t))},t)})}!function(t){t.BREAKPOINT="DEBUGGER",t.BREAKPOINT_REMOVE="DEBUGGER_REMOVE"}(g||(g={})),function(t){t.PAUSE="PAUSE",t.RESUME="RESUME",t.TICK="TICK",t.PRESS="PRESS",t.CLOSE="CLOSE",t.ON_GAME_CHANGE="ON_GAME_CHANGE",t.ON_PRESS="ON_PRESS",t.ON_MESSAGE="ON_MESSAGE",t.ON_MESSAGE_DONE="ON_MESSAGE_DONE",t.ON_LEVEL_CHANGE="ON_LEVEL_CHANGE",t.ON_WIN="ON_WIN",t.ON_SOUND="ON_SOUND",t.ON_TICK="ON_TICK",t.ON_PAUSE="ON_PAUSE",t.ON_RESUME="ON_RESUME"}(m||(m={}));var T=function(t,e){var n=Date.now(),r=Math.min(t.realtimeInterval||1e3,t.keyRepeatInterval||1e3,t.againInterval||1e3);return(r>100||Number.isNaN(r))&&(r=.01),n-e>=1e3*r},O=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.subHandlers=e||[]}var e,n,r;return e=t,(n=[{key:"onGameChange",value:function(t){var e=!0,n=!1,r=void 0;try{for(var i,o=this.subHandlers[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value;a.onGameChange&&a.onGameChange(t)}}catch(t){n=!0,r=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}}},{key:"onPress",value:function(t){var e=!0,n=!1,r=void 0;try{for(var i,o=this.subHandlers[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value;a.onPress&&a.onPress(t)}}catch(t){n=!0,r=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}}},{key:"onMessage",value:function(){var t=i(regeneratorRuntime.mark(function t(e){var n,r,i,o,a,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=!0,r=!1,i=void 0,t.prev=3,o=this.subHandlers[Symbol.iterator]();case 5:if(n=(a=o.next()).done){t.next=14;break}if(s=a.value,t.t0=s.onMessage,!t.t0){t.next=11;break}return t.next=11,s.onMessage(e);case 11:n=!0,t.next=5;break;case 14:t.next=20;break;case 16:t.prev=16,t.t1=t.catch(3),r=!0,i=t.t1;case 20:t.prev=20,t.prev=21,n||null==o.return||o.return();case 23:if(t.prev=23,!r){t.next=26;break}throw i;case 26:return t.finish(23);case 27:return t.finish(20);case 28:case"end":return t.stop()}},t,this,[[3,16,20,28],[21,,23,27]])}));return function(e){return t.apply(this,arguments)}}()},{key:"onLevelChange",value:function(t,e,n){var r=!0,i=!1,o=void 0;try{for(var a,s=this.subHandlers[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;u.onLevelChange&&u.onLevelChange(t,e,n)}}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}}},{key:"onWin",value:function(){var t=!0,e=!1,n=void 0;try{for(var r,i=this.subHandlers[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){var o=r.value;o.onWin&&o.onWin()}}catch(t){e=!0,n=t}finally{try{t||null==i.return||i.return()}finally{if(e)throw n}}}},{key:"onSound",value:function(){var t=i(regeneratorRuntime.mark(function t(e){var n,r,i,o,a,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:for(n=!0,r=!1,i=void 0,t.prev=3,o=this.subHandlers[Symbol.iterator]();!(n=(a=o.next()).done);n=!0)(s=a.value).onSound&&s.onSound(e);t.next=11;break;case 7:t.prev=7,t.t0=t.catch(3),r=!0,i=t.t0;case 11:t.prev=11,t.prev=12,n||null==o.return||o.return();case 14:if(t.prev=14,!r){t.next=17;break}throw i;case 17:return t.finish(14);case 18:return t.finish(11);case 19:case"end":return t.stop()}},t,this,[[3,7,11,19],[12,,14,18]])}));return function(e){return t.apply(this,arguments)}}()},{key:"onTick",value:function(t,e,n,r){var i=!0,o=!1,a=void 0;try{for(var s,u=this.subHandlers[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var l=s.value;l.onTick&&l.onTick(t,e,n,r)}}catch(t){o=!0,a=t}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}}},{key:"onPause",value:function(){var t=!0,e=!1,n=void 0;try{for(var r,i=this.subHandlers[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){var o=r.value;o.onPause&&o.onPause()}}catch(t){e=!0,n=t}finally{try{t||null==i.return||i.return()}finally{if(e)throw n}}}},{key:"onResume",value:function(){var t=!0,e=!1,n=void 0;try{for(var r,i=this.subHandlers[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){var o=r.value;o.onResume&&o.onResume()}}catch(t){e=!0,n=t}finally{try{t||null==i.return||i.return()}finally{if(e)throw n}}}}])&&o(e.prototype,n),r&&o(e,r),t}()},function(t,e,n){var r=n(4),i=n(26),o=n(18),a=n(19),s=n(27),u=function t(e,n,u){var l,c,f,h,d=e&t.F,v=e&t.G,p=e&t.P,y=e&t.B,g=v?r:e&t.S?r[n]||(r[n]={}):(r[n]||{}).prototype,m=v?i:i[n]||(i[n]={}),b=m.prototype||(m.prototype={});for(l in v&&(u=n),u)f=((c=!d&&g&&void 0!==g[l])?g:u)[l],h=y&&c?s(f,r):p&&"function"==typeof f?s(Function.call,f):f,g&&a(g,l,f,e&t.U),m[l]!=f&&o(m,l,h),p&&b[l]!=f&&(b[l]=f)};r.core=i,u.F=1,u.G=2,u.S=4,u.P=8,u.B=16,u.W=32,u.U=64,u.R=128,t.exports=u},function(t,e,n){"use strict";var r,i,o,a,s,u,l,c,f,h,d,v,p,y;n.d(e,"e",function(){return r}),n.d(e,"b",function(){return u}),n.d(e,"h",function(){return l}),n.d(e,"i",function(){return c}),n.d(e,"g",function(){return f}),n.d(e,"f",function(){return h}),n.d(e,"a",function(){return d}),n.d(e,"c",function(){return v}),n.d(e,"j",function(){return p}),n.d(e,"d",function(){return y}),function(t){t.RANDOM="RANDOM",t.UP="UP",t.DOWN="DOWN",t.LEFT="LEFT",t.RIGHT="RIGHT",t.VERTICAL="VERTICAL",t.HORIZONTAL="HORIZONTAL",t.ORTHOGONAL="ORTHOGONAL",t.PERPENDICULAR="PERPENDICULAR",t.PARALLEL="PARALLEL",t.MOVING="MOVING",t.LATE="LATE",t.RIGID="RIGID"}(r||(r={})),function(t){t.NO="NO",t.LEFT="LEFT",t.RIGHT="RIGHT",t.UP="UP",t.DOWN="DOWN",t.RANDOMDIR="RANDOMDIR",t.RANDOM="RANDOM",t.STATIONARY="STATIONARY",t.MOVING="MOVING",t.ACTION="ACTION",t.VERTICAL="VERTICAL",t.HORIZONTAL="HORIZONTAL",t.PERPENDICULAR="PERPENDICULAR",t.PARALLEL="PARALLEL",t.ORTHOGONAL="ORTHOGONAL",t.ARROW_ANY="ARROW_ANY"}(i||(i={})),function(t){t.RESTART="RESTART",t.UNDO="UNDO",t.TITLESCREEN="TITLESCREEN",t.STARTGAME="STARTGAME",t.STARTLEVEL="STARTLEVEL",t.ENDLEVEL="ENDLEVEL",t.ENDGAME="ENDGAME",t.SHOWMESSAGE="SHOWMESSAGE",t.CLOSEMESSAGE="CLOSEMESSAGE"}(o||(o={})),function(t){t.UP="UP",t.DOWN="DOWN",t.LEFT="LEFT",t.RIGHT="RIGHT",t.HORIZONTAL="HORIZONTAL",t.VERTICAL="VERTICAL"}(a||(a={})),function(t){t.CREATE="CREATE",t.DESTROY="DESTROY",t.CANTMOVE="CANTMOVE"}(s||(s={})),function(t){t.HEX8="HEX8",t.HEX6="HEX6",t.NAME="NAME"}(u||(u={})),function(t){t.NO_PIXELS="NO_PIXELS",t.WITH_PIXELS="WITH_PIXELS"}(l||(l={})),function(t){t.SIMPLE="LEGEND_ITEM_SIMPLE",t.OR="LEGEND_ITEM_OR",t.AND="LEGEND_ITEM_AND"}(c||(c={})),function(t){t.WHEN="SOUND_WHEN",t.SFX="SOUND_SFX",t.SPRITE_DIRECTION="SOUND_SPRITE_DIRECTION",t.SPRITE_MOVE="SOUND_SPRITE_MOVE",t.SPRITE_EVENT="SOUND_SPRITE_EVENT"}(f||(f={})),function(t){t.GROUP="RULE_GROUP",t.LOOP="RULE_LOOP",t.SIMPLE="RULE_SIMPLE"}(h||(h={})),function(t){t.SIMPLE="BRACKET_SIMPLE",t.ELLIPSIS="BRACKET_ELLIPSIS"}(d||(d={})),function(t){t.MESSAGE="COMMAND_MESSAGE",t.AGAIN="COMMAND_AGAIN",t.CANCEL="COMMAND_CANCEL",t.CHECKPOINT="COMMAND_CHECKPOINT",t.RESTART="COMMAND_RESTART",t.WIN="COMMAND_WIN",t.SFX="COMMAND_SFX"}(v||(v={})),function(t){t.SIMPLE="WINCONDITION_SIMPLE",t.ON="WINCONDITION_ON"}(p||(p={})),function(t){t.MESSAGE="LEVEL_MESSAGE",t.MAP="LEVEL_MAP"}(y||(y={}))},function(t,e,n){var r=n(6);t.exports=function(t){if(!r(t))throw TypeError(t+" is not an object!");return t}},function(t,e){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}t.exports=function(t){return"object"===n(t)?null!==t:"function"==typeof t}},function(t,e,n){"use strict";(function(t){n.d(e,"f",function(){return O}),n.d(e,"g",function(){return x}),n.d(e,"e",function(){return C}),n.d(e,"h",function(){return M}),n.d(e,"b",function(){return A}),n.d(e,"c",function(){return N}),n.d(e,"a",function(){return L}),n.d(e,"d",function(){return B});var r=n(21),i=n(147),o=n(2),a=n(40),s=n(0),u=n(13);function l(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function c(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function f(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function h(t,e,n){return e&&f(t.prototype,e),n&&f(t,n),t}function d(t){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function v(t,e){return!e||"object"!==d(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function y(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&g(t,e)}function g(t,e){return(g=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function m(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var b=n(106),w=50,_=(s.d.RIGHT,s.d.DOWN,s.d.LEFT,s.d.UP,function t(e,n){m(this,t),this.condition=e,this.action=n}),S=function(t){function e(t,n,r){var i;return m(this,e),(i=v(this,p(e).call(this,t,n))).extra=r,i}return y(e,_),e}(),k=function(){function t(e,n){m(this,t),this.cell=e,this.messages=n}return h(t,[{key:"hasCell",value:function(){return!0}},{key:"getCell",value:function(){return this.cell}},{key:"getCommand",value:function(){throw new Error("BUG: check hasCommand first")}}]),t}(),E=function(){function t(e){m(this,t),this.command=e,this.messages=[]}return h(t,[{key:"getCommand",value:function(){return this.command}},{key:"hasCell",value:function(){return!1}},{key:"getCell",value:function(){throw new Error("BUG: check hasCell first")}}]),t}();var T,O=function(t){function e(t,n,r){var i;return m(this,e),(i=v(this,p(e).call(this,t))).rules=r,i.isRandom=n,i}return y(e,u["a"]),h(e,[{key:"hasMatches",value:function(t){var e=!0,n=!1,r=void 0;try{for(var i,o=this.rules[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){if(i.value.hasMatches(t))return!0}}catch(t){n=!0,r=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}return!1}},{key:"evaluate",value:function(t,e){var n;r.b.isLevel(r.a.DEBUG)&&(n=Date.now());var i,o=[];for(i=0;i<350;i++){if(349===i)throw new Error("BUG: Iterated too many times in startloop or + (rule group)\n".concat(this.toString()));if(this.isRandom){var a=this.rules.filter(function(e){return e.hasMatches(t)});return 0===a.length?[]:1===a.length?a[0].evaluate(t,!0):a[Object(s.h)(a.length)].evaluate(t,!0)}var u=!1,l=!0,c=!1,f=void 0;try{for(var h,d=this.rules[Symbol.iterator]();!(l=(h=d.next()).done);l=!0){var v=h.value.evaluate(t,e);if(v.length>0){if(v.filter(function(t){return t.hasCell()}).length>0&&(u=!0),e)return v;o.push(v)}}}catch(t){c=!0,f=t}finally{try{l||null==d.return||d.return()}finally{if(c)throw f}}if(!u)break}return r.b.isLevel(r.a.DEBUG)&&o.length>0&&(n&&Date.now()-n>30?r.b.debug("Rule ".concat(this.__getSourceLineAndColumn().lineNum," applied. ").concat(1===i?"":"(x".concat(i,")")," [[").concat(Date.now()-n,"ms]]")):r.b.debug("Rule ".concat(this.__getSourceLineAndColumn().lineNum," applied. ").concat(1===i?"":"(x".concat(i,")")))),Object(s.g)(o)}},{key:"clearCaches",value:function(){var t=!0,e=!1,n=void 0;try{for(var r,i=this.rules[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){r.value.clearCaches()}}catch(t){e=!0,n=t}finally{try{t||null==i.return||i.return()}finally{if(e)throw n}}}},{key:"getChildRules",value:function(){return this.rules}},{key:"isLate",value:function(){return this.rules[0].isLate()}},{key:"hasRigid",value:function(){var t=!0,e=!1,n=void 0;try{for(var r,i=this.rules[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){if(r.value.hasRigid())return!0}}catch(t){e=!0,n=t}finally{try{t||null==i.return||i.return()}finally{if(e)throw n}}return!1}},{key:"addCellsToEmptyRules",value:function(t){var e=!0,n=!1,r=void 0;try{for(var i,o=this.rules[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){i.value.addCellsToEmptyRules(t)}}catch(t){n=!0,r=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}}},{key:"toKey",value:function(){return this.rules.map(function(t){return t.toKey()}).join("\n")}},{key:"a11yGetConditionSprites",value:function(){var t=[],e=!0,n=!1,r=void 0;try{for(var i,o=this.rules[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value;t=[].concat(c(t),c(a.a11yGetConditionSprites()))}}catch(t){n=!0,r=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}return t}}]),e}(),x=function(t){function e(){return m(this,e),v(this,p(e).apply(this,arguments))}return y(e,O),e}(),C=function(t){function e(t,n,r,i,o,a,s){var u;if(m(this,e),(u=v(this,p(e).call(this,t))).conditionBrackets=n,u.actionBrackets=r,u.commands=i,u._isLate=o,u.isRigid=a,u.debugFlag=s,u.isSubscribedToCellChanges=!1,r.length>0)for(var l=0;l<n.length;l++)n[l].prepareAction(r[l]);return u}return y(e,u["a"]),h(e,[{key:"toKey",value:function(){var t=this.conditionBrackets.map(function(t){return t.toKey()}),e=this.actionBrackets.map(function(t){return t.toKey()}),n=this.commands.map(function(t){return function(t){switch(t.type){case o.c.AGAIN:case o.c.CANCEL:case o.c.CHECKPOINT:case o.c.RESTART:case o.c.WIN:return t.type;case o.c.MESSAGE:return"".concat(t.type,":").concat(t.message);case o.c.SFX:return"".concat(t.type,":").concat(t.sound.type,":").concat(t.sound.soundCode)}}(t)});return"{Late?".concat(this._isLate,"} {Rigid?").concat(this.isRigid,"} ").concat(t," -> ").concat(e," ").concat(n.join(" ")," {debugger?").concat(this.debugFlag,"}")}},{key:"getChildRules",value:function(){return[]}},{key:"subscribeToCellChanges",value:function(){if(!this.isSubscribedToCellChanges){var t=!0,e=!1,n=void 0;try{for(var r,i=this.conditionBrackets[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){r.value.subscribeToNeighborChanges()}}catch(t){e=!0,n=t}finally{try{t||null==i.return||i.return()}finally{if(e)throw n}}this.isSubscribedToCellChanges=!0}}},{key:"clearCaches",value:function(){var t=!0,e=!1,n=void 0;try{for(var r,i=this.conditionBrackets[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){r.value.clearCaches()}}catch(t){e=!0,n=t}finally{try{t||null==i.return||i.return()}finally{if(e)throw n}}}},{key:"getMatches",value:function(t){for(var e=[],n=0;n<this.conditionBrackets.length;n++){var r=this.conditionBrackets[n],i=this.actionBrackets[n],o=r.getMatches(t,i);if(0===o.length)return[];e.push(o)}return e}},{key:"evaluate",value:function(t,e){var n=[];var r=this.getMatches(t);if(0===r.length)return[];if(this.actionBrackets.length>0){var i=function(t){var e=[[]],n=!0,r=!1,i=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,u=[],l=!0,c=!1,f=void 0;try{for(var h,d=s[Symbol.iterator]();!(l=(h=d.next()).done);l=!0)for(var v=h.value,p=0;p<e.length;p++){var y=e[p].concat([v]);u.push(y)}}catch(t){c=!0,f=t}finally{try{l||null==d.return||d.return()}finally{if(c)throw f}}e=u}}catch(t){r=!0,i=t}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return e}(r),o=[],a=!0,u=!1,l=void 0;try{for(var c,f=i[Symbol.iterator]();!(a=(c=f.next()).done);a=!0){var h=c.value,d=!0,v=new Map,p=!0,y=!1,g=void 0;try{for(var m,b=h[Symbol.iterator]();!(p=(m=b.next()).done);p=!0){var w=m.value;if(!w.doesStillMatch()){d=!1;break}w.populateMagicOrTiles(v)}}catch(t){y=!0,g=t}finally{try{p||null==b.return||b.return()}finally{if(y)throw g}}if(d){var _=!0,S=!1,k=void 0;try{for(var T,O=h[Symbol.iterator]();!(_=(T=O.next()).done);_=!0){var x=T.value;x.doesStillMatch()&&o.push(x.evaluate(v))}}catch(t){S=!0,k=t}finally{try{_||null==O.return||O.return()}finally{if(S)throw k}}if(e)break}}}catch(t){u=!0,l=t}finally{try{a||null==f.return||f.return()}finally{if(u)throw l}}n=Object(s.g)(o)}var C=!0,M=!1,R=void 0;try{for(var I,A=this.commands[Symbol.iterator]();!(C=(I=A.next()).done);C=!0){var L=I.value;n.push(new E(L))}}catch(t){M=!0,R=t}finally{try{C||null==A.return||A.return()}finally{if(M)throw R}}return n}},{key:"hasMatches",value:function(t){for(var e=0;e<this.conditionBrackets.length;e++){var n=this.conditionBrackets[e],r=this.actionBrackets[e];if(!n.hasMatches(t,r))return!1}return!0}},{key:"isLate",value:function(){return this._isLate}},{key:"hasRigid",value:function(){return this.isRigid}},{key:"canCollapseBecauseBracketsMatch",value:function(t){for(var e=0;e<this.conditionBrackets.length;e++){if(this.conditionBrackets[e]!==t.conditionBrackets[e])return!1;if(this.conditionBrackets[e]._getAllNeighbors().length>1)return!1}for(var n=0;n<this.actionBrackets.length;n++)if(this.actionBrackets[n]!==t.actionBrackets[n])return!1;return!0}},{key:"addCellsToEmptyRules",value:function(t){var e=!0,n=!1,r=void 0;try{for(var i,o=this.conditionBrackets[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){i.value.addCellsToEmptyRules(t)}}catch(t){n=!0,r=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}}},{key:"a11yGetConditionSprites",value:function(){var t=[],e=!0,n=!1,r=void 0;try{for(var i,o=this.conditionBrackets[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value;t=[].concat(c(t),c(a.a11yGetSprites()))}}catch(t){n=!0,r=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}return t}}]),e}(),M=function(t){function e(t,n,r,i,o,a){var s;return m(this,e),(s=v(this,p(e).call(this,t)))._isNegated=n,s._isRandom=r,s._direction=i,s._tile=o,s.neighbors=new Set,s._debugFlag=a,s.trickleCells=new Set,s}return y(e,u["a"]),h(e,[{key:"toKey",value:function(t){var e=this._tile.getSprites().map(function(t){return t.getName()}).sort();return t?"{-?".concat(this._isNegated,"} {#?").concat(this._isRandom,'} dir="').concat(this._direction,'" [').concat(e.join(" "),"]"):"{-?".concat(this._isNegated,"} {#?").concat(this._isRandom,'} dir="').concat(this._direction,'" [').concat(e.join(" "),"]{debugging?").concat(!!this._debugFlag,"}")}},{key:"equals",value:function(t){return this._isNegated===t._isNegated&&this._tile.equals(t._tile)&&this._direction===t._direction&&this._isRandom===t._isRandom}},{key:"clearCaches",value:function(){}},{key:"isNo",value:function(){return this._isNegated}},{key:"isRandom",value:function(){return this._isRandom}},{key:"getCollisionLayers",value:function(){var t=new Set,e=!0,n=!1,r=void 0;try{for(var i,o=this._tile.getSprites()[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value;t.add(a.getCollisionLayer())}}catch(t){n=!0,r=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}return t}},{key:"subscribeToCellChanges",value:function(t){this.neighbors.add(t),this._tile.subscribeToCellChanges(this)}},{key:"addCells",value:function(t,e,n,r){if(this._direction&&r!==this._direction?this._tile.isOr()&&this.matchesFirstCell(n,r)?!this.isNo():this.isNo():!this.isNo()){var i=!0,o=!1,a=void 0;try{for(var s,u=n[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var l=s.value;this.trickleCells.add(l)}}catch(t){o=!0,a=t}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}var c=!0,f=!1,h=void 0;try{for(var d,v=this.neighbors[Symbol.iterator]();!(c=(d=v.next()).done);c=!0){d.value.addCells(this,e,n,r)}}catch(t){f=!0,h=t}finally{try{c||null==v.return||v.return()}finally{if(f)throw h}}}else{var p=!0,y=!1,g=void 0;try{for(var m,b=n[Symbol.iterator]();!(p=(m=b.next()).done);p=!0){var w=m.value;this.trickleCells.delete(w)}}catch(t){y=!0,g=t}finally{try{p||null==b.return||b.return()}finally{if(y)throw g}}var _=!0,S=!1,k=void 0;try{for(var E,T=this.neighbors[Symbol.iterator]();!(_=(E=T.next()).done);_=!0){E.value.removeCells(this,e,n)}}catch(t){S=!0,k=t}finally{try{_||null==T.return||T.return()}finally{if(S)throw k}}}}},{key:"updateCells",value:function(t,e,n){if(this.matchesFirstCell(e,n)){var r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;this.trickleCells.add(u)}}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}if(n){var l=!0,c=!1,f=void 0;try{for(var h,d=this.neighbors[Symbol.iterator]();!(l=(h=d.next()).done);l=!0){h.value.updateCells(this,t,e,n)}}catch(t){c=!0,f=t}finally{try{l||null==d.return||d.return()}finally{if(c)throw f}}}}else{var v=!0,p=!1,y=void 0;try{for(var g,m=e[Symbol.iterator]();!(v=(g=m.next()).done);v=!0){var b=g.value;this.trickleCells.delete(b)}}catch(t){p=!0,y=t}finally{try{v||null==m.return||m.return()}finally{if(p)throw y}}var w=!0,_=!1,S=void 0;try{for(var k,E=this.neighbors[Symbol.iterator]();!(w=(k=E.next()).done);w=!0){k.value.removeCells(this,t,e)}}catch(t){_=!0,S=t}finally{try{w||null==E.return||E.return()}finally{if(_)throw S}}}}},{key:"removeCells",value:function(t,e,n){if(this._tile.isOr()?this.matchesFirstCell(n,null):this.isNo()){var r=!0,i=!1,o=void 0;try{for(var a,u=n[Symbol.iterator]();!(r=(a=u.next()).done);r=!0){var l=a.value;this.trickleCells.add(l)}}catch(t){i=!0,o=t}finally{try{r||null==u.return||u.return()}finally{if(i)throw o}}var c=!0,f=!1,h=void 0;try{for(var d,v=this.neighbors[Symbol.iterator]();!(c=(d=v.next()).done);c=!0){d.value.addCells(this,e,n,s.d.STATIONARY)}}catch(t){f=!0,h=t}finally{try{c||null==v.return||v.return()}finally{if(f)throw h}}}else{var p=!0,y=!1,g=void 0;try{for(var m,b=n[Symbol.iterator]();!(p=(m=b.next()).done);p=!0){var w=m.value;this.trickleCells.delete(w)}}catch(t){y=!0,g=t}finally{try{p||null==b.return||b.return()}finally{if(y)throw g}}var _=!0,S=!1,k=void 0;try{for(var E,T=this.neighbors[Symbol.iterator]();!(_=(E=T.next()).done);_=!0){E.value.removeCells(this,e,n)}}catch(t){S=!0,k=t}finally{try{_||null==T.return||T.return()}finally{if(S)throw k}}}}},{key:"hasCell",value:function(t){return this.trickleCells.has(t)}},{key:"matchesCellWantsToMove",value:function(t,e){var n=this._tile.hasCell(t);if(this._isNegated!==(n&&(this._direction===e||!this._direction)))return!0;if(this._direction){var r=!0,i=!1,o=void 0;try{for(var a,s=this._tile.getSpritesThatMatch(t)[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;if(this._direction===t.getWantsToMove(u))return!0}}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return!1}return!1}},{key:"matchesFirstCell",value:function(t,e){return this.matchesCellWantsToMove(t[0],e)}}]),e}(),R=function(t){function e(t,n,r,i){var o;return m(this,e),(o=v(this,p(e).call(this,t))).direction=n,o.debugFlag=i,o.allNeighbors=r,o.firstCells=new Set,o}return y(e,u["a"]),h(e,[{key:"_getAllNeighbors",value:function(){return this.allNeighbors}},{key:"hasMatches",value:function(t,e){return this.getMatches(t,e).length>0}}]),e}(),I=function(){function t(e){m(this,t),this.cellsAndNeighbors=e,this.cellKeys=new Map;var n=!0,r=!1,i=void 0;try{for(var o,a=this.cellsAndNeighbors[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value.cell;this.cellKeys.set(s,s.toKey())}}catch(t){r=!0,i=t}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}}return h(t,[{key:"firstCell",value:function(){var t=!0,e=!1,n=void 0;try{for(var r,i=this.cellsAndNeighbors[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){return r.value.cell}}catch(t){e=!0,n=t}finally{try{t||null==i.return||i.return()}finally{if(e)throw n}}throw new Error("BUG: ? No cells were included in the match")}},{key:"lastCell",value:function(){var t,e=!0,n=!1,r=void 0;try{for(var i,o=this.cellsAndNeighbors[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){t=i.value.cell}}catch(t){n=!0,r=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}if(t)return t;throw new Error("BUG: ? No cells were included in the match")}},{key:"doesStillMatch",value:function(){var t=!0,e=!1,n=void 0;try{for(var r,i=this.cellsAndNeighbors[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){var o=r.value,a=o.cell,s=o.condition;if(a.toKey()!==this.cellKeys.get(a)){if(!s.matchesCellSimple(a))return!1;this.cellKeys.set(a,a.toKey())}}}catch(t){e=!0,n=t}finally{try{t||null==i.return||i.return()}finally{if(e)throw n}}return!0}},{key:"populateMagicOrTiles",value:function(t){var e=!0,n=!1,r=void 0;try{for(var i,o=this.cellsAndNeighbors[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value,s=a.cell;a.condition.populateMagicOrTiles(s,t)}}catch(t){n=!0,r=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}}},{key:"evaluate",value:function(t){var e=[],n=!0,r=!1,i=void 0;try{for(var o,a=this.cellsAndNeighbors[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,u=s.cell,l=s.condition,c=s.action;if(!c)throw new Error("BUG: Should not have tried to evaluate something when there is no action");var f=l.evaluate(c,u,t);f&&e.push(f)}}catch(t){r=!0,i=t}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return e}}]),t}(),A=function(e){function n(t,e,r,i){var o;m(this,n),(o=v(this,p(n).call(this,t,e,r,i))).actionDebugFlag=null,o.neighbors=r,o.ellipsisBracketListeners=new Map,o.spritesPresentInRowOrColumn=o.neighbors[0].spritesPresent.union(o.neighbors.map(function(t){return t.spritesPresent}));var s=[],u=!0,l=!1,c=void 0;try{for(var f,h=o.neighbors[Symbol.iterator]();!(u=(f=h.next()).done);u=!0){var d=f.value,y=!0,g=!1,b=void 0;try{for(var w,_=d.anySpritesPresent[Symbol.iterator]();!(y=(w=_.next()).done);y=!0){var S=w.value;s.push(S)}}catch(t){g=!0,b=t}finally{try{y||null==_.return||_.return()}finally{if(g)throw b}}}}catch(t){l=!0,c=t}finally{try{u||null==h.return||h.return()}finally{if(l)throw c}}return o.anySpritesPresentInRowOrColumn=(new a.a).union(s),o}return y(n,R),h(n,[{key:"toKey",value:function(){var t=this.dependsOnDirection()?this.direction:"";return"{".concat(t,"[").concat(this.neighbors.map(function(t){return t.toKey()}).join("|"),"]{debugging?").concat(!!this.debugFlag,"}}")}},{key:"dependsOnDirection",value:function(){return this.neighbors.length>1||!!this.neighbors.find(function(t){return t.dependsOnDirection()})}},{key:"subscribeToNeighborChanges",value:function(){var t=this;this.shouldUseOnDemandMethod()||this.neighbors.forEach(function(e,n){e.subscribeToTileChanges(t,n)})}},{key:"addEllipsisBracket",value:function(t,e){this.ellipsisBracketListeners.set(t,e)}},{key:"clearCaches",value:function(){this.firstCells.clear();var t=!0,e=!1,n=void 0;try{for(var r,i=this.neighbors[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){r.value.clearCaches()}}catch(t){e=!0,n=t}finally{try{t||null==i.return||i.return()}finally{if(e)throw n}}}},{key:"getNeighbors",value:function(){return this.neighbors}},{key:"prepareAction",value:function(t){var e=t;this.actionDebugFlag=e.debugFlag;for(var n=0;n<this.neighbors.length;n++){var r=this.neighbors[n],i=e.neighbors[n];r.prepareAction(i)}}},{key:"addCellsToEmptyRules",value:function(t){if(1===this.neighbors.length&&0===this.neighbors[0]._tilesWithModifier.size){var e=!0,n=!1,r=void 0;try{for(var i,o=t[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value;this._addFirstCell(a)}}catch(t){n=!0,r=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}}}},{key:"_addFirstCell",value:function(t){this.firstCells.add(t);var e=!0,n=!1,r=void 0;try{for(var i,o=this.ellipsisBracketListeners[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=l(i.value,2),s=a[0],u=a[1];s.addFirstCell(this,t,u)}}catch(t){n=!0,r=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}}},{key:"addCell",value:function(t,e,n,r,i,o){if(this.matchesDownstream(i,t)){var a=this.matchesUpstream(i,t);if(a)this._addFirstCell(a);else{var s=this.getUpstream(i,t);s&&this._removeFirstCell(s)}}else{this.getUpstream(i,t)&&this._removeFirstCell(i)}}},{key:"removeCell",value:function(t,e,n,r,i){var o=this.getFirstCellToRemove(i,t);o&&this.firstCells.has(o)&&this._removeFirstCell(o)}},{key:"shouldUseOnDemandMethod",value:function(){return"ondemand"===t.env.PUZZLESCRIPT_METHOD}},{key:"getMatchesByTrickling",value:function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=this.firstCells[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;this.addToCellMatches(n,u,e)}}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}},{key:"getMatchesByLooping",value:function(t,e){var n=[],r=t.getCells(),i=r.length,o=r[0].length;switch(this.direction){case s.d.UP:case s.d.DOWN:for(var a=0;a<o;a++)if(t.colContainsSprites(a,this.spritesPresentInRowOrColumn,this.anySpritesPresentInRowOrColumn))for(var u=0;u<i;u++)this.addIfCellMatches(n,t.getCell(u,a),e);break;case s.d.LEFT:case s.d.RIGHT:for(var l=0;l<i;l++)if(t.rowContainsSprites(l,this.spritesPresentInRowOrColumn,this.anySpritesPresentInRowOrColumn))for(var c=0;c<o;c++)this.addIfCellMatches(n,t.getCell(l,c),e);break;default:throw new Error('BUG: Unsupported Direction "'.concat(this.direction,'"'))}return n}},{key:"getMatches",value:function(e,n){var r;if(this.shouldUseOnDemandMethod())r=this.getMatchesByLooping(e,n);else if(r=this.getMatchesByTrickling(e,n),t.env.VERIFY_MATCHES){var i=this.getMatchesByLooping(e,n);if(r.length!==i.length)throw this.getMatchesByTrickling(e,n),this.getMatchesByLooping(e,n),new Error("Match lengths differ. Expected ".concat(i.length," but found ").concat(r.length,". \n").concat(this.toString()))}return r}},{key:"a11yGetSprites",value:function(){var t=new Set,e=!0,n=!1,r=void 0;try{for(var i,o=this.neighbors[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value,s=!0,u=!1,l=void 0;try{for(var c,f=a._tilesWithModifier[Symbol.iterator]();!(s=(c=f.next()).done);s=!0){var h=c.value,d=!0,v=!1,p=void 0;try{for(var y,g=h._tile.getSprites()[Symbol.iterator]();!(d=(y=g.next()).done);d=!0){var m=y.value;t.add(m)}}catch(t){v=!0,p=t}finally{try{d||null==g.return||g.return()}finally{if(v)throw p}}}}catch(t){u=!0,l=t}finally{try{s||null==f.return||f.return()}finally{if(u)throw l}}}}catch(t){n=!0,r=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}return[t]}},{key:"_removeFirstCell",value:function(t){if(this.firstCells.has(t)){0,this.firstCells.delete(t);var e=!0,n=!1,r=void 0;try{for(var i,o=this.ellipsisBracketListeners[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=l(i.value,2),s=a[0],u=a[1];s.removeFirstCell(this,t,u)}}catch(t){n=!0,r=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}}}},{key:"matchesDownstream",value:function(t,e){for(var n=!0,r=t,i=e+1;i<this.neighbors.length;i++)if(!(r=r.getNeighbor(this.direction))||0!==this.neighbors[i]._tilesWithModifier.size&&!this.neighbors[i].matchesCellSimple(r)){n=!1;break}return n}},{key:"getUpstream",value:function(t,e){for(var n=t,r=e-1;r>=0;r--)if(!(n=n.getNeighbor(Object(s.i)(this.direction))))return null;return n}},{key:"matchesUpstream",value:function(t,e){for(var n=!0,r=t,i=e-1;i>=0;i--)if(!(r=r.getNeighbor(Object(s.i)(this.direction)))||0!==this.neighbors[i]._tilesWithModifier.size&&!this.neighbors[i].matchesCellSimple(r)){n=!1;break}return n?r:null}},{key:"getFirstCellToRemove",value:function(t,e){for(var n=!0,r=t,i=e-1;i>=0;i--)if(!(r=r.getNeighbor(Object(s.i)(this.direction)))){n=!1;break}return n?r:null}},{key:"addToCellMatches",value:function(t,e,n){for(var r=[],i=e,o=!0,a=0;a<this.neighbors.length;a++){if(!i){o=!1;break}var s=this.neighbors[a],u=null;n&&(u=n.neighbors[a]||null);var l={cell:i,condition:s,action:u};r.push(l),i=i.getNeighbor(this.direction)}o&&t.push(new I(r))}},{key:"addIfCellMatches",value:function(t,e,n){this.neighbors[0].matchesCellSimple(e)&&this.matchesDownstream(e,0)&&this.addToCellMatches(t,e,n)}}]),n}();!function(t){t[t.BEFORE=0]="BEFORE",t[t.AFTER=1]="AFTER"}(T||(T={}));var L,P=function(){function t(){m(this,t),this.map=new Map}return h(t,[{key:"clear",value:function(){this.map.clear()}},{key:"getB",value:function(t){return this.map.get(t)}},{key:"add",value:function(t,e){var n=this.map.get(t);return n||(n=new Set,this.map.set(t,n)),!n.has(e)&&(n.add(e),!0)}},{key:"deleteAllA",value:function(t){this.map.delete(t)}},{key:"deleteAllB",value:function(t){var e=new Set,n=!0,r=!1,i=void 0;try{for(var o,a=this.map[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=l(o.value,2),u=s[0],c=s[1];c.has(t)&&(c.delete(t),0===c.size&&(this.map.delete(u),e.add(u)))}}catch(t){r=!0,i=t}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return e}},{key:"sizeA",value:function(){return this.map.size}}]),t}(),N=function(t){function e(t,n,r,i,o){var a;return m(this,e),(a=v(this,p(e).call(this,t,n,[].concat(c(r),c(i)),o))).beforeEllipsisBracket=new A(t,n,r,o),a.afterEllipsisBracket=new A(t,n,i,o),a.linkages=new P,a}return y(e,R),h(e,[{key:"subscribeToNeighborChanges",value:function(){this.beforeEllipsisBracket.subscribeToNeighborChanges(),this.afterEllipsisBracket.subscribeToNeighborChanges(),this.beforeEllipsisBracket.addEllipsisBracket(this,T.BEFORE),this.afterEllipsisBracket.addEllipsisBracket(this,T.AFTER)}},{key:"toKey",value:function(){return"[".concat(this.direction," ").concat(this.beforeEllipsisBracket.toKey()," ... ").concat(this.afterEllipsisBracket.toKey(),"]}")}},{key:"clearCaches",value:function(){this.firstCells.clear(),this.linkages.clear(),this.beforeEllipsisBracket.clearCaches(),this.afterEllipsisBracket.clearCaches()}},{key:"prepareAction",value:function(t){var e=t;this.beforeEllipsisBracket.prepareAction(e.beforeEllipsisBracket),this.afterEllipsisBracket.prepareAction(e.afterEllipsisBracket)}},{key:"addCellsToEmptyRules",value:function(t){this.beforeEllipsisBracket.addCellsToEmptyRules(t),this.afterEllipsisBracket.addCellsToEmptyRules(t)}},{key:"addCell",value:function(t,e,n,r,i,o){throw new Error("BUG: We should not be subscribed to these events")}},{key:"removeCell",value:function(t,e,n,r,i){throw new Error("BUG: We should not be subscribed to these events")}},{key:"addFirstCell",value:function(t,e,n){}},{key:"removeFirstCell",value:function(t,e,n){if(this.checkInvariants(),t===this.beforeEllipsisBracket){if(this.linkages.deleteAllA(e),this.firstCells.has(e))throw new Error("BUG: Unreachable code")}else{if(t!==this.afterEllipsisBracket)throw new Error("BUG: Bracket should only ever be the before-ellipsis or after-ellipsis one");if(this.linkages.deleteAllB(e).size>0)throw new Error("BUG: Unreachable code")}this.checkInvariants()}},{key:"getMatches",value:function(t,e){var n,r,i=[];e?(n=this.beforeEllipsisBracket.getMatches(t,e.beforeEllipsisBracket),r=this.afterEllipsisBracket.getMatches(t,e.afterEllipsisBracket)):(n=this.beforeEllipsisBracket.getMatches(t,null),r=this.afterEllipsisBracket.getMatches(t,null));var o=new P;if(0===n.length||0===r.length)return[];switch(this.direction){case s.d.UP:case s.d.DOWN:var a=!0,u=!1,l=void 0;try{for(var f,h=n[Symbol.iterator]();!(a=(f=h.next()).done);a=!0){var d=f.value;o.add(d.lastCell().colIndex,d)}}catch(t){u=!0,l=t}finally{try{a||null==h.return||h.return()}finally{if(u)throw l}}var v=!0,p=!1,y=void 0;try{for(var g,m=r[Symbol.iterator]();!(v=(g=m.next()).done);v=!0){var b=g.value,w=b.firstCell(),_=w.colIndex,S=w.rowIndex,k=!0,E=!1,T=void 0;try{for(var O,x=(o.getB(_)||[])[Symbol.iterator]();!(k=(O=x.next()).done);k=!0){var C=O.value,M=C.lastCell().rowIndex;(this.direction===s.d.DOWN?M<S:S<M)&&i.push(new I(c(C.cellsAndNeighbors).concat(c(b.cellsAndNeighbors))))}}catch(t){E=!0,T=t}finally{try{k||null==x.return||x.return()}finally{if(E)throw T}}}}catch(t){p=!0,y=t}finally{try{v||null==m.return||m.return()}finally{if(p)throw y}}break;case s.d.LEFT:case s.d.RIGHT:var R=!0,A=!1,L=void 0;try{for(var N,D=n[Symbol.iterator]();!(R=(N=D.next()).done);R=!0){var G=N.value;o.add(G.lastCell().rowIndex,G)}}catch(t){A=!0,L=t}finally{try{R||null==D.return||D.return()}finally{if(A)throw L}}var B=!0,F=!1,j=void 0;try{for(var U,W=r[Symbol.iterator]();!(B=(U=W.next()).done);B=!0){var H=U.value,q=H.firstCell(),z=(S=q.rowIndex,_=q.colIndex,!0),V=!1,K=void 0;try{for(var Y,J=(o.getB(S)||[])[Symbol.iterator]();!(z=(Y=J.next()).done);z=!0){var X=Y.value,$=X.lastCell().colIndex;(this.direction===s.d.RIGHT?$<_:_<$)&&i.push(new I(c(X.cellsAndNeighbors).concat(c(H.cellsAndNeighbors))))}}catch(t){V=!0,K=t}finally{try{z||null==J.return||J.return()}finally{if(V)throw K}}}}catch(t){F=!0,j=t}finally{try{B||null==W.return||W.return()}finally{if(F)throw j}}break;default:throw new Error("BUG: Invalid direction ".concat(this.direction))}return i}},{key:"a11yGetSprites",value:function(){return[].concat(c(this.beforeEllipsisBracket.a11yGetSprites()),c(this.afterEllipsisBracket.a11yGetSprites()))}},{key:"checkInvariants",value:function(){if(this.firstCells.size!==this.linkages.sizeA())throw new Error("BUG: Invariant violation")}}]),e}();!function(t){t.ADD="ADD",t.REPLACE="REPLACE",t.REMOVE="REMOVE",t.MOVE="MOVE"}(L||(L={}));var D=function(){function t(e,n,r,i,o){if(m(this,t),!e)throw new Error("BUG: collisionLayer is not set");this.collisionLayer=e,this.actionTileWithModifier=n,this.mightNotFindConditionButThatIsOk=r,this.conditionSpritesToRemove=i,this.newDirection=o}return h(t,[{key:"replace",value:function(t,e,n){var r=!1,i=[];if(this.actionTileWithModifier){var o;if(this.actionTileWithModifier.isRandom()){var a=this.actionTileWithModifier._tile.getSprites();o=[a[Object(s.h)(a.length)]]}else if(this.actionTileWithModifier._tile.isOr()){var u=e.get(this.actionTileWithModifier._tile);if(!u)throw new Error("BUG: Magic OR tile not found\n".concat(this.actionTileWithModifier.toString()));o=u}else o=this.actionTileWithModifier._tile.getSprites();var l=[],c=[],f=!0,h=!1,d=void 0;try{for(var v,p=o[Symbol.iterator]();!(f=(v=p.next()).done);f=!0){var y=v.value,g=y.getCollisionLayer(),m=this.newDirection||t.getCollisionLayerWantsToMove(g),b=void 0;if(t.hasSprite(y)){if(!m)throw new Error("BUG: Invariant violation. if the sprite exists then wantsToMove must also exist (at least it would be STATIONARY)");b=t.updateSprite(y,m)}else{var w=t.getSpriteByCollisionLayer(g);w?c.push({oldSprite:w,newSprite:y}):l.push(y),b=t.addSprite(y,m)}r=r||b}}catch(t){h=!0,d=t}finally{try{f||null==p.return||p.return()}finally{if(h)throw d}}i.push({type:L.ADD,cell:t,sprites:l}),i.push({type:L.REPLACE,cell:t,replacements:c})}else{var _=new Set,S=t.getSpriteByCollisionLayer(this.collisionLayer);if(!S&&this.mightNotFindConditionButThatIsOk)return{didActuallyChange:!1,messages:[]};if(!S)throw new Error("BUG: No tile found");if(!this.conditionSpritesToRemove)throw new Error("BUG: Not implemented (just commented out)");if(this.conditionSpritesToRemove._tile.isOr()){if(!n.has(this.conditionSpritesToRemove._tile)){var k=S.getSprites(),E=!0,T=!1,O=void 0;try{for(var x,C=this.conditionSpritesToRemove._tile.getSprites()[Symbol.iterator]();!(E=(x=C.next()).done);E=!0){var M=x.value;if(k.indexOf(M)>=0){var R=t.removeSprite(M);_.add(M),r=r||R,R&&n.add(this.conditionSpritesToRemove._tile);break}}}catch(t){T=!0,O=t}finally{try{E||null==C.return||C.return()}finally{if(T)throw O}}}}else{var I=new Set(this.conditionSpritesToRemove._tile.getSprites()),A=!0,P=!1,N=void 0;try{for(var D,G=S.getSprites()[Symbol.iterator]();!(A=(D=G.next()).done);A=!0){var B=D.value;if(I.has(B)){var F=t.removeSprite(B);_.add(B),r=r||F}}}catch(t){P=!0,N=t}finally{try{A||null==G.return||G.return()}finally{if(P)throw N}}}i.push({type:L.REMOVE,cell:t,sprites:_})}return{didActuallyChange:r,messages:i}}}]),t}(),G=function(){function t(e,n,r){if(m(this,t),!e)throw new Error("BUG: collisionLayer is not set");this.collisionLayer=e,this.direction=n,this.mightNotFindConditionButThatIsOk=r}return h(t,[{key:"replace",value:function(t){var e=this.direction;if(this.mightNotFindConditionButThatIsOk&&!t.getSpriteByCollisionLayer(this.collisionLayer))return{didActuallyChange:!1};if(this.direction===s.d.RANDOMDIR){if(t.getCollisionLayerWantsToMove(this.collisionLayer)!==s.d.STATIONARY)return{didActuallyChange:!1};switch(Object(s.h)(4)){case 0:e=s.d.UP;break;case 1:e=s.d.DOWN;break;case 2:e=s.d.LEFT;break;case 3:e=s.d.RIGHT;break;default:throw new Error("BUG: invalid random number chosen")}}return{didActuallyChange:t.setWantsToMoveCollisionLayer(this.collisionLayer,e)}}}]),t}(),B=function(t){function e(t,n,r){var o;m(this,e),(o=v(this,p(e).call(this,t)))._tilesWithModifier=n,o.brackets=new Map,o.debugFlag=r,o.staticCache=new Map,o.spritesPresent=new a.a,o.spritesMissing=new a.a,o.anySpritesPresent=new Set,o.spriteMovementsPresent=new Map,o.orTileMovementsPresent=new Map,o.trickleCells=new Set,o.lruCache=new i.a(w),o.cacheYesBitSets=new Map,o.cacheNoBitSets=new Map,o.cacheDirections=new Map,o.cacheMultiCollisionLayerTiles=new Set;var s=c(n),u=s.filter(function(t){return t.isNo()}),l=s.filter(function(t){return!t.isNo()}),f=!0,h=!1,d=void 0;try{for(var y,g=l[Symbol.iterator]();!(f=(y=g.next()).done);f=!0){var _=y.value;if(_._tile.hasSingleCollisionLayer()){var S=!0,k=!1,E=void 0;try{for(var T,O=_._tile.getSprites()[Symbol.iterator]();!(S=(T=O.next()).done);S=!0){var x=T.value,C=x.getCollisionLayer();_._direction&&o.cacheDirections.set(C,_._direction);var M=o.cacheYesBitSets.get(C);M||(M=new b,o.cacheYesBitSets.set(C,M)),M.set(C.getBitSetIndexOf(x))}}catch(t){k=!0,E=t}finally{try{S||null==O.return||O.return()}finally{if(k)throw E}}}else o.cacheMultiCollisionLayerTiles.add(_);if(_._tile.isOr())o.anySpritesPresent.add(new a.a(_._tile.getSprites())),_._direction&&o.orTileMovementsPresent.set(_._tile,_._direction);else{o.spritesPresent.addAll(_._tile.getSprites());var R=!0,I=!1,A=void 0;try{for(var L,P=_._tile.getSprites()[Symbol.iterator]();!(R=(L=P.next()).done);R=!0){var N=L.value;if(_._direction){var D=o.spriteMovementsPresent.get(N.getCollisionLayer());if(D&&D!==_._direction)throw new Error("BUG??? prev=".concat(D," ").concat(_._direction));o.spriteMovementsPresent.set(N.getCollisionLayer(),_._direction)}}}catch(t){I=!0,A=t}finally{try{R||null==P.return||P.return()}finally{if(I)throw A}}}}}catch(t){h=!0,d=t}finally{try{f||null==g.return||g.return()}finally{if(h)throw d}}var G=!0,B=!1,F=void 0;try{for(var j,U=u[Symbol.iterator]();!(G=(j=U.next()).done);G=!0){var W=j.value;if(W._tile.hasSingleCollisionLayer()){var H=!0,q=!1,z=void 0;try{for(var V,K=W._tile.getSprites()[Symbol.iterator]();!(H=(V=K.next()).done);H=!0){var Y=V.value,J=Y.getCollisionLayer();if(W._direction)throw new Error("BUG: Unreachable code");var X=o.cacheNoBitSets.get(J);X||(X=new b,o.cacheNoBitSets.set(J,X)),X.set(J.getBitSetIndexOf(Y))}}catch(t){q=!0,z=t}finally{try{H||null==K.return||K.return()}finally{if(q)throw z}}}else o.cacheMultiCollisionLayerTiles.add(W);W._tile.isOr(),o.spritesMissing.addAll(W._tile.getSprites())}}catch(t){B=!0,F=t}finally{try{G||null==U.return||U.return()}finally{if(B)throw F}}return o}return y(e,u["a"]),h(e,[{key:"toKey",value:function(){return"{".concat(c(this._tilesWithModifier).map(function(t){return t.toKey()}).sort().join(" ")," debugging?").concat(!!this.debugFlag,"}")}},{key:"dependsOnDirection",value:function(){return!!c(this._tilesWithModifier).find(function(t){return!!t._direction})}},{key:"prepareAction",value:function(t){if(!this.staticCache.has(t)){var e=new Map,n=new Map,r=!0,i=!1,o=void 0;try{for(var a,u=this._tilesWithModifier[Symbol.iterator]();!(r=(a=u.next()).done);r=!0){var c=a.value;if(c._tile.isOr()&&!c._tile.hasSingleCollisionLayer())c.isNo()||n.set(c._tile,c);else if(c._tile.hasSingleCollisionLayer()){var f=c._tile.getCollisionLayer();if(!f)throw new Error("BUG: Tile is not assigned to a collision layer\n".concat(c._tile.toString()));e.has(f)||e.set(f,new S(c,null,!1))}else{var h=!0,d=!1,v=void 0;try{for(var p,y=c._tile.getSprites()[Symbol.iterator]();!(h=(p=y.next()).done);h=!0){var g=p.value.getCollisionLayer();e.has(g)||e.set(g,new S(c,null,!1))}}catch(t){d=!0,v=t}finally{try{h||null==y.return||y.return()}finally{if(d)throw v}}}}}catch(t){i=!0,o=t}finally{try{r||null==u.return||u.return()}finally{if(i)throw o}}var m=new Map(n.entries()),b=!0,w=!1,_=void 0;try{for(var k,E=t._tilesWithModifier[Symbol.iterator]();!(b=(k=E.next()).done);b=!0){var T=k.value;if(T._tile.isOr()&&!T._tile.hasSingleCollisionLayer()){var O=n.get(T._tile);if(O){m.delete(T._tile);var x=O;if(x._direction!==T._direction){var C=!0,R=!1,I=void 0;try{for(var A,L=T._tile.getSprites()[Symbol.iterator]();!(C=(A=L.next()).done);C=!0){var P=A.value,N=P.getCollisionLayer();e.has(N)||e.set(N,new S(new M(x.__source,x._isNegated,x._isRandom,x._direction,P,x._debugFlag),new M(T.__source,T._isNegated,T._isRandom,T._direction,P,T._debugFlag),!0))}}catch(t){R=!0,I=t}finally{try{C||null==L.return||L.return()}finally{if(R)throw I}}}}else if(T.isNo()){var B=!0,F=!1,j=void 0;try{for(var U,W=T._tile.getSprites()[Symbol.iterator]();!(B=(U=W.next()).done);B=!0){var H=U.value.getCollisionLayer();if(!e.has(H)){var q=new M(T.__source,!1,T._isRandom,T._direction,T._tile,T._debugFlag);e.set(H,new S(q,null,!0))}}}catch(t){F=!0,j=t}finally{try{B||null==W.return||W.return()}finally{if(F)throw j}}}else{var z=!0,V=!1,K=void 0;try{for(var Y,J=T._tile.getSprites()[Symbol.iterator]();!(z=(Y=J.next()).done);z=!0){var X=Y.value.getCollisionLayer();if(!e.has(X)){var $=new M(T.__source,!1,T._isRandom,T._direction,T._tile,T._debugFlag);e.set(X,new S(null,$,!0))}}}catch(t){V=!0,K=t}finally{try{z||null==J.return||J.return()}finally{if(V)throw K}}}}else{var Z=!0,Q=!1,tt=void 0;try{for(var et,nt=T.getCollisionLayers()[Symbol.iterator]();!(Z=(et=nt.next()).done);Z=!0){var rt=et.value;if(!rt)throw new Error("BUG: Tile is not assigned to a collision layer.\n".concat(T._tile.toString()));var it=e.get(rt),ot=it&&it.condition||null;if(ot&&ot.equals(T))e.delete(rt);else if(T.isNo())if(it){if(it.condition===T)throw new Error("BUG: Unreachable code")}else{var at=new M(T.__source,!1,!1,T._direction,T._tile,T._debugFlag);e.set(rt,new S(at,null,!0))}else it?it.action=T:e.set(rt,new S(null,T,!1))}}catch(t){Q=!0,tt=t}finally{try{Z||null==nt.return||nt.return()}finally{if(Q)throw tt}}}}}catch(t){w=!0,_=t}finally{try{b||null==E.return||E.return()}finally{if(w)throw _}}if(m.size>0){var st=!0,ut=!1,lt=void 0;try{for(var ct,ft=m.values()[Symbol.iterator]();!(st=(ct=ft.next()).done);st=!0){var ht=ct.value,dt=!0,vt=!1,pt=void 0;try{for(var yt,gt=ht._tile.getSprites()[Symbol.iterator]();!(dt=(yt=gt.next()).done);dt=!0){var mt=yt.value.getCollisionLayer();if(!e.has(mt)){var bt=new M(ht.__source,!1,!1,ht._direction,ht._tile,ht._debugFlag);e.set(mt,new S(bt,null,!0))}}}catch(t){vt=!0,pt=t}finally{try{dt||null==gt.return||gt.return()}finally{if(vt)throw pt}}}}catch(t){ut=!0,lt=t}finally{try{st||null==ft.return||ft.return()}finally{if(ut)throw lt}}}var wt=new Set,_t=new Set,St=!0,kt=!1,Et=void 0;try{for(var Tt,Ot=e.entries()[Symbol.iterator]();!(St=(Tt=Ot.next()).done);St=!0){var xt=l(Tt.value,2),Ct=xt[0],Mt=xt[1],Rt=Mt.condition,It=Mt.action,At=Mt.extra;if(Rt&&It){if(Rt!==It){var Lt=null;(Rt._direction!==It._direction||Rt.isNo())&&(Lt=It._direction||s.d.STATIONARY),!Rt._tile.equals(It._tile)||Rt.isNo()?wt.add(new D(Ct,It,At,null,Lt)):Lt&&_t.add(new G(Ct,Lt,At))}}else Rt?Rt.isNo()||wt.add(new D(Ct,null,At,Rt,null)):It&&(It.isNo()||wt.add(new D(Ct,It,At,null,It._direction||s.d.STATIONARY)))}}catch(t){kt=!0,Et=t}finally{try{St||null==Ot.return||Ot.return()}finally{if(kt)throw Et}}this.staticCache.set(t,{replaceTiles:wt,replaceDirections:_t})}}},{key:"evaluate",value:function(t,e,n){var r=this.staticCache.get(t);if(!r)throw new Error("BUG: Missing actionNeighbor. Should have been prepared before");var i=r.replaceTiles,o=r.replaceDirections,a=!1,s=!1,u=new Set,l=[],f=!0,h=!1,d=void 0;try{for(var v,p=i[Symbol.iterator]();!(f=(v=p.next()).done);f=!0){var y=v.value.replace(e,n,u),g=y.didActuallyChange,m=y.messages;g&&(l=[].concat(c(l),c(m))),a=a||g||!1}}catch(t){h=!0,d=t}finally{try{f||null==p.return||p.return()}finally{if(h)throw d}}var b=!0,w=!1,_=void 0;try{for(var S,E=o[Symbol.iterator]();!(b=(S=E.next()).done);b=!0){g=S.value.replace(e).didActuallyChange;s=s||g}}catch(t){w=!0,_=t}finally{try{b||null==E.return||E.return()}finally{if(w)throw _}}return a||s?new k(e,l):null}},{key:"clearCaches",value:function(){var t=!0,e=!1,n=void 0;try{for(var r,i=this._tilesWithModifier[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){r.value.clearCaches()}}catch(t){e=!0,n=t}finally{try{t||null==i.return||i.return()}finally{if(e)throw n}}}},{key:"populateMagicOrTiles",value:function(t,e){var n=!0,r=!1,i=void 0;try{for(var o,a=this._tilesWithModifier[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var u=o.value;if(!u.isNo()&&u._tile.isOr()){var l=Object(s.o)(new Set(u._tile.getSprites()),t.getSpritesAsSet());e.set(u._tile,l)}}}catch(t){r=!0,i=t}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}}},{key:"subscribeToTileChanges",value:function(t,e){var n=this,r=this.brackets.get(t);r||(r=new Set,this.brackets.set(t,r)),r.add(e),this._tilesWithModifier.forEach(function(t){t.subscribeToCellChanges(n)})}},{key:"matchesCellSimple",value:function(t){return this.matchesCell(t,null,null)}},{key:"addCells",value:function(t,e,n,r){var i=!0,o=!1,a=void 0;try{for(var s,u=n[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value;if(this.matchesTiles(c)){this.trickleCells.add(c);var f=!0,h=!1,d=void 0;try{for(var v,p=this.brackets.entries()[Symbol.iterator]();!(f=(v=p.next()).done);f=!0){var y=l(v.value,2),g=y[0],m=y[1],b=!0,w=!1,_=void 0;try{for(var S,k=m[Symbol.iterator]();!(b=(S=k.next()).done);b=!0){var E=S.value;g.addCell(E,this,t,e,c,r)}}catch(t){w=!0,_=t}finally{try{b||null==k.return||k.return()}finally{if(w)throw _}}}}catch(t){h=!0,d=t}finally{try{f||null==p.return||p.return()}finally{if(h)throw d}}}else if(this.trickleCells.has(c))throw new Error("BUG: Should be unreachable")}}catch(t){o=!0,a=t}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}}},{key:"updateCells",value:function(t,e,n,r){this.addCells(t,e,n,r)}},{key:"removeCells",value:function(t,e,n){var r=!0,i=!1,o=void 0;try{for(var a,s=n[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;if(!this.matchesTiles(u)){this.trickleCells.delete(u);var c=!0,f=!1,h=void 0;try{for(var d,v=this.brackets.entries()[Symbol.iterator]();!(c=(d=v.next()).done);c=!0){var p=l(d.value,2),y=p[0],g=p[1],m=!0,b=!1,w=void 0;try{for(var _,S=g[Symbol.iterator]();!(m=(_=S.next()).done);m=!0){var k=_.value;y.removeCell(k,this,t,e,u)}}catch(t){b=!0,w=t}finally{try{m||null==S.return||S.return()}finally{if(b)throw w}}}}catch(t){f=!0,h=t}finally{try{c||null==v.return||v.return()}finally{if(f)throw h}}}}}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}}},{key:"matchesCell",value:function(t,e,n){var r=this;return this.lruCache.get("[".concat(t.toKey(),"]"),function(){var e=t.spriteBitSet.containsAll(r.spritesPresent)&&t.spriteBitSet.containsNone(r.spritesMissing);if(e){var n=!0,i=!1,o=void 0;try{for(var a,s=r.anySpritesPresent[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var u=a.value;e=e&&t.spriteBitSet.containsAny(u)}}catch(t){i=!0,o=t}finally{try{n||null==s.return||s.return()}finally{if(i)throw o}}}if(e){var c=!0,f=!1,h=void 0;try{for(var d,v=r.spriteMovementsPresent[Symbol.iterator]();!(c=(d=v.next()).done);c=!0){var p=l(d.value,2),y=p[0];p[1]!==t.getCollisionLayerWantsToMove(y)&&(e=!1)}}catch(t){f=!0,h=t}finally{try{c||null==v.return||v.return()}finally{if(f)throw h}}}if(e){var g=!0,m=!1,b=void 0;try{for(var w,_=r.orTileMovementsPresent[Symbol.iterator]();!(g=(w=_.next()).done);g=!0){var S=l(w.value,2),k=S[0],E=S[1];if(k.hasSingleCollisionLayer())E!==t.getCollisionLayerWantsToMove(k.getCollisionLayer())&&(e=!1);else{var T=!1,O=!1,x=!0,C=!1,M=void 0;try{for(var R,I=k.getSprites()[Symbol.iterator]();!(x=(R=I.next()).done);x=!0){var A=R.value;t.spriteBitSet.has(A)&&(T=!0,E===t.getCollisionLayerWantsToMove(A.getCollisionLayer())&&(O=!0))}}catch(t){C=!0,M=t}finally{try{x||null==I.return||I.return()}finally{if(C)throw M}}if(e=e&&O,!T)throw new Error("BUG: Could not find sprite. One should have already been matched before")}}}catch(t){m=!0,b=t}finally{try{g||null==_.return||_.return()}finally{if(m)throw b}}}return e})}},{key:"matchesTiles",value:function(t){var e=!0,n=!1,r=void 0;try{for(var i,o=this._tilesWithModifier[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){if(!i.value.hasCell(t))return!1}}catch(t){n=!0,r=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}return!0}}]),e}()}).call(this,n(107))},function(t,e,n){var r=n(63)("wks"),i=n(42),o=n(4).Symbol,a="function"==typeof o;(t.exports=function(t){return r[t]||(r[t]=a&&o[t]||(a?o:i)("Symbol."+t))}).store=r},function(t,e,n){var r=n(29),i=Math.min;t.exports=function(t){return t>0?i(r(t),9007199254740991):0}},function(t,e,n){t.exports=!n(5)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,e,n){var r=n(3),i=n(110),o=n(31),a=Object.defineProperty;e.f=n(10)?Object.defineProperty:function(t,e,n){if(r(t),e=o(e,!0),r(n),i)try{return a(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},function(t,e,n){var r=n(32);t.exports=function(t){return Object(r(t))}},function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function i(t,e){for(var n=1,r=1,i=0,o=0,a=null,s=null,u=-1;i<e;){var l=t.charAt(i++);"\n"===l?(n++,r=1,u=o,o=i):"\r"!==l&&r++}var c=t.indexOf("\n",o);if(-1===c)c=t.length;else{var f=t.indexOf("\n",c+1);a=(a=-1===f?t.slice(c):t.slice(c,f)).replace(/^\r?\n/,"").replace(/\r$/,"")}return u>=0&&(s=t.slice(u,o).replace(/\r?\n$/,"")),{lineNum:n,colNum:r,line:t.slice(o,c).replace(/\r$/,""),prevLine:s,nextLine:a}}n.d(e,"a",function(){return o});var o=function(){function t(e){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),!e)throw new Error("BUG: failed to provide the source when constructing this object");this.__source=e,this.__coverageCount=null}var e,n,o;return e=t,(n=[{key:"__getSourceLineAndColumn",value:function(){var t=this.__source;return i(t.code,t.sourceOffset)}},{key:"toString",value:function(){var t=this.__source,e=i(t.code,t.sourceOffset),n=e.lineNum,r=e.colNum,o=e.line;return"".concat(o,"\nSource: ").concat(n,":").concat(r)}},{key:"toSourceString",value:function(){var t=this.__source,e=i(t.code,t.sourceOffset).lineNum;return t.code.split("\n")[e-1]}},{key:"__getLineAndColumnRange",value:function(){var t=this.__source,e=i(t.code,t.sourceOffset),n=e.lineNum,r=e.colNum;return{start:{line:n,col:r},end:{line:n,col:r+1}}}},{key:"__incrementCoverage",value:function(){0}}])&&r(e.prototype,n),o&&r(e,o),t}()},function(t,e,n){"use strict";n.d(e,"d",function(){return p}),n.d(e,"f",function(){return y}),n.d(e,"e",function(){return g}),n.d(e,"c",function(){return b}),n.d(e,"a",function(){return w}),n.d(e,"b",function(){return _});var r=n(0),i=n(13);function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function l(t,e,n){return e&&u(t.prototype,e),n&&u(t,n),t}function c(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function h(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&d(t,e)}function d(t,e){return(d=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var v=n(106),p=function(t){function e(t,n,r){var i;return s(this,e),(i=c(this,f(e).call(this,t))).name=n,i._optionalLegendChar=r,i.trickleCells=new Set,i.trickleTiles=new Set,i.trickleTilesWithModifier=new Set,i.allSpritesBitSetIndex=-1,i.collisionLayer=null,i.bitSet=null,i}return h(e,i["a"]),l(e,[{key:"isOr",value:function(){return!1}},{key:"equals",value:function(t){return this===t}},{key:"getName",value:function(){return this.name}},{key:"isBackground",value:function(){return"background"===this.name.toLowerCase()}},{key:"_getDescendantTiles",value:function(){return[]}},{key:"getSprites",value:function(){return[this]}},{key:"hasCollisionLayer",value:function(){return!!this.collisionLayer}},{key:"hasSingleCollisionLayer",value:function(){return this.hasCollisionLayer()}},{key:"setCollisionLayer",value:function(t){this.collisionLayer=t}},{key:"setCollisionLayerAndIndex",value:function(t,e){this.collisionLayer=t,this.bitSet=new v,this.bitSet.set(e)}},{key:"getCollisionLayer",value:function(){if(!this.collisionLayer)throw new Error("ERROR: This sprite was not in a Collision Layer\n".concat(this.toString()));return this.collisionLayer}},{key:"clearCaches",value:function(){this.trickleCells.clear()}},{key:"hasCell",value:function(t){return this.trickleCells.has(t)}},{key:"matchesCell",value:function(t){return t.getSpritesAsSet().has(this)}},{key:"getSpritesThatMatch",value:function(t){return t.getSpritesAsSet().has(this)?new Set([this]):new Set}},{key:"subscribeToCellChanges",value:function(t){this.trickleTilesWithModifier.add(t)}},{key:"subscribeToCellChangesTile",value:function(t){this.trickleTiles.add(t)}},{key:"addCell",value:function(t,e){this.addCells(this,[t],e)}},{key:"removeCell",value:function(t){this.removeCells(this,[t])}},{key:"updateCell",value:function(t,e){var n=!0,r=!1,i=void 0;try{for(var o,a=this.trickleTiles[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){o.value.updateCells(this,[t],e)}}catch(t){r=!0,i=t}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}var s=!0,u=!1,l=void 0;try{for(var c,f=this.trickleTilesWithModifier[Symbol.iterator]();!(s=(c=f.next()).done);s=!0){c.value.updateCells(this,[t],e)}}catch(t){u=!0,l=t}finally{try{s||null==f.return||f.return()}finally{if(u)throw l}}}},{key:"addCells",value:function(t,e,n){var r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;if(this.trickleCells.has(u))throw new Error("BUG: should not be trying to add a cell that has already been matched (right?)");this.trickleCells.add(u)}}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}var l=!0,c=!1,f=void 0;try{for(var h,d=this.trickleTiles[Symbol.iterator]();!(l=(h=d.next()).done);l=!0){h.value.addCells(this,e,n)}}catch(t){c=!0,f=t}finally{try{l||null==d.return||d.return()}finally{if(c)throw f}}var v=!0,p=!1,y=void 0;try{for(var g,m=this.trickleTilesWithModifier[Symbol.iterator]();!(v=(g=m.next()).done);v=!0){g.value.addCells(this,this,e,n)}}catch(t){p=!0,y=t}finally{try{v||null==m.return||m.return()}finally{if(p)throw y}}}},{key:"updateCells",value:function(t,e,n){throw new Error("BUG: Unreachable code")}},{key:"removeCells",value:function(t,e){var n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;this.trickleCells.delete(s)}}catch(t){r=!0,i=t}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}var u=!0,l=!1,c=void 0;try{for(var f,h=this.trickleTiles[Symbol.iterator]();!(u=(f=h.next()).done);u=!0){f.value.removeCells(this,e)}}catch(t){l=!0,c=t}finally{try{u||null==h.return||h.return()}finally{if(l)throw c}}var d=!0,v=!1,p=void 0;try{for(var y,g=this.trickleTilesWithModifier[Symbol.iterator]();!(d=(y=g.next()).done);d=!0){y.value.removeCells(this,this,e)}}catch(t){v=!0,p=t}finally{try{d||null==g.return||g.return()}finally{if(v)throw p}}}},{key:"has",value:function(t){return this.trickleCells.has(t)}},{key:"hasNegationTileWithModifier",value:function(){var t=!0,e=!1,n=void 0;try{for(var r,i=this.trickleTilesWithModifier[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){if(r.value.isNo())return!0}}catch(t){e=!0,n=t}finally{try{t||null==i.return||i.return()}finally{if(e)throw n}}var o=!0,a=!1,s=void 0;try{for(var u,l=this.trickleTiles[Symbol.iterator]();!(o=(u=l.next()).done);o=!0){if(u.value.hasNegationTileWithModifier())return!0}}catch(t){a=!0,s=t}finally{try{o||null==l.return||l.return()}finally{if(a)throw s}}return!1}},{key:"getCellsThatMatch",value:function(t){var e=this;return this.trickleCells.size>0?this.trickleCells:t?new Set(a(t).filter(function(t){return e.matchesCell(t)})):new Set}}]),e}(),y=function(t){function e(t,n,r,i){var o;return s(this,e),(o=c(this,f(e).call(this,t,n,r))).color=i[0],o}return h(e,p),l(e,[{key:"isTransparent",value:function(){return this.color.isTransparent()}},{key:"hasAlpha",value:function(){return this.color.hasAlpha()}},{key:"hasPixels",value:function(){return!1}},{key:"getPixels",value:function(t,e){for(var n=[],r=0;r<t;r++){n.push([]);for(var i=0;i<e;i++)n[r].push(this.color)}return n}}]),e}(),g=function(t){function e(t,n,r,i){var o;s(this,e),(o=c(this,f(e).call(this,t,n,r))).pixels=i,o._isTransparent=!0,o._hasAlpha=!1;var a=!0,u=!1,l=void 0;try{for(var h,d=i[Symbol.iterator]();!(a=(h=d.next()).done);a=!0){var v=h.value,p=!0,y=!1,g=void 0;try{for(var m,b=v[Symbol.iterator]();!(p=(m=b.next()).done);p=!0){var w=m.value;w.isTransparent()||(o._isTransparent=!1),w.hasAlpha()&&(o._hasAlpha=!0)}}catch(t){y=!0,g=t}finally{try{p||null==b.return||b.return()}finally{if(y)throw g}}}}catch(t){u=!0,l=t}finally{try{a||null==d.return||d.return()}finally{if(u)throw l}}return o}return h(e,p),l(e,[{key:"isTransparent",value:function(){return this._isTransparent}},{key:"hasAlpha",value:function(){return this._hasAlpha}},{key:"getSprites",value:function(){return[this]}},{key:"hasPixels",value:function(){return!0}},{key:"getPixels",value:function(t,e){return this.pixels.map(function(t){return t.map(function(t){return t})})}}]),e}(),m=function(t){function e(t,n,r){var i;return s(this,e),(i=c(this,f(e).call(this,t))).spriteNameOrLevelChar=n,i.tiles=r,i.trickleCells=new Set,i.trickleTilesWithModifier=new Set,i.collisionLayer=null,i.spritesCache=null,i}return h(e,i["a"]),l(e,[{key:"equals",value:function(t){return this.isOr()===t.isOr()&&0===Object(r.m)(new Set(this.getSprites()),t.getSprites()).size}},{key:"isOr",value:function(){return!1}},{key:"getName",value:function(){return this.spriteNameOrLevelChar}},{key:"_getDescendantTiles",value:function(){return this.tiles.concat(Object(r.g)(this.tiles.map(function(t){return t._getDescendantTiles()})))}},{key:"getSprites",value:function(){return this.spritesCache||(this.spritesCache=Object(r.g)(this.tiles.map(function(t){return t.getSprites()})).sort(function(t,e){return t.getCollisionLayer().id-e.getCollisionLayer().id}).reverse()),this.spritesCache}},{key:"setCollisionLayer",value:function(t){this.collisionLayer=t}},{key:"getCollisionLayer",value:function(){if(this.collisionLayer)return this.collisionLayer;var t=this.getSprites()[0].getCollisionLayer(),e=!0,n=!1,r=void 0;try{for(var i,o=this.getSprites()[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){if(i.value.getCollisionLayer()!==t)throw new Error("ooh, sprites in a tile have different collision layers... that's a problem\n".concat(this.toString()))}}catch(t){n=!0,r=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}return t}},{key:"getCollisionLayers",value:function(){var t=new Set,e=!0,n=!1,r=void 0;try{for(var i,o=this.getSprites()[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var s=i.value;t.add(s.getCollisionLayer())}}catch(t){n=!0,r=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}return a(t)}},{key:"getCellsThatMatch",value:function(t){var e=new Set,n=!0,r=!1,i=void 0;try{for(var o,a=this.getSprites()[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,u=!0,l=!1,c=void 0;try{for(var f,h=s.getCellsThatMatch(t)[Symbol.iterator]();!(u=(f=h.next()).done);u=!0){var d=f.value;e.add(d)}}catch(t){l=!0,c=t}finally{try{u||null==h.return||h.return()}finally{if(l)throw c}}}}catch(t){r=!0,i=t}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return e}},{key:"subscribeToCellChanges",value:function(t){this.trickleTilesWithModifier.add(t);var e=!0,n=!1,r=void 0;try{for(var i,o=this.getSprites()[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){i.value.subscribeToCellChangesTile(this)}}catch(t){n=!0,r=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}}},{key:"hasNegationTileWithModifier",value:function(){var t=!0,e=!1,n=void 0;try{for(var r,i=this.trickleTilesWithModifier[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){if(r.value.isNo())return!0}}catch(t){e=!0,n=t}finally{try{t||null==i.return||i.return()}finally{if(e)throw n}}return!1}},{key:"addCells",value:function(t,e,n){var r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;if(!this.trickleCells.has(u)&&this.matchesCell(u)){this.trickleCells.add(u);var l=!0,c=!1,f=void 0;try{for(var h,d=this.trickleTilesWithModifier[Symbol.iterator]();!(l=(h=d.next()).done);l=!0){h.value.addCells(this,t,[u],n)}}catch(t){c=!0,f=t}finally{try{l||null==d.return||d.return()}finally{if(c)throw f}}}}}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}}},{key:"updateCells",value:function(t,e,n){var r=!0,i=!1,o=void 0;try{for(var a,s=this.trickleTilesWithModifier[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){a.value.updateCells(t,e,n)}}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}}},{key:"removeCells",value:function(t,e){var n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;if(this.matchesCell(s))this.trickleCells.has(s)?this.updateCells(t,[s],null):this.addCells(t,[s],null);else{this.trickleCells.delete(s);var u=!0,l=!1,c=void 0;try{for(var f,h=this.trickleTilesWithModifier[Symbol.iterator]();!(u=(f=h.next()).done);u=!0){f.value.removeCells(this,t,[s])}}catch(t){l=!0,c=t}finally{try{u||null==h.return||h.return()}finally{if(l)throw c}}}}}catch(t){r=!0,i=t}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}}},{key:"hasCell",value:function(t){return this.trickleCells.has(t)}}]),e}(),b=function(t){function e(t,n,r){return s(this,e),c(this,f(e).call(this,t,n,[r]))}return h(e,m),l(e,[{key:"matchesCell",value:function(t){var e=!0,n=!1,r=void 0;try{for(var i,o=this.tiles[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){if(!i.value.matchesCell(t))return!1}}catch(t){n=!0,r=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}return!0}},{key:"getSpritesThatMatch",value:function(t){return Object(r.o)(new Set(this.getSprites()),t.getSpritesAsSet())}},{key:"hasSingleCollisionLayer",value:function(){return!!this.collisionLayer}}]),e}(),w=function(t){function e(){return s(this,e),c(this,f(e).apply(this,arguments))}return h(e,m),l(e,[{key:"matchesCell",value:function(t){throw new Error("BUG: Unreachable code")}},{key:"getSpritesThatMatch",value:function(t){throw new Error("BUG: This method should only be called for OR tiles")}},{key:"hasSingleCollisionLayer",value:function(){return!!this.collisionLayer}}]),e}(),_=function(t){function e(){return s(this,e),c(this,f(e).apply(this,arguments))}return h(e,m),l(e,[{key:"isOr",value:function(){return!0}},{key:"matchesCell",value:function(t){var e=!0,n=!1,r=void 0;try{for(var i,o=this.tiles[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){if(i.value.matchesCell(t))return!0}}catch(t){n=!0,r=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}return!1}},{key:"getSpritesThatMatch",value:function(t){return Object(r.o)(new Set(this.getSprites()),t.getSpritesAsSet())}},{key:"hasSingleCollisionLayer",value:function(){var t=this.getSprites(),e=!0,n=!1,r=void 0;try{for(var i,o=t[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){if(i.value.getCollisionLayer()!==t[0].getCollisionLayer())return!1}}catch(t){n=!0,r=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}return!0}}]),e}()},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e,n){"use strict";n.d(e,"a",function(){return d}),n.d(e,"b",function(){return v}),n.d(e,"c",function(){return p});var r=n(13);function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function f(t,e,n){return e&&c(t.prototype,e),n&&c(t,n),t}var h=function(){function t(e,n,r,i){l(this,t),this.r=e,this.g=n,this.b=r,this.a=i}return f(t,[{key:"isDark",value:function(){return this.r+this.g+this.b<384}}]),t}(),d=function(t){function e(t,n){var r;return l(this,e),(r=o(this,a(e).call(this,t))).hex=n,r}return s(e,r["a"]),f(e,[{key:"isTransparent",value:function(){return!1}},{key:"hasAlpha",value:function(){return this.hex.length>7}},{key:"toRgb",value:function(){return p(this.hex)}},{key:"toHex",value:function(){return this.hex}}]),e}(),v=function(t){function e(t){return l(this,e),o(this,a(e).call(this,t))}return s(e,r["a"]),f(e,[{key:"isTransparent",value:function(){return!0}},{key:"hasAlpha",value:function(){return!1}},{key:"toRgb",value:function(){throw new Error("BUG: Transparent colors do not have RGB data")}},{key:"toHex",value:function(){throw new Error("BUG: Transparent colors do not have a hex color value")}}]),e}();function p(t){t=t.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(t,e,n,r){return e+e+n+n+r+r});var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})?$/i.exec(t);if(e)return new h(parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16),e[4]?parseInt(e[4],16)/255:null);throw new Error("BUG: Invalid hex color: '".concat(t,"'"))}},function(t,e,n){"use strict";var r,i,o,a,s,u={id:"Wireless Controller (STANDARD GAMEPAD)",buttons:{ARROW_UP:12,ARROW_DOWN:13,ARROW_LEFT:14,ARROW_RIGHT:15,HOME:16,START:9,SELECT:8,CLUSTER_TOP:3,CLUSTER_LEFT:2,CLUSTER_RIGHT:1,CLUSTER_BOTTOM:0,BUMPER_TOP_LEFT:4,BUMPER_BOTTOM_LEFT:6,BUMPER_TOP_RIGHT:5,BUMPER_BOTTOM_RIGHT:7,STICK_PRESS_LEFT:10,STICK_PRESS_RIGHT:11},sticks:{LEFT:{xAxis:0,yAxis:1},RIGHT:{xAxis:2,yAxis:3}},analogs:{}},l=[u,{id:"54c-9cc-Wireless Controller",buttons:{ARROW_UP:14,ARROW_DOWN:15,ARROW_LEFT:16,ARROW_RIGHT:17,HOME:12,START:9,SELECT:8,CLUSTER_TOP:3,CLUSTER_LEFT:0,CLUSTER_RIGHT:2,CLUSTER_BOTTOM:1,BUMPER_TOP_LEFT:4,BUMPER_BOTTOM_LEFT:6,BUMPER_TOP_RIGHT:5,BUMPER_BOTTOM_RIGHT:7,STICK_PRESS_LEFT:10,STICK_PRESS_RIGHT:11,TOUCHSCREEN:13},sticks:{LEFT:{xAxis:0,yAxis:1},RIGHT:{xAxis:2,yAxis:5}},analogs:{BUMPER_LEFT:3,BUMPER_RIGHT:4}},{id:"[temp xbox id]",buttons:{ARROW_UP:12,ARROW_DOWN:13,ARROW_LEFT:14,ARROW_RIGHT:15,HOME:16,START:9,SELECT:8,CLUSTER_TOP:3,CLUSTER_LEFT:2,CLUSTER_RIGHT:1,CLUSTER_BOTTOM:0,BUMPER_TOP_LEFT:4,BUMPER_BOTTOM_LEFT:6,BUMPER_TOP_RIGHT:5,BUMPER_BOTTOM_RIGHT:7,STICK_PRESS_LEFT:10,STICK_PRESS_RIGHT:11},sticks:{LEFT:{xAxis:0,yAxis:1},RIGHT:{xAxis:2,yAxis:3}},analogs:{}},{id:"54c-268-PLAYSTATION(R)3 Controller",buttons:{ARROW_UP:4,ARROW_DOWN:6,ARROW_LEFT:7,ARROW_RIGHT:5,HOME:16,START:3,SELECT:0,CLUSTER_TOP:12,CLUSTER_LEFT:15,CLUSTER_RIGHT:13,CLUSTER_BOTTOM:14,BUMPER_TOP_LEFT:10,BUMPER_BOTTOM_LEFT:8,BUMPER_TOP_RIGHT:11,BUMPER_BOTTOM_RIGHT:9,STICK_PRESS_LEFT:1,STICK_PRESS_RIGHT:2},sticks:{LEFT:{xAxis:0,yAxis:1},RIGHT:{xAxis:2,yAxis:3}},analogs:{}},{id:"45e-28e-Xbox 360 Wired Controller",buttons:{ARROW_UP:0,ARROW_DOWN:1,ARROW_LEFT:2,ARROW_RIGHT:3,HOME:10,START:4,SELECT:5,CLUSTER_TOP:14,CLUSTER_LEFT:13,CLUSTER_RIGHT:12,CLUSTER_BOTTOM:11,BUMPER_TOP_LEFT:8,BUMPER_TOP_RIGHT:9,STICK_PRESS_LEFT:6,STICK_PRESS_RIGHT:7},sticks:{LEFT:{xAxis:0,yAxis:1},RIGHT:{xAxis:3,yAxis:4}},analogs:{BUMPER_LEFT:2,BUMPER_RIGHT:5}},{id:"79-6-Generic   USB  Joystick  ",buttons:{ARROW_UP:12,ARROW_DOWN:13,ARROW_LEFT:14,ARROW_RIGHT:15,START:9,CLUSTER_TOP:3,CLUSTER_LEFT:8,CLUSTER_RIGHT:2,CLUSTER_BOTTOM:6,BUMPER_TOP_LEFT:4,BUMPER_BOTTOM_LEFT:7,BUMPER_TOP_RIGHT:5,STICK_PRESS_LEFT:0,STICK_PRESS_RIGHT:1},sticks:{LEFT:{xAxis:1,yAxis:2}},analogs:{}}];function c(t){return"standard"===t.mapping?u:l.find(function(e){return t.id===e.id})||null}function f(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function h(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function d(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function v(t,e,n){return e&&d(t.prototype,e),n&&d(t,n),t}n.d(e,"a",function(){return r}),n.d(e,"c",function(){return i}),n.d(e,"b",function(){return g}),function(t){t.ARROW_UP="ARROW_UP",t.ARROW_DOWN="ARROW_DOWN",t.ARROW_LEFT="ARROW_LEFT",t.ARROW_RIGHT="ARROW_RIGHT",t.HOME="HOME",t.START="START",t.SELECT="SELECT",t.CLUSTER_TOP="CLUSTER_TOP",t.CLUSTER_LEFT="CLUSTER_LEFT",t.CLUSTER_RIGHT="CLUSTER_RIGHT",t.CLUSTER_BOTTOM="CLUSTER_BOTTOM",t.BUMPER_TOP_LEFT="BUMPER_TOP_LEFT",t.BUMPER_BOTTOM_LEFT="BUMPER_BOTTOM_LEFT",t.BUMPER_TOP_RIGHT="BUMPER_TOP_RIGHT",t.BUMPER_BOTTOM_RIGHT="BUMPER_BOTTOM_RIGHT",t.STICK_PRESS_LEFT="STICK_PRESS_LEFT",t.STICK_PRESS_RIGHT="STICK_PRESS_RIGHT",t.TOUCHSCREEN="TOUCHSCREEN"}(r||(r={})),function(t){t.LEFT="LEFT",t.RIGHT="RIGHT"}(i||(i={})),function(t){t.BUMPER_LEFT="BUMPER_LEFT",t.BUMPER_RIGHT="BUMPER_RIGHT"}(o||(o={})),function(t){t.UP="UP",t.DOWN="DOWN",t.LEFT="LEFT",t.RIGHT="RIGHT"}(a||(a={})),function(t){t.ALT="ALT",t.CTRL="CTRL",t.META="META",t.SHIFT="SHIFT"}(s||(s={}));var p=function(){function t(e){if(h(this,t),!(e>=0))throw new Error("Must provide an index. Or, use the AnyGamepad class");this.index=e}return v(t,[{key:"isSomethingConnected",value:function(){return!!this.raw()}},{key:"isRecognized",value:function(){var t=this.raw();return!!t&&null!==c(t)}},{key:"isButtonPressed",value:function(t){var e=this.raw();if(e){var n=this.buttonIndex(t);return null!==n&&e.buttons[n].pressed}return!1}},{key:"hasButton",value:function(t){return null!==this.buttonIndex(t)}},{key:"button",value:function(t){var e=this;return{has:function(){return e.hasButton(t)},query:function(){return e.isButtonPressed(t)}}}},{key:"getStickValue",value:function(t){var e=this.raw();if(e){var n=this.stickIndex(t);if(n){var r=n.xAxis,i=n.yAxis;return{x:e.axes[r],y:e.axes[i]}}}return{x:0,y:0}}},{key:"getStickDirection",value:function(t){var e=this.getStickValue(t),n=e.x,r=e.y,i=Math.abs(n),o=Math.abs(r);return i<.5&&o<.5?null:i>o?n>0?a.LEFT:a.RIGHT:r>0?a.DOWN:a.UP}},{key:"hasStick",value:function(t){return null!==this.stickIndex(t)}},{key:"stick",value:function(t){var e=this;return{has:function(){return e.hasStick(t)},query:function(){return e.getStickValue(t)},direction:function(){return e.getStickDirection(t)}}}},{key:"raw",value:function(){return f(navigator.getGamepads())[this.index]||null}},{key:"buttonIndex",value:function(t){var e=this.raw();return e&&function(t,e){var n=c(t);if(n){var r=n.buttons[e];if(void 0!==r)return r}return null}(e,t)}},{key:"stickIndex",value:function(t){var e=this.raw();return e&&function(t,e){var n=c(t);return n&&n.sticks[e]||null}(e,t)}}]),t}(),y=function(){function t(){h(this,t)}return v(t,[{key:"isSomethingConnected",value:function(){return!!g.getGamepads().find(function(t){return!!t&&t.isSomethingConnected()})}},{key:"isRecognized",value:function(){return!!g.getGamepads().find(function(t){return!!t&&t.isRecognized()})}},{key:"hasButton",value:function(t){return!!g.getGamepads().find(function(e){return!!e&&e.hasButton(t)})}},{key:"isButtonPressed",value:function(t){var e=!0,n=!1,r=void 0;try{for(var i,o=g.getGamepads()[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value;if(a&&a.isButtonPressed(t))return!0}}catch(t){n=!0,r=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}return!1}},{key:"button",value:function(t){var e=this;return{has:function(){return e.hasButton(t)},query:function(){return e.isButtonPressed(t)}}}},{key:"hasStick",value:function(t){return!!g.getGamepads().find(function(e){return!!e&&e.hasStick(t)})}},{key:"getStickValue",value:function(t){var e=0,n=0,r=!0,i=!1,o=void 0;try{for(var a,s=g.getGamepads()[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;if(u){var l=u.getStickValue(t),c=l.x,f=l.y;e+=c,n+=f}}}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return{x:e,y:n}}},{key:"getStickDirection",value:function(t){var e=g.getGamepads().find(function(e){return!!e&&null!==e.getStickDirection(t)})||null;return e&&e.getStickDirection(t)}},{key:"stick",value:function(t){var e=this;return{has:function(){return e.hasStick(t)},query:function(){return e.getStickValue(t)},direction:function(){return e.getStickDirection(t)}}}}]),t}(),g=new(function(){function t(){h(this,t),this.cache=[],this.any=null}return v(t,[{key:"getGamepads",value:function(){var t=this;return f(navigator.getGamepads()).map(function(e,n){return e&&t.getGamepad(n)})}},{key:"getGamepad",value:function(t){return this.cache[t]=this.cache[t]||new p(t),this.cache[t]}},{key:"getAnyGamepad",value:function(){if(this.any)return this.any;var t=new y;return this.any=t,t}},{key:"key",value:function(t,e,n){var r=new Set(n||[]),i=!1,o=function(t,e){return t.has(s.ALT)===e.altKey&&t.has(s.CTRL)===e.ctrlKey&&t.has(s.META)===e.metaKey&&t.has(s.SHIFT)===e.shiftKey},a=function t(e,n){return e===n||!(null===n||!n.parentElement)&&t(e,n.parentElement)},u=function(n){n.key===t&&o(r,n)&&(e&&!a(e,window.document.activeElement)||(i=!0,n.preventDefault()))},l=function(n){n.key===t&&o(r,n)&&(e&&!a(e,window.document.activeElement)||(i=!1,n.preventDefault()))};return window.addEventListener("keydown",u),window.addEventListener("keyup",l),{has:function(){return!0},query:function(){return i},dispose:function(){window.removeEventListener("keydown",u),window.removeEventListener("keyup",l)}}}},{key:"or",value:function(t){return{has:function(){return!!t.find(function(t){return t.has()})},query:function(){return!!t.find(function(t){return t.query()})}}}},{key:"asStick",value:function(t,e,n,r){function i(){return{x:0+(t.query()?-1:0)+(e.query()?1:0),y:0+(n.query()?-1:0)+(r.query()?1:0)}}return{query:i,has:function(){return t.has()&&e.has()&&n.has()&&r.has()},direction:function(){var t=i(),e=t.x,n=t.y;return e<0&&0===n?a.UP:e>0&&0===n?a.DOWN:n<0&&0===e?a.LEFT:n>0&&0===e?a.RIGHT:null}}}},{key:"orSticks",value:function(t){function e(){var e=0,n=0,r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value.query(),l=u.x,c=u.y;e+=l,n+=c}}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return{x:e,y:n}}return{query:e,has:function(){return!!t.find(function(t){return t.has()})},direction:function(){var t=e(),n=t.x,r=t.y;return n<0&&0===r?a.UP:n>0&&0===r?a.DOWN:r<0&&0===n?a.LEFT:r>0&&0===n?a.RIGHT:null}}}}]),t}())},function(t,e,n){var r=n(11),i=n(41);t.exports=n(10)?function(t,e,n){return r.f(t,e,i(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e,n){var r=n(4),i=n(18),o=n(22),a=n(42)("src"),s=Function.toString,u=(""+s).split("toString");n(26).inspectSource=function(t){return s.call(t)},(t.exports=function(t,e,n,s){var l="function"==typeof n;l&&(o(n,"name")||i(n,"name",e)),t[e]!==n&&(l&&(o(n,a)||i(n,a,t[e]?""+t[e]:u.join(String(e)))),t===r?t[e]=n:s?t[e]?t[e]=n:i(t,e,n):(delete t[e],i(t,e,n)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[a]||s.call(this)})},function(t,e,n){var r=n(1),i=n(5),o=n(32),a=/"/g,s=function(t,e,n,r){var i=String(o(t)),s="<"+e;return""!==n&&(s+=" "+n+'="'+String(r).replace(a,"&quot;")+'"'),s+">"+i+"</"+e+">"};t.exports=function(t,e){var n={};n[t]=e(s),r(r.P+r.F*i(function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3}),"String",n)}},function(t,e,n){"use strict";(function(t){function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var i;n.d(e,"a",function(){return i}),n.d(e,"b",function(){return s}),function(t){t.SEVERE="SEVERE",t.WARN="WARN",t.INFO="INFO",t.DEBUG="DEBUG",t.TRACE="TRACE"}(i||(i={}));var o=[i.SEVERE,i.WARN,i.INFO,i.DEBUG,i.TRACE];function a(t){return o.indexOf(t)}var s=new(function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.currentLevelNum=a(function(t){if(!t)return i.SEVERE;switch(t.toUpperCase()){case i.SEVERE:return i.SEVERE;case i.DEBUG:return i.DEBUG;case i.TRACE:return i.TRACE;default:throw new Error("ERROR: Invalid log level. valid levels are ".concat(JSON.stringify(o)))}}(t.env.LOG_LEVEL))}var n,s,u;return n=e,(s=[{key:"isLevel",value:function(t){return a(t)<=this.currentLevelNum}},{key:"warn",value:function(t){this.log(i.WARN,t)}},{key:"info",value:function(t){this.log(i.INFO,t)}},{key:"debug",value:function(t){this.log(i.DEBUG,t)}},{key:"trace",value:function(t){this.log(i.TRACE,t)}},{key:"logFn",value:function(t,e){this.isLevel(t)&&console.warn(e())}},{key:"log",value:function(t,e){"string"==typeof e?this.logFn(t,function(){return e}):this.logFn(t,e)}}])&&r(n.prototype,s),u&&r(n,u),e}())}).call(this,n(107))},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,n){var r=n(59),i=n(32);t.exports=function(t){return r(i(t))}},function(t,e,n){var r=n(60),i=n(41),o=n(23),a=n(31),s=n(22),u=n(110),l=Object.getOwnPropertyDescriptor;e.f=n(10)?l:function(t,e){if(t=o(t),e=a(e,!0),u)try{return l(t,e)}catch(t){}if(s(t,e))return i(!r.f.call(t,e),t[e])}},function(t,e,n){var r=n(22),i=n(12),o=n(81)("IE_PROTO"),a=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=i(t),r(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?a:null}},function(t,e){var n=t.exports={version:"2.6.0"};"number"==typeof __e&&(__e=n)},function(t,e,n){var r=n(15);t.exports=function(t,e,n){if(r(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)}}return function(){return t.apply(e,arguments)}}},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e){var n=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:n)(t)}},function(t,e,n){"use strict";var r=n(5);t.exports=function(t,e){return!!t&&r(function(){e?t.call(null,function(){},1):t.call(null)})}},function(t,e,n){var r=n(6);t.exports=function(t,e){if(!r(t))return t;var n,i;if(e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;if("function"==typeof(n=t.valueOf)&&!r(i=n.call(t)))return i;if(!e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,e){t.exports=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e,n){var r=n(1),i=n(26),o=n(5);t.exports=function(t,e){var n=(i.Object||{})[t]||Object[t],a={};a[t]=e(n),r(r.S+r.F*o(function(){n(1)}),"Object",a)}},function(t,e,n){var r=n(27),i=n(59),o=n(12),a=n(9),s=n(97);t.exports=function(t,e){var n=1==t,u=2==t,l=3==t,c=4==t,f=6==t,h=5==t||f,d=e||s;return function(e,s,v){for(var p,y,g=o(e),m=i(g),b=r(s,v,3),w=a(m.length),_=0,S=n?d(e,w):u?d(e,0):void 0;w>_;_++)if((h||_ in m)&&(y=b(p=m[_],_,g),t))if(n)S[_]=y;else if(y)switch(t){case 3:return!0;case 5:return p;case 6:return _;case 2:S.push(p)}else if(c)return!1;return f?-1:l||c?c:S}}},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}if(n(10)){var i=n(38),o=n(4),a=n(5),s=n(1),u=n(74),l=n(105),c=n(27),f=n(48),h=n(41),d=n(18),v=n(50),p=n(29),y=n(9),g=n(138),m=n(44),b=n(31),w=n(22),_=n(53),S=n(6),k=n(12),E=n(94),T=n(45),O=n(25),x=n(46).f,C=n(96),M=n(42),R=n(8),I=n(34),A=n(64),L=n(62),P=n(99),N=n(55),D=n(69),G=n(47),B=n(98),F=n(127),j=n(11),U=n(24),W=j.f,H=U.f,q=o.RangeError,z=o.TypeError,V=o.Uint8Array,K=Array.prototype,Y=l.ArrayBuffer,J=l.DataView,X=I(0),$=I(2),Z=I(3),Q=I(4),tt=I(5),et=I(6),nt=A(!0),rt=A(!1),it=P.values,ot=P.keys,at=P.entries,st=K.lastIndexOf,ut=K.reduce,lt=K.reduceRight,ct=K.join,ft=K.sort,ht=K.slice,dt=K.toString,vt=K.toLocaleString,pt=R("iterator"),yt=R("toStringTag"),gt=M("typed_constructor"),mt=M("def_constructor"),bt=u.CONSTR,wt=u.TYPED,_t=u.VIEW,St=I(1,function(t,e){return xt(L(t,t[mt]),e)}),kt=a(function(){return 1===new V(new Uint16Array([1]).buffer)[0]}),Et=!!V&&!!V.prototype.set&&a(function(){new V(1).set({})}),Tt=function(t,e){var n=p(t);if(n<0||n%e)throw q("Wrong offset!");return n},Ot=function(t){if(S(t)&&wt in t)return t;throw z(t+" is not a typed array!")},xt=function(t,e){if(!(S(t)&&gt in t))throw z("It is not a typed array constructor!");return new t(e)},Ct=function(t,e){return Mt(L(t,t[mt]),e)},Mt=function(t,e){for(var n=0,r=e.length,i=xt(t,r);r>n;)i[n]=e[n++];return i},Rt=function(t,e,n){W(t,e,{get:function(){return this._d[n]}})},It=function(t){var e,n,r,i,o,a,s=k(t),u=arguments.length,l=u>1?arguments[1]:void 0,f=void 0!==l,h=C(s);if(null!=h&&!E(h)){for(a=h.call(s),r=[],e=0;!(o=a.next()).done;e++)r.push(o.value);s=r}for(f&&u>2&&(l=c(l,arguments[2],2)),e=0,n=y(s.length),i=xt(this,n);n>e;e++)i[e]=f?l(s[e],e):s[e];return i},At=function(){for(var t=0,e=arguments.length,n=xt(this,e);e>t;)n[t]=arguments[t++];return n},Lt=!!V&&a(function(){vt.call(new V(1))}),Pt=function(){return vt.apply(Lt?ht.call(Ot(this)):Ot(this),arguments)},Nt={copyWithin:function(t,e){return F.call(Ot(this),t,e,arguments.length>2?arguments[2]:void 0)},every:function(t){return Q(Ot(this),t,arguments.length>1?arguments[1]:void 0)},fill:function(t){return B.apply(Ot(this),arguments)},filter:function(t){return Ct(this,$(Ot(this),t,arguments.length>1?arguments[1]:void 0))},find:function(t){return tt(Ot(this),t,arguments.length>1?arguments[1]:void 0)},findIndex:function(t){return et(Ot(this),t,arguments.length>1?arguments[1]:void 0)},forEach:function(t){X(Ot(this),t,arguments.length>1?arguments[1]:void 0)},indexOf:function(t){return rt(Ot(this),t,arguments.length>1?arguments[1]:void 0)},includes:function(t){return nt(Ot(this),t,arguments.length>1?arguments[1]:void 0)},join:function(t){return ct.apply(Ot(this),arguments)},lastIndexOf:function(t){return st.apply(Ot(this),arguments)},map:function(t){return St(Ot(this),t,arguments.length>1?arguments[1]:void 0)},reduce:function(t){return ut.apply(Ot(this),arguments)},reduceRight:function(t){return lt.apply(Ot(this),arguments)},reverse:function(){for(var t,e=Ot(this).length,n=Math.floor(e/2),r=0;r<n;)t=this[r],this[r++]=this[--e],this[e]=t;return this},some:function(t){return Z(Ot(this),t,arguments.length>1?arguments[1]:void 0)},sort:function(t){return ft.call(Ot(this),t)},subarray:function(t,e){var n=Ot(this),r=n.length,i=m(t,r);return new(L(n,n[mt]))(n.buffer,n.byteOffset+i*n.BYTES_PER_ELEMENT,y((void 0===e?r:m(e,r))-i))}},Dt=function(t,e){return Ct(this,ht.call(Ot(this),t,e))},Gt=function(t){Ot(this);var e=Tt(arguments[1],1),n=this.length,r=k(t),i=y(r.length),o=0;if(i+e>n)throw q("Wrong length!");for(;o<i;)this[e+o]=r[o++]},Bt={entries:function(){return at.call(Ot(this))},keys:function(){return ot.call(Ot(this))},values:function(){return it.call(Ot(this))}},Ft=function(t,e){return S(t)&&t[wt]&&"symbol"!=r(e)&&e in t&&String(+e)==String(e)},jt=function(t,e){return Ft(t,e=b(e,!0))?h(2,t[e]):H(t,e)},Ut=function(t,e,n){return!(Ft(t,e=b(e,!0))&&S(n)&&w(n,"value"))||w(n,"get")||w(n,"set")||n.configurable||w(n,"writable")&&!n.writable||w(n,"enumerable")&&!n.enumerable?W(t,e,n):(t[e]=n.value,t)};bt||(U.f=jt,j.f=Ut),s(s.S+s.F*!bt,"Object",{getOwnPropertyDescriptor:jt,defineProperty:Ut}),a(function(){dt.call({})})&&(dt=vt=function(){return ct.call(this)});var Wt=v({},Nt);v(Wt,Bt),d(Wt,pt,Bt.values),v(Wt,{slice:Dt,set:Gt,constructor:function(){},toString:dt,toLocaleString:Pt}),Rt(Wt,"buffer","b"),Rt(Wt,"byteOffset","o"),Rt(Wt,"byteLength","l"),Rt(Wt,"length","e"),W(Wt,yt,{get:function(){return this[wt]}}),t.exports=function(t,e,n,r){var l=t+((r=!!r)?"Clamped":"")+"Array",c="get"+t,h="set"+t,v=o[l],p=v||{},m=v&&O(v),b=!v||!u.ABV,w={},k=v&&v.prototype,E=function(t,n){W(t,n,{get:function(){return function(t,n){var r=t._d;return r.v[c](n*e+r.o,kt)}(this,n)},set:function(t){return function(t,n,i){var o=t._d;r&&(i=(i=Math.round(i))<0?0:i>255?255:255&i),o.v[h](n*e+o.o,i,kt)}(this,n,t)},enumerable:!0})};b?(v=n(function(t,n,r,i){f(t,v,l,"_d");var o,a,s,u,c=0,h=0;if(S(n)){if(!(n instanceof Y||"ArrayBuffer"==(u=_(n))||"SharedArrayBuffer"==u))return wt in n?Mt(v,n):It.call(v,n);o=n,h=Tt(r,e);var p=n.byteLength;if(void 0===i){if(p%e)throw q("Wrong length!");if((a=p-h)<0)throw q("Wrong length!")}else if((a=y(i)*e)+h>p)throw q("Wrong length!");s=a/e}else s=g(n),o=new Y(a=s*e);for(d(t,"_d",{b:o,o:h,l:a,e:s,v:new J(o)});c<s;)E(t,c++)}),k=v.prototype=T(Wt),d(k,"constructor",v)):a(function(){v(1)})&&a(function(){new v(-1)})&&D(function(t){new v,new v(null),new v(1.5),new v(t)},!0)||(v=n(function(t,n,r,i){var o;return f(t,v,l),S(n)?n instanceof Y||"ArrayBuffer"==(o=_(n))||"SharedArrayBuffer"==o?void 0!==i?new p(n,Tt(r,e),i):void 0!==r?new p(n,Tt(r,e)):new p(n):wt in n?Mt(v,n):It.call(v,n):new p(g(n))}),X(m!==Function.prototype?x(p).concat(x(m)):x(p),function(t){t in v||d(v,t,p[t])}),v.prototype=k,i||(k.constructor=v));var C=k[pt],M=!!C&&("values"==C.name||null==C.name),R=Bt.values;d(v,gt,!0),d(k,wt,l),d(k,_t,!0),d(k,mt,v),(r?new v(1)[yt]==l:yt in k)||W(k,yt,{get:function(){return l}}),w[l]=v,s(s.G+s.W+s.F*(v!=p),w),s(s.S,l,{BYTES_PER_ELEMENT:e}),s(s.S+s.F*a(function(){p.of.call(v,1)}),l,{from:It,of:At}),"BYTES_PER_ELEMENT"in k||d(k,"BYTES_PER_ELEMENT",e),s(s.P,l,Nt),G(l),s(s.P+s.F*Et,l,{set:Gt}),s(s.P+s.F*!M,l,Bt),i||k.toString==dt||(k.toString=dt),s(s.P+s.F*a(function(){new v(1).slice()}),l,{slice:Dt}),s(s.P+s.F*(a(function(){return[1,2].toLocaleString()!=new v([1,2]).toLocaleString()})||!a(function(){k.toLocaleString.call([1,2])})),l,{toLocaleString:Pt}),N[l]=M?C:R,i||M||d(k,pt,R)}}else t.exports=function(){}},function(t,e,n){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=n(133),o=n(1),a=n(63)("metadata"),s=a.store||(a.store=new(n(136))),u=function(t,e,n){var r=s.get(t);if(!r){if(!n)return;s.set(t,r=new i)}var o=r.get(e);if(!o){if(!n)return;r.set(e,o=new i)}return o};t.exports={store:s,map:u,has:function(t,e,n){var r=u(e,n,!1);return void 0!==r&&r.has(t)},get:function(t,e,n){var r=u(e,n,!1);return void 0===r?void 0:r.get(t)},set:function(t,e,n,r){u(n,r,!0).set(t,e)},keys:function(t,e){var n=u(t,e,!1),r=[];return n&&n.forEach(function(t,e){r.push(e)}),r},key:function(t){return void 0===t||"symbol"==r(t)?t:String(t)},exp:function(t){o(o.S,"Reflect",t)}}},function(t,e,n){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=n(42)("meta"),o=n(6),a=n(22),s=n(11).f,u=0,l=Object.isExtensible||function(){return!0},c=!n(5)(function(){return l(Object.preventExtensions({}))}),f=function(t){s(t,i,{value:{i:"O"+ ++u,w:{}}})},h=t.exports={KEY:i,NEED:!1,fastKey:function(t,e){if(!o(t))return"symbol"==r(t)?t:("string"==typeof t?"S":"P")+t;if(!a(t,i)){if(!l(t))return"F";if(!e)return"E";f(t)}return t[i].i},getWeak:function(t,e){if(!a(t,i)){if(!l(t))return!0;if(!e)return!1;f(t)}return t[i].w},onFreeze:function(t){return c&&h.NEED&&l(t)&&!a(t,i)&&f(t),t}}},function(t,e){t.exports=!1},function(t,e,n){var r=n(8)("unscopables"),i=Array.prototype;null==i[r]&&n(18)(i,r,{}),t.exports=function(t){i[r][t]=!0}},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function o(t){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function l(t,e,n){return e&&u(t.prototype,e),n&&u(t,n),t}n.d(e,"a",function(){return h});var c=n(106),f=function(){function t(e,n){s(this,t),this.bitSet=n||new c,e&&this.addAll(e)}return l(t,[{key:"isEmpty",value:function(){return this.bitSet.isEmpty()}},{key:"addAll",value:function(t){var e=!0,n=!1,r=void 0;try{for(var i,o=t[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value;this.add(a)}}catch(t){n=!0,r=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}}},{key:"add",value:function(t){this.bitSet.set(this._indexOf(t))}},{key:"remove",value:function(t){this.bitSet.clear(this._indexOf(t))}},{key:"has",value:function(t){return!!this.bitSet.get(this._indexOf(t))}},{key:"containsAll",value:function(t){return t.bitSet.cardinality()===this.bitSet.and(t.bitSet).cardinality()}},{key:"containsAny",value:function(t){return!this.bitSet.and(t.bitSet).isEmpty()}},{key:"containsNone",value:function(t){return t.bitSet.and(this.bitSet).isEmpty()}},{key:"_indexOf",value:function(t){var e=this.indexOf(t);if(e<0)throw new Error("BUG: Expected the item index to be >= 0 but it was ".concat(e));return e}}]),t}(),h=function(t){function e(){return s(this,e),i(this,o(e).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(e,f),l(e,[{key:"indexOf",value:function(t){return t.allSpritesBitSetIndex}},{key:"union",value:function(t){var e=this,n=!0,r=!1,i=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;e=e.or(s)}}catch(t){r=!0,i=t}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return e}},{key:"toString",value:function(t){var e=[],n=!0,r=!1,i=void 0;try{for(var o,a=this.getSprites(t)[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;e.push(s.getName())}}catch(t){r=!0,i=t}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return e.join(" ")}},{key:"getSprites",value:function(t){var e=new Set,n=!0,r=!1,i=void 0;try{for(var o,a=t.objects[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;this.has(s)&&e.add(s)}}catch(t){r=!0,i=t}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return e}},{key:"or",value:function(t){return new e(void 0,this.bitSet.or(t.bitSet))}}]),e}()},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e){var n=0,r=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+r).toString(36))}},function(t,e,n){var r=n(112),i=n(82);t.exports=Object.keys||function(t){return r(t,i)}},function(t,e,n){var r=n(29),i=Math.max,o=Math.min;t.exports=function(t,e){return(t=r(t))<0?i(t+e,0):o(t,e)}},function(t,e,n){var r=n(3),i=n(113),o=n(82),a=n(81)("IE_PROTO"),s=function(){},u=function(){var t,e=n(79)("iframe"),r=o.length;for(e.style.display="none",n(83).appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),u=t.F;r--;)delete u.prototype[o[r]];return u()};t.exports=Object.create||function(t,e){var n;return null!==t?(s.prototype=r(t),n=new s,s.prototype=null,n[a]=t):n=u(),void 0===e?n:i(n,e)}},function(t,e,n){var r=n(112),i=n(82).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,i)}},function(t,e,n){"use strict";var r=n(4),i=n(11),o=n(10),a=n(8)("species");t.exports=function(t){var e=r[t];o&&e&&!e[a]&&i.f(e,a,{configurable:!0,get:function(){return this}})}},function(t,e){t.exports=function(t,e,n,r){if(!(t instanceof e)||void 0!==r&&r in t)throw TypeError(n+": incorrect invocation!");return t}},function(t,e,n){var r=n(27),i=n(125),o=n(94),a=n(3),s=n(9),u=n(96),l={},c={};(e=t.exports=function(t,e,n,f,h){var d,v,p,y,g=h?function(){return t}:u(t),m=r(n,f,e?2:1),b=0;if("function"!=typeof g)throw TypeError(t+" is not iterable!");if(o(g)){for(d=s(t.length);d>b;b++)if((y=e?m(a(v=t[b])[0],v[1]):m(t[b]))===l||y===c)return y}else for(p=g.call(t);!(v=p.next()).done;)if((y=i(p,m,v.value,e))===l||y===c)return y}).BREAK=l,e.RETURN=c},function(t,e,n){var r=n(19);t.exports=function(t,e,n){for(var i in e)r(t,i,e[i],n);return t}},function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",function(){return o}),n.d(e,"b",function(){return a});var o=function t(e,n){i(this,t),this.width=e,this.height=n},a=function(){function t(){i(this,t),this.noAction=!1,this.noUndo=!1,this.noRepeatAction=!1,this.throttleMovement=!1,this.noRestart=!1,this.requirePlayerMovement=!1,this.verboseLogging=!1,this.author=null,this.homepage=null,this.youtube=null,this.zoomscreen=null,this.flickscreen=null,this.colorPalette=null,this.backgroundColor=null,this.textColor=null,this.realtimeInterval=null,this.keyRepeatInterval=null,this.againInterval=null,this.runRulesOnLevelStart=null}var e,n,o;return e=t,(n=[{key:"_setValue",value:function(t,e){switch(t.toLowerCase()){case"author":this.author=e;break;case"homepage":this.homepage=e;break;case"youtube":this.youtube=e;break;case"zoomscreen":this.zoomscreen=e;break;case"flickscreen":this.flickscreen=e;break;case"colorpalette":case"color_palette":this.colorPalette=e;break;case"backgroundcolor":case"background_color":this.backgroundColor=e;break;case"textcolor":case"text_color":this.textColor=e;break;case"realtimeinterval":case"realtime_interval":this.realtimeInterval=e;break;case"keyrepeatinterval":case"key_repeat_interval":this.keyRepeatInterval=e;break;case"againinterval":case"again_interval":this.againInterval=e;break;case"noaction":this.noAction=e;break;case"noundo":this.noUndo=e;break;case"runrulesonlevelstart":case"run_rules_on_level_start":this.runRulesOnLevelStart=e;break;case"norepeataction":case"norepeat_action":this.noRepeatAction=e;break;case"throttlemovement":case"throttle_movement":this.throttleMovement=e;break;case"norestart":this.noRestart=e;break;case"requireplayermovement":case"require_player_movement":this.requirePlayerMovement=e;break;case"verboselogging":case"verbose_logging":this.verboseLogging=e;break;default:throw new Error('BUG: Unsupported config field "'.concat(t,'" with value "').concat(e,'"'))}}}])&&r(e.prototype,n),o&&r(e,o),t}()},function(t,e,n){var r=n(11).f,i=n(22),o=n(8)("toStringTag");t.exports=function(t,e,n){t&&!i(t=n?t:t.prototype,o)&&r(t,o,{configurable:!0,value:e})}},function(t,e,n){var r=n(28),i=n(8)("toStringTag"),o="Arguments"==r(function(){return arguments}());t.exports=function(t){var e,n,a;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),i))?n:o?r(e):"Object"==(a=r(e))&&"function"==typeof e.callee?"Arguments":a}},function(t,e,n){var r=n(1),i=n(32),o=n(5),a=n(85),s="["+a+"]",u=RegExp("^"+s+s+"*"),l=RegExp(s+s+"*$"),c=function(t,e,n){var i={},s=o(function(){return!!a[t]()||"​"!="​"[t]()}),u=i[t]=s?e(f):a[t];n&&(i[n]=u),r(r.P+r.F*s,"String",i)},f=c.trim=function(t,e){return t=String(i(t)),1&e&&(t=t.replace(u,"")),2&e&&(t=t.replace(l,"")),t};t.exports=c},function(t,e){t.exports={}},function(t,e,n){var r=n(6);t.exports=function(t,e){if(!r(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}},function(t,e,n){"use strict";n.d(e,"b",function(){return v}),n.d(e,"a",function(){return p});var r,i=n(13);function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function l(t,e,n){return e&&u(t.prototype,e),n&&u(t,n),t}function c(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function h(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&d(t,e)}function d(t,e){return(d=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}!function(t){t.NO="NO",t.ALL="ALL",t.ANY="ANY",t.SOME="SOME"}(r||(r={}));var v=function(t){function e(t,n,r){var i;if(s(this,e),(i=c(this,f(e).call(this,t))).qualifier=n,i.tile=r,!r)throw new Error("BUG: Could not find win condition tile");return i}return h(e,i["a"]),l(e,[{key:"cellsThatMatchTile",value:function(t,e){return a(t).filter(function(t){return e.matchesCell(t)})}},{key:"isSatisfied",value:function(t){var e=this._isSatisfied(t);return e}},{key:"a11yGetTiles",value:function(){return[this.tile]}},{key:"_isSatisfied",value:function(t){var e=this.cellsThatMatchTile(t,this.tile);switch(this.qualifier){case r.NO:return 0===e.length;case r.ANY:case r.SOME:return e.length>0;default:throw new Error('BUG: Invalid qualifier: "'.concat(this.qualifier,'"'))}}}]),e}(),p=function(t){function e(t,n,r,i){var o;return s(this,e),(o=c(this,f(e).call(this,t,n,r))).onTile=i,o}return h(e,v),l(e,[{key:"a11yGetTiles",value:function(){return[this.tile,this.onTile]}},{key:"_isSatisfied",value:function(t){var e=this.cellsThatMatchTile(t,this.tile),n=this.cellsThatMatchTile(e,this.onTile);switch(this.qualifier){case r.NO:return 0===n.length;case r.ANY:case r.SOME:return n.length>0;case r.ALL:return n.length===e.length;default:throw new Error('BUG: Invalid qualifier: "'.concat(this.qualifier,'"'))}}}]),e}()},function(t,e,n){"use strict";n.d(e,"a",function(){return h});var r=n(0),i=n(13);function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var f=0,h=function(t){function e(t,n){var i,s,l;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),s=this,l=u(e).call(this,t),(i=!l||"object"!==o(l)&&"function"!=typeof l?c(s):l).id=f++,n.forEach(function(t){t.setCollisionLayer(c(c(i))),t._getDescendantTiles().forEach(function(t){t.setCollisionLayer(c(c(i)))})}),i.sprites=a(new Set(Object(r.g)(n.map(function(t){return t.getSprites()})))),i.sprites.forEach(function(t,e){return t.setCollisionLayerAndIndex(c(c(i)),e)}),i}var n,h,d;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(e,i["a"]),n=e,(h=[{key:"getBitSetIndexOf",value:function(t){var e=this.sprites.indexOf(t);if(e<0)throw new Error("BUG: Sprite is not in this CollisionLayer");return e}}])&&s(n.prototype,h),d&&s(n,d),e}()},function(t,e,n){var r=n(28);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==r(t)?t.split(""):Object(t)}},function(t,e){e.f={}.propertyIsEnumerable},function(t,e,n){"use strict";var r=n(3);t.exports=function(){var t=r(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},function(t,e,n){var r=n(3),i=n(15),o=n(8)("species");t.exports=function(t,e){var n,a=r(t).constructor;return void 0===a||null==(n=r(a)[o])?e:i(n)}},function(t,e,n){var r=n(26),i=n(4),o=i["__core-js_shared__"]||(i["__core-js_shared__"]={});(t.exports=function(t,e){return o[t]||(o[t]=void 0!==e?e:{})})("versions",[]).push({version:r.version,mode:n(38)?"pure":"global",copyright:"© 2018 Denis Pushkarev (zloirock.ru)"})},function(t,e,n){var r=n(23),i=n(9),o=n(44);t.exports=function(t){return function(e,n,a){var s,u=r(e),l=i(u.length),c=o(a,l);if(t&&n!=n){for(;l>c;)if((s=u[c++])!=s)return!0}else for(;l>c;c++)if((t||c in u)&&u[c]===n)return t||c||0;return!t&&-1}}},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,n){var r=n(28);t.exports=Array.isArray||function(t){return"Array"==r(t)}},function(t,e,n){var r=n(29),i=n(32);t.exports=function(t){return function(e,n){var o,a,s=String(i(e)),u=r(n),l=s.length;return u<0||u>=l?t?"":void 0:(o=s.charCodeAt(u))<55296||o>56319||u+1===l||(a=s.charCodeAt(u+1))<56320||a>57343?t?s.charAt(u):o:t?s.slice(u,u+2):a-56320+(o-55296<<10)+65536}}},function(t,e,n){var r=n(6),i=n(28),o=n(8)("match");t.exports=function(t){var e;return r(t)&&(void 0!==(e=t[o])?!!e:"RegExp"==i(t))}},function(t,e,n){var r=n(8)("iterator"),i=!1;try{var o=[7][r]();o.return=function(){i=!0},Array.from(o,function(){throw 2})}catch(t){}t.exports=function(t,e){if(!e&&!i)return!1;var n=!1;try{var o=[7],a=o[r]();a.next=function(){return{done:n=!0}},o[r]=function(){return a},t(o)}catch(t){}return n}},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=n(53),o=RegExp.prototype.exec;t.exports=function(t,e){var n=t.exec;if("function"==typeof n){var a=n.call(t,e);if("object"!==r(a))throw new TypeError("RegExp exec method returned something other than an Object or null");return a}if("RegExp"!==i(t))throw new TypeError("RegExp#exec called on incompatible receiver");return o.call(t,e)}},function(t,e,n){"use strict";n(129);var r=n(19),i=n(18),o=n(5),a=n(32),s=n(8),u=n(100),l=s("species"),c=!o(function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")}),f=function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var n="ab".split(t);return 2===n.length&&"a"===n[0]&&"b"===n[1]}();t.exports=function(t,e,n){var h=s(t),d=!o(function(){var e={};return e[h]=function(){return 7},7!=""[t](e)}),v=d?!o(function(){var e=!1,n=/a/;return n.exec=function(){return e=!0,null},"split"===t&&(n.constructor={},n.constructor[l]=function(){return n}),n[h](""),!e}):void 0;if(!d||!v||"replace"===t&&!c||"split"===t&&!f){var p=/./[h],y=n(a,h,""[t],function(t,e,n,r,i){return e.exec===u?d&&!i?{done:!0,value:p.call(e,n,r)}:{done:!0,value:t.call(n,e,r)}:{done:!1}}),g=y[0],m=y[1];r(String.prototype,t,g),i(RegExp.prototype,h,2==e?function(t,e){return m.call(t,this,e)}:function(t){return m.call(t,this)})}}},function(t,e,n){var r=n(4).navigator;t.exports=r&&r.userAgent||""},function(t,e,n){"use strict";var r=n(4),i=n(1),o=n(19),a=n(50),s=n(37),u=n(49),l=n(48),c=n(6),f=n(5),h=n(69),d=n(52),v=n(86);t.exports=function(t,e,n,p,y,g){var m=r[t],b=m,w=y?"set":"add",_=b&&b.prototype,S={},k=function(t){var e=_[t];o(_,t,"delete"==t?function(t){return!(g&&!c(t))&&e.call(this,0===t?0:t)}:"has"==t?function(t){return!(g&&!c(t))&&e.call(this,0===t?0:t)}:"get"==t?function(t){return g&&!c(t)?void 0:e.call(this,0===t?0:t)}:"add"==t?function(t){return e.call(this,0===t?0:t),this}:function(t,n){return e.call(this,0===t?0:t,n),this})};if("function"==typeof b&&(g||_.forEach&&!f(function(){(new b).entries().next()}))){var E=new b,T=E[w](g?{}:-0,1)!=E,O=f(function(){E.has(1)}),x=h(function(t){new b(t)}),C=!g&&f(function(){for(var t=new b,e=5;e--;)t[w](e,e);return!t.has(-0)});x||((b=e(function(e,n){l(e,b,t);var r=v(new m,e,b);return null!=n&&u(n,y,r[w],r),r})).prototype=_,_.constructor=b),(O||C)&&(k("delete"),k("has"),y&&k("get")),(C||T)&&k(w),g&&_.clear&&delete _.clear}else b=p.getConstructor(e,t,y,w),a(b.prototype,n),s.NEED=!0;return d(b,t),S[t]=b,i(i.G+i.W+i.F*(b!=m),S),g||p.setStrong(b,t,y),b}},function(t,e,n){for(var r,i=n(4),o=n(18),a=n(42),s=a("typed_array"),u=a("view"),l=!(!i.ArrayBuffer||!i.DataView),c=l,f=0,h="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");f<9;)(r=i[h[f++]])?(o(r.prototype,s,!0),o(r.prototype,u,!0)):c=!1;t.exports={ABV:l,CONSTR:c,TYPED:s,VIEW:u}},function(t,e,n){"use strict";t.exports=n(38)||!n(5)(function(){var t=Math.random();__defineSetter__.call(null,t,function(){}),delete n(4)[t]})},function(t,e,n){"use strict";var r=n(1);t.exports=function(t){r(r.S,t,{of:function(){for(var t=arguments.length,e=new Array(t);t--;)e[t]=arguments[t];return new this(e)}})}},function(t,e,n){"use strict";var r=n(1),i=n(15),o=n(27),a=n(49);t.exports=function(t){r(r.S,t,{from:function(t){var e,n,r,s,u=arguments[1];return i(this),(e=void 0!==u)&&i(u),null==t?new this:(n=[],e?(r=0,s=o(u,arguments[2],2),a(t,!1,function(t){n.push(s(t,r++))})):a(t,!1,n.push,n),new this(n))}})}},function(t,e,n){"use strict";var r=n(16),i=n(14);function o(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var a=new Map;function s(t,e,n){var o=new r.a(t,"#ffffff"),a=new r.a(t,"#000000"),s=n.map(function(t){return t.map(function(t){return 0===t?a:o})});return new i.e(t,'letterchar="'.concat(e,'"'),"",s)}function u(t,e){a.set(t,e)}u("a",[[0,0,0,0,0],[0,1,1,1,0],[1,0,0,1,0],[1,0,0,1,0],[0,1,1,1,0]]),u("b",[[1,0,0,0,0],[1,0,0,0,0],[1,1,1,0,0],[1,0,0,1,0],[0,1,1,0,0]]),u("c",[[0,0,0,0,0],[0,1,1,1,0],[1,0,0,0,0],[1,0,0,0,0],[0,1,1,1,0]]),u("d",[[0,0,0,1,0],[0,0,0,1,0],[0,1,1,1,0],[1,0,0,1,0],[0,1,1,0,0]]),u("e",[[0,1,1,0,0],[1,0,0,1,0],[1,1,1,0,0],[1,0,0,0,0],[0,1,1,0,0]]),u("f",[[0,0,0,0,0],[0,0,1,1,0],[0,1,0,0,0],[1,1,1,0,0],[0,1,0,0,0]]),u("g",[[0,1,1,0,0],[1,0,0,1,0],[0,1,1,1,0],[0,0,0,1,0],[0,1,1,0,0]]),u("h",[[1,0,0,0,0],[1,0,0,0,0],[1,1,1,0,0],[1,0,0,1,0],[1,0,0,1,0]]),u("i",[[0,0,1,0,0],[0,0,0,0,0],[0,1,1,0,0],[0,0,1,0,0],[0,1,1,1,0]]),u("j",[[0,0,1,0,0],[0,0,0,0,0],[0,0,1,0,0],[1,0,1,0,0],[0,1,0,0,0]]),u("k",[[1,0,0,0,0],[1,0,0,1,0],[1,1,1,0,0],[1,0,0,1,0],[1,0,0,1,0]]),u("l",[[1,0,0,0,0],[1,0,0,0,0],[1,0,0,0,0],[1,0,0,1,0],[0,1,1,0,0]]),u("m",[[0,0,0,0,0],[0,1,0,1,0],[1,0,1,0,1],[1,0,1,0,1],[1,0,1,0,1]]),u("n",[[0,0,0,0,0],[0,1,1,0,0],[1,0,0,1,0],[1,0,0,1,0],[1,0,0,1,0]]),u("o",[[0,0,0,0,0],[0,1,1,0,0],[1,0,0,1,0],[1,0,0,1,0],[0,1,1,0,0]]),u("p",[[0,0,0,0,0],[0,1,1,0,0],[1,0,0,1,0],[1,1,1,0,0],[1,0,0,0,0]]),u("q",[[0,0,0,0,0],[0,1,1,0,0],[1,0,0,1,0],[0,1,1,1,0],[0,0,0,1,0]]),u("r",[[0,0,0,0,0],[0,1,1,1,0],[1,0,0,0,0],[1,0,0,0,0],[1,0,0,0,0]]),u("s",[[0,1,1,1,0],[1,0,0,0,0],[0,1,1,0,0],[0,0,0,1,0],[1,1,1,0,0]]),u("t",[[0,1,0,0,0],[1,1,1,0,0],[0,1,0,0,0],[0,1,0,0,1],[0,0,1,1,0]]),u("u",[[0,0,0,0,0],[1,0,0,1,0],[1,0,0,1,0],[1,0,0,1,0],[1,1,1,0,0]]),u("v",[[0,0,0,0,0],[1,0,0,1,0],[1,0,1,0,0],[1,1,0,0,0],[1,0,0,0,0]]),u("w",[[0,0,0,0,0],[1,0,1,0,1],[1,0,1,0,1],[1,0,1,0,1],[0,1,0,1,0]]),u("x",[[0,0,0,0,0],[1,0,0,1,0],[0,1,1,0,0],[0,1,1,0,0],[1,0,0,1,0]]),u("y",[[1,0,0,1,0],[1,0,0,1,0],[0,1,1,1,0],[0,0,0,1,0],[1,1,1,0,0]]),u("z",[[0,0,0,0,0],[1,1,1,1,0],[0,0,1,0,0],[0,1,0,0,0],[1,1,1,1,0]]),u("A",[[1,1,1,1,1],[1,0,0,0,1],[1,1,1,1,1],[1,0,0,0,1],[1,0,0,0,1]]),u("B",[[1,1,1,1,0],[1,0,0,0,1],[1,1,1,1,0],[1,0,0,0,1],[1,1,1,1,0]]),u("C",[[1,1,1,1,1],[1,0,0,0,0],[1,0,0,0,0],[1,0,0,0,0],[1,1,1,1,1]]),u("D",[[1,1,1,1,0],[1,0,0,0,1],[1,0,0,0,1],[1,0,0,0,1],[1,1,1,1,0]]),u("E",[[1,1,1,1,1],[1,0,0,0,0],[1,1,1,1,1],[1,0,0,0,0],[1,1,1,1,1]]),u("F",[[1,1,1,1,1],[1,0,0,0,0],[1,1,1,1,1],[1,0,0,0,0],[1,0,0,0,0]]),u("G",[[0,1,1,1,1],[1,0,0,0,0],[1,0,0,1,1],[1,0,0,0,1],[0,1,1,1,1]]),u("H",[[1,0,0,0,1],[1,0,0,0,1],[1,1,1,1,1],[1,0,0,0,1],[1,0,0,0,1]]),u("I",[[1,1,1,1,1],[0,0,1,0,0],[0,0,1,0,0],[0,0,1,0,0],[1,1,1,1,1]]),u("J",[[1,1,1,1,1],[0,0,1,0,0],[0,0,1,0,0],[0,0,1,0,0],[1,1,1,0,0]]),u("K",[[1,0,0,0,1],[1,0,1,1,0],[1,1,0,0,0],[1,0,1,1,0],[1,0,0,0,1]]),u("L",[[1,0,0,0,0],[1,0,0,0,0],[1,0,0,0,0],[1,0,0,0,0],[1,1,1,1,1]]),u("M",[[1,1,1,1,1],[1,0,1,0,1],[1,0,1,0,1],[1,0,1,0,1],[1,0,1,0,1]]),u("N",[[1,0,0,0,1],[1,1,0,0,1],[1,0,1,0,1],[1,0,0,1,1],[1,0,0,0,1]]),u("O",[[1,1,1,1,1],[1,0,0,0,1],[1,0,0,0,1],[1,0,0,0,1],[1,1,1,1,1]]),u("P",[[1,1,1,1,1],[1,0,0,0,1],[1,1,1,1,1],[1,0,0,0,0],[1,0,0,0,0]]),u("Q",[[1,1,1,1,1],[1,0,0,0,1],[1,1,1,1,1],[0,0,0,0,1],[0,0,0,0,1]]),u("R",[[1,1,1,1,0],[1,0,0,0,1],[1,1,1,1,0],[1,0,0,0,1],[1,0,0,0,1]]),u("S",[[0,1,1,1,1],[1,0,0,0,0],[0,1,1,1,0],[0,0,0,0,1],[1,1,1,1,0]]),u("T",[[1,1,1,1,1],[0,0,1,0,0],[0,0,1,0,0],[0,0,1,0,0],[0,0,1,0,0]]),u("U",[[1,0,0,0,1],[1,0,0,0,1],[1,0,0,0,1],[1,0,0,0,1],[1,1,1,1,1]]),u("V",[[1,0,0,0,1],[0,1,0,1,0],[0,1,0,1,0],[0,0,1,0,0],[0,0,1,0,0]]),u("W",[[1,0,1,0,1],[1,0,1,0,1],[1,0,1,0,1],[1,0,1,0,1],[0,1,0,1,0]]),u("X",[[1,0,0,0,1],[0,1,0,1,0],[0,0,1,0,0],[0,1,0,1,0],[1,0,0,0,1]]),u("Y",[[1,0,0,0,1],[1,0,0,0,1],[1,1,1,1,1],[0,0,1,0,0],[0,0,1,0,0]]),u("Z",[[1,1,1,1,1],[0,0,0,1,0],[0,0,1,0,0],[0,1,0,0,0],[1,1,1,1,1]]),u("0",[[1,1,1,1,1],[1,0,0,1,1],[1,0,1,0,1],[1,1,0,0,1],[1,1,1,1,1]]),u("1",[[1,1,1,0,0],[0,0,1,0,0],[0,0,1,0,0],[0,0,1,0,0],[1,1,1,1,1]]),u("2",[[1,1,1,1,1],[0,0,0,0,1],[1,1,1,1,1],[1,0,0,0,0],[1,1,1,1,1]]),u("3",[[1,1,1,1,0],[0,0,0,0,1],[0,0,1,1,0],[0,0,0,0,1],[1,1,1,1,0]]),u("4",[[1,0,0,0,0],[1,0,0,0,0],[1,0,0,1,0],[1,1,1,1,1],[0,0,0,1,0]]),u("5",[[1,1,1,1,1],[1,0,0,0,0],[1,1,1,1,0],[0,0,0,0,1],[1,1,1,1,0]]),u("6",[[0,1,1,1,0],[1,0,0,0,0],[1,1,1,1,0],[1,0,0,0,1],[0,1,1,1,0]]),u("7",[[1,1,1,1,1],[0,0,0,0,1],[0,0,0,1,0],[0,0,1,0,0],[0,1,0,0,0]]),u("8",[[0,1,1,1,0],[1,0,0,0,1],[0,1,1,1,0],[1,0,0,0,1],[0,1,1,1,0]]),u("9",[[0,1,1,1,0],[1,0,0,0,1],[0,1,1,1,1],[0,0,0,0,1],[0,1,1,1,0]]),u(".",[[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,0],[0,0,1,0,0]]),u(",",[[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,0],[0,0,1,0,0],[0,1,1,0,0]]),u(";",[[0,0,0,0,0],[0,0,1,0,0],[0,0,0,0,0],[0,0,1,0,0],[0,1,1,0,0]]),u(":",[[0,0,0,0,0],[0,0,1,0,0],[0,0,0,0,0],[0,0,1,0,0],[0,0,0,0,0]]),u("?",[[0,1,1,1,0],[1,0,0,0,1],[0,0,1,1,0],[0,0,1,0,0],[0,0,1,0,0]]),u("!",[[0,0,1,0,0],[0,0,1,0,0],[0,0,1,0,0],[0,0,0,0,0],[0,0,1,0,0]]),u("@",[[0,1,1,1,0],[1,0,0,0,1],[1,0,1,1,1],[1,0,0,0,0],[0,1,1,1,0]]),u("£",[[0,1,1,1,0],[0,1,0,0,1],[1,1,1,0,0],[0,1,0,0,0],[1,1,1,1,1]]),u("$",[[0,1,1,1,1],[1,0,1,0,0],[0,1,1,1,0],[0,0,1,0,1],[1,1,1,1,0]]),u("%",[[1,1,0,0,1],[1,1,0,1,0],[0,0,1,0,0],[0,1,0,1,1],[1,0,0,1,1]]),u("^",[[0,0,1,0,0],[0,1,0,1,0],[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,0]]),u("&",[[0,1,1,0,0],[1,0,0,0,0],[0,1,0,1,1],[1,0,0,1,0],[0,1,1,0,0]]),u("*",[[0,1,0,1,0],[0,0,1,0,0],[0,1,0,1,0],[0,0,0,0,0],[0,0,0,0,0]]),u("(",[[0,0,0,1,0],[0,0,1,0,0],[0,0,1,0,0],[0,0,1,0,0],[0,0,0,1,0]]),u(")",[[0,1,0,0,0],[0,0,1,0,0],[0,0,1,0,0],[0,0,1,0,0],[0,1,0,0,0]]),u("+",[[0,0,1,0,0],[0,0,1,0,0],[1,1,1,1,1],[0,0,1,0,0],[0,0,1,0,0]]),u("-",[[0,0,0,0,0],[0,0,0,0,0],[0,1,1,1,0],[0,0,0,0,0],[0,0,0,0,0]]),u("_",[[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,0],[1,1,1,1,1]]),u("=",[[0,0,0,0,0],[1,1,1,1,1],[0,0,0,0,0],[1,1,1,1,1],[0,0,0,0,0]]),u(" ",[[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,0]]),u("{",[[0,0,1,1,0],[0,0,1,0,0],[0,1,1,0,0],[0,0,1,0,0],[0,0,1,1,0]]),u("}",[[0,1,1,0,0],[0,0,1,0,0],[0,0,1,1,0],[0,0,1,0,0],[0,1,1,0,0]]),u("[",[[0,0,1,1,0],[0,0,1,0,0],[0,0,1,0,0],[0,0,1,0,0],[0,0,1,1,0]]),u("]",[[0,1,1,0,0],[0,0,1,0,0],[0,0,1,0,0],[0,0,1,0,0],[0,1,1,0,0]]),u("'",[[0,0,1,0,0],[0,0,1,0,0],[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,0]]),u('"',[[0,1,0,1,0],[0,1,0,1,0],[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,0]]),u("/",[[0,0,0,0,1],[0,0,0,1,0],[0,0,1,0,0],[0,1,0,0,0],[1,0,0,0,0]]),u("\\",[[1,0,0,0,0],[0,1,0,0,0],[0,0,1,0,0],[0,0,0,1,0],[0,0,0,0,1]]),u("|",[[0,0,1,0,0],[0,0,1,0,0],[0,0,1,0,0],[0,0,1,0,0],[0,0,1,0,0]]),u("<",[[0,0,0,1,0],[0,0,1,0,0],[0,1,0,0,0],[0,0,1,0,0],[0,0,0,1,0]]),u(">",[[0,1,0,0,0],[0,0,1,0,0],[0,0,0,1,0],[0,0,1,0,0],[0,1,0,0,0]]),u("~",[[0,0,0,0,0],[0,1,0,0,0],[1,0,1,0,1],[0,0,0,1,0],[0,0,0,0,0]]),u("`",[[0,1,0,0,0],[0,0,1,0,0],[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,0]]),u("#",[[0,1,0,1,0],[1,1,1,1,1],[0,1,0,1,0],[1,1,1,1,1],[0,1,0,1,0]]);var l=n(58);function c(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function f(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}n.d(e,"a",function(){return h});var h=function(){function t(e,n,r,i,u,f,h,d,v,p){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.title=n,this.metadata=r,this.objects=i,this.legends=u,this.sounds=f,this.collisionLayers=h,this.winConditions=v,this.levels=p,this.rules=d,this.cachedBackgroundSprite=null;var y=this.objects.filter(function(t){return t.hasPixels()})[0];if(y){var g=y.getPixels(1,1);this.cacheSpriteSize={spriteHeight:g.length,spriteWidth:g[0].length}}else this.cacheSpriteSize={spriteHeight:1,spriteWidth:1};var m=this.objects.length;this.letterSprites=function(t){var e=new Map,n=!0,r=!1,i=void 0;try{for(var u,l=a.entries()[Symbol.iterator]();!(n=(u=l.next()).done);n=!0){var c=o(u.value,2),f=c[0],h=s(t,f,c[1]);e.set(f,h)}}catch(t){r=!0,i=t}finally{try{n||null==l.return||l.return()}finally{if(r)throw i}}return e}(e);var b=!0,w=!1,_=void 0;try{for(var S,k=this.letterSprites.values()[Symbol.iterator]();!(b=(S=k.next()).done);b=!0){S.value.allSpritesBitSetIndex=m++}}catch(t){w=!0,_=t}finally{try{b||null==k.return||k.return()}finally{if(w)throw _}}var E=new l.a(e,c(this.letterSprites.values()));this.collisionLayers.push(E)}var e,n,r;return e=t,(n=[{key:"_getSpriteByName",value:function(t){return this.objects.find(function(e){return e.getName().toLowerCase()===t.toLowerCase()})||null}},{key:"_getTileByName",value:function(t){return this.legends.find(function(e){return e.getName().toLowerCase()===t.toLowerCase()})}},{key:"getSpriteByName",value:function(t){var e=this._getSpriteByName(t);if(!e)throw new Error('BUG: Could not find sprite "'.concat(t,'" but expected one to exist.'));return e}},{key:"getTileByName",value:function(t){var e=this._getTileByName(t);if(!e)throw new Error('BUG: Could not find tile "'.concat(t,'" but expected one to exist.'));return e}},{key:"getMagicBackgroundSprite",value:function(){if(this.cachedBackgroundSprite)return this.cachedBackgroundSprite;var t=this._getSpriteByName("background");if(!t){var e=this.legends.find(function(t){return"background"===t.getName().toLowerCase()});if(e)return e.isOr()?null:e.getSprites()[0]}if(!t)throw new Error("ERROR: Game does not have a Background Sprite or Tile");return this.cachedBackgroundSprite=t,t}},{key:"getPlayer",value:function(){var t=this._getSpriteByName("player")||this.legends.find(function(t){return"player"===t.getName().toLowerCase()});if(!t)throw new Error("BUG: Could not find the Player sprite or tile in the game");return t}},{key:"clearCaches",value:function(){var t=!0,e=!1,n=void 0;try{for(var r,i=this.rules[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){r.value.clearCaches()}}catch(t){e=!0,n=t}finally{try{t||null==i.return||i.return()}finally{if(e)throw n}}var o=!0,a=!1,s=void 0;try{for(var u,l=this.objects[Symbol.iterator]();!(o=(u=l.next()).done);o=!0){u.value.clearCaches()}}catch(t){a=!0,s=t}finally{try{o||null==l.return||l.return()}finally{if(a)throw s}}}},{key:"getSpriteSize",value:function(){return this.cacheSpriteSize}},{key:"getLetterSprite",value:function(t){var e=this.letterSprites.get(t);if(!e)throw new Error('BUG: Cannot find sprite for letter "'.concat(t,'"'));return e}}])&&f(e.prototype,n),r&&f(e,r),t}()},function(t,e,n){var r=n(6),i=n(4).document,o=r(i)&&r(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},function(t,e,n){var r=n(4),i=n(26),o=n(38),a=n(111),s=n(11).f;t.exports=function(t){var e=i.Symbol||(i.Symbol=o?{}:r.Symbol||{});"_"==t.charAt(0)||t in e||s(e,t,{value:a.f(t)})}},function(t,e,n){var r=n(63)("keys"),i=n(42);t.exports=function(t){return r[t]||(r[t]=i(t))}},function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e,n){var r=n(4).document;t.exports=r&&r.documentElement},function(t,e,n){var r=n(6),i=n(3),o=function(t,e){if(i(t),!r(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,r){try{(r=n(27)(Function.call,n(24).f(Object.prototype,"__proto__").set,2))(t,[]),e=!(t instanceof Array)}catch(t){e=!0}return function(t,n){return o(t,n),e?t.__proto__=n:r(t,n),t}}({},!1):void 0),check:o}},function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(t,e,n){var r=n(6),i=n(84).set;t.exports=function(t,e,n){var o,a=e.constructor;return a!==n&&"function"==typeof a&&(o=a.prototype)!==n.prototype&&r(o)&&i&&i(t,o),t}},function(t,e,n){"use strict";var r=n(29),i=n(32);t.exports=function(t){var e=String(i(this)),n="",o=r(t);if(o<0||o==1/0)throw RangeError("Count can't be negative");for(;o>0;(o>>>=1)&&(e+=e))1&o&&(n+=e);return n}},function(t,e){t.exports=Math.sign||function(t){return 0==(t=+t)||t!=t?t:t<0?-1:1}},function(t,e){var n=Math.expm1;t.exports=!n||n(10)>22025.465794806718||n(10)<22025.465794806718||-2e-17!=n(-2e-17)?function(t){return 0==(t=+t)?t:t>-1e-6&&t<1e-6?t+t*t/2:Math.exp(t)-1}:n},function(t,e,n){"use strict";var r=n(38),i=n(1),o=n(19),a=n(18),s=n(55),u=n(91),l=n(52),c=n(25),f=n(8)("iterator"),h=!([].keys&&"next"in[].keys()),d=function(){return this};t.exports=function(t,e,n,v,p,y,g){u(n,e,v);var m,b,w,_=function(t){if(!h&&t in T)return T[t];switch(t){case"keys":case"values":return function(){return new n(this,t)}}return function(){return new n(this,t)}},S=e+" Iterator",k="values"==p,E=!1,T=t.prototype,O=T[f]||T["@@iterator"]||p&&T[p],x=O||_(p),C=p?k?_("entries"):x:void 0,M="Array"==e&&T.entries||O;if(M&&(w=c(M.call(new t)))!==Object.prototype&&w.next&&(l(w,S,!0),r||"function"==typeof w[f]||a(w,f,d)),k&&O&&"values"!==O.name&&(E=!0,x=function(){return O.call(this)}),r&&!g||!h&&!E&&T[f]||a(T,f,x),s[e]=x,s[S]=d,p)if(m={values:k?x:_("values"),keys:y?x:_("keys"),entries:C},g)for(b in m)b in T||o(T,b,m[b]);else i(i.P+i.F*(h||E),e,m);return m}},function(t,e,n){"use strict";var r=n(45),i=n(41),o=n(52),a={};n(18)(a,n(8)("iterator"),function(){return this}),t.exports=function(t,e,n){t.prototype=r(a,{next:i(1,n)}),o(t,e+" Iterator")}},function(t,e,n){var r=n(68),i=n(32);t.exports=function(t,e,n){if(r(e))throw TypeError("String#"+n+" doesn't accept regex!");return String(i(t))}},function(t,e,n){var r=n(8)("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[r]=!1,!"/./"[t](e)}catch(t){}}return!0}},function(t,e,n){var r=n(55),i=n(8)("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(r.Array===t||o[i]===t)}},function(t,e,n){"use strict";var r=n(11),i=n(41);t.exports=function(t,e,n){e in t?r.f(t,e,i(0,n)):t[e]=n}},function(t,e,n){var r=n(53),i=n(8)("iterator"),o=n(55);t.exports=n(26).getIteratorMethod=function(t){if(null!=t)return t[i]||t["@@iterator"]||o[r(t)]}},function(t,e,n){var r=n(245);t.exports=function(t,e){return new(r(t))(e)}},function(t,e,n){"use strict";var r=n(12),i=n(44),o=n(9);t.exports=function(t){for(var e=r(this),n=o(e.length),a=arguments.length,s=i(a>1?arguments[1]:void 0,n),u=a>2?arguments[2]:void 0,l=void 0===u?n:i(u,n);l>s;)e[s++]=t;return e}},function(t,e,n){"use strict";var r=n(39),i=n(128),o=n(55),a=n(23);t.exports=n(90)(Array,"Array",function(t,e){this._t=a(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,i(1)):i(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])},"values"),o.Arguments=o.Array,r("keys"),r("values"),r("entries")},function(t,e,n){"use strict";var r,i,o=n(61),a=RegExp.prototype.exec,s=String.prototype.replace,u=a,l=(r=/a/,i=/b*/g,a.call(r,"a"),a.call(i,"a"),0!==r.lastIndex||0!==i.lastIndex),c=void 0!==/()??/.exec("")[1];(l||c)&&(u=function(t){var e,n,r,i,u=this;return c&&(n=new RegExp("^"+u.source+"$(?!\\s)",o.call(u))),l&&(e=u.lastIndex),r=a.call(u,t),l&&r&&(u.lastIndex=u.global?r.index+r[0].length:e),c&&r&&r.length>1&&s.call(r[0],n,function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(r[i]=void 0)}),r}),t.exports=u},function(t,e,n){"use strict";var r=n(67)(!0);t.exports=function(t,e,n){return e+(n?r(t,e).length:1)}},function(t,e,n){var r,i,o,a=n(27),s=n(118),u=n(83),l=n(79),c=n(4),f=c.process,h=c.setImmediate,d=c.clearImmediate,v=c.MessageChannel,p=c.Dispatch,y=0,g={},m=function(){var t=+this;if(g.hasOwnProperty(t)){var e=g[t];delete g[t],e()}},b=function(t){m.call(t.data)};h&&d||(h=function(t){for(var e=[],n=1;arguments.length>n;)e.push(arguments[n++]);return g[++y]=function(){s("function"==typeof t?t:Function(t),e)},r(y),y},d=function(t){delete g[t]},"process"==n(28)(f)?r=function(t){f.nextTick(a(m,t,1))}:p&&p.now?r=function(t){p.now(a(m,t,1))}:v?(o=(i=new v).port2,i.port1.onmessage=b,r=a(o.postMessage,o,1)):c.addEventListener&&"function"==typeof postMessage&&!c.importScripts?(r=function(t){c.postMessage(t+"","*")},c.addEventListener("message",b,!1)):r="onreadystatechange"in l("script")?function(t){u.appendChild(l("script")).onreadystatechange=function(){u.removeChild(this),m.call(t)}}:function(t){setTimeout(a(m,t,1),0)}),t.exports={set:h,clear:d}},function(t,e,n){var r=n(4),i=n(102).set,o=r.MutationObserver||r.WebKitMutationObserver,a=r.process,s=r.Promise,u="process"==n(28)(a);t.exports=function(){var t,e,n,l=function(){var r,i;for(u&&(r=a.domain)&&r.exit();t;){i=t.fn,t=t.next;try{i()}catch(r){throw t?n():e=void 0,r}}e=void 0,r&&r.enter()};if(u)n=function(){a.nextTick(l)};else if(!o||r.navigator&&r.navigator.standalone)if(s&&s.resolve){var c=s.resolve(void 0);n=function(){c.then(l)}}else n=function(){i.call(r,l)};else{var f=!0,h=document.createTextNode("");new o(l).observe(h,{characterData:!0}),n=function(){h.data=f=!f}}return function(r){var i={fn:r,next:void 0};e&&(e.next=i),t||(t=i,n()),e=i}}},function(t,e,n){"use strict";var r=n(15);function i(t){var e,n;this.promise=new t(function(t,r){if(void 0!==e||void 0!==n)throw TypeError("Bad Promise constructor");e=t,n=r}),this.resolve=r(e),this.reject=r(n)}t.exports.f=function(t){return new i(t)}},function(t,e,n){"use strict";var r=n(4),i=n(10),o=n(38),a=n(74),s=n(18),u=n(50),l=n(5),c=n(48),f=n(29),h=n(9),d=n(138),v=n(46).f,p=n(11).f,y=n(98),g=n(52),m="prototype",b="Wrong index!",w=r.ArrayBuffer,_=r.DataView,S=r.Math,k=r.RangeError,E=r.Infinity,T=w,O=S.abs,x=S.pow,C=S.floor,M=S.log,R=S.LN2,I=i?"_b":"buffer",A=i?"_l":"byteLength",L=i?"_o":"byteOffset";function P(t,e,n){var r,i,o,a=new Array(n),s=8*n-e-1,u=(1<<s)-1,l=u>>1,c=23===e?x(2,-24)-x(2,-77):0,f=0,h=t<0||0===t&&1/t<0?1:0;for((t=O(t))!=t||t===E?(i=t!=t?1:0,r=u):(r=C(M(t)/R),t*(o=x(2,-r))<1&&(r--,o*=2),(t+=r+l>=1?c/o:c*x(2,1-l))*o>=2&&(r++,o/=2),r+l>=u?(i=0,r=u):r+l>=1?(i=(t*o-1)*x(2,e),r+=l):(i=t*x(2,l-1)*x(2,e),r=0));e>=8;a[f++]=255&i,i/=256,e-=8);for(r=r<<e|i,s+=e;s>0;a[f++]=255&r,r/=256,s-=8);return a[--f]|=128*h,a}function N(t,e,n){var r,i=8*n-e-1,o=(1<<i)-1,a=o>>1,s=i-7,u=n-1,l=t[u--],c=127&l;for(l>>=7;s>0;c=256*c+t[u],u--,s-=8);for(r=c&(1<<-s)-1,c>>=-s,s+=e;s>0;r=256*r+t[u],u--,s-=8);if(0===c)c=1-a;else{if(c===o)return r?NaN:l?-E:E;r+=x(2,e),c-=a}return(l?-1:1)*r*x(2,c-e)}function D(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]}function G(t){return[255&t]}function B(t){return[255&t,t>>8&255]}function F(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]}function j(t){return P(t,52,8)}function U(t){return P(t,23,4)}function W(t,e,n){p(t[m],e,{get:function(){return this[n]}})}function H(t,e,n,r){var i=d(+n);if(i+e>t[A])throw k(b);var o=t[I]._b,a=i+t[L],s=o.slice(a,a+e);return r?s:s.reverse()}function q(t,e,n,r,i,o){var a=d(+n);if(a+e>t[A])throw k(b);for(var s=t[I]._b,u=a+t[L],l=r(+i),c=0;c<e;c++)s[u+c]=l[o?c:e-c-1]}if(a.ABV){if(!l(function(){w(1)})||!l(function(){new w(-1)})||l(function(){return new w,new w(1.5),new w(NaN),"ArrayBuffer"!=w.name})){for(var z,V=(w=function(t){return c(this,w),new T(d(t))})[m]=T[m],K=v(T),Y=0;K.length>Y;)(z=K[Y++])in w||s(w,z,T[z]);o||(V.constructor=w)}var J=new _(new w(2)),X=_[m].setInt8;J.setInt8(0,2147483648),J.setInt8(1,2147483649),!J.getInt8(0)&&J.getInt8(1)||u(_[m],{setInt8:function(t,e){X.call(this,t,e<<24>>24)},setUint8:function(t,e){X.call(this,t,e<<24>>24)}},!0)}else w=function(t){c(this,w,"ArrayBuffer");var e=d(t);this._b=y.call(new Array(e),0),this[A]=e},_=function(t,e,n){c(this,_,"DataView"),c(t,w,"DataView");var r=t[A],i=f(e);if(i<0||i>r)throw k("Wrong offset!");if(i+(n=void 0===n?r-i:h(n))>r)throw k("Wrong length!");this[I]=t,this[L]=i,this[A]=n},i&&(W(w,"byteLength","_l"),W(_,"buffer","_b"),W(_,"byteLength","_l"),W(_,"byteOffset","_o")),u(_[m],{getInt8:function(t){return H(this,1,t)[0]<<24>>24},getUint8:function(t){return H(this,1,t)[0]},getInt16:function(t){var e=H(this,2,t,arguments[1]);return(e[1]<<8|e[0])<<16>>16},getUint16:function(t){var e=H(this,2,t,arguments[1]);return e[1]<<8|e[0]},getInt32:function(t){return D(H(this,4,t,arguments[1]))},getUint32:function(t){return D(H(this,4,t,arguments[1]))>>>0},getFloat32:function(t){return N(H(this,4,t,arguments[1]),23,4)},getFloat64:function(t){return N(H(this,8,t,arguments[1]),52,8)},setInt8:function(t,e){q(this,1,t,G,e)},setUint8:function(t,e){q(this,1,t,G,e)},setInt16:function(t,e){q(this,2,t,B,e,arguments[2])},setUint16:function(t,e){q(this,2,t,B,e,arguments[2])},setInt32:function(t,e){q(this,4,t,F,e,arguments[2])},setUint32:function(t,e){q(this,4,t,F,e,arguments[2])},setFloat32:function(t,e){q(this,4,t,U,e,arguments[2])},setFloat64:function(t,e){q(this,8,t,j,e,arguments[2])}});g(w,"ArrayBuffer"),g(_,"DataView"),s(_[m],a.VIEW,!0),e.ArrayBuffer=w,e.DataView=_},function(t,e,n){var r;function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}
/**
 * @license BitSet.js v5.0.4 4/3/2018
 * http://www.xarg.org/2014/03/javascript-bit-array/
 *
 * Copyright (c) 2016, Robert Eisele (robert@xarg.org)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 **/
/**
 * @license BitSet.js v5.0.4 4/3/2018
 * http://www.xarg.org/2014/03/javascript-bit-array/
 *
 * Copyright (c) 2016, Robert Eisele (robert@xarg.org)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 **/
!function(n){"use strict";var o=32,a=5;function s(t){return 16843009*((t=(858993459&(t-=t>>>1&1431655765))+(t>>>2&858993459))+(t>>>4)&252645135)>>>24}function u(t,e){for(var n=0,r=0;r<t.length;r++){n*=2;var i=(t[r]+n)/e|0;n=(t[r]+n)%e,t[r]=i}return n}function l(t,e){if(null==e)return t.data=[0,0,0,0,0,0,0,0,0,0],void(t._=0);if(e instanceof c)return t.data=e.data,void(t._=e._);switch(i(e)){case"number":t.data=[0|e],t._=0;break;case"string":var n=2,r=o;0===e.indexOf("0b")?e=e.substr(2):0===e.indexOf("0x")&&(e=e.substr(2),n=16,r=8),t.data=[],t._=0;for(var s=e.length-r,u=e.length;;){var l=parseInt(e.slice(s>0?s:0,u),n);if(isNaN(l))throw SyntaxError("Invalid param");if(t.data.push(0|l),s<=0)break;s-=r,u-=r}break;default:t.data=[0];var h=t.data;if(e instanceof Array){for(var d=e.length-1;d>=0;d--){var v=e[d];v===1/0?t._=-1:(f(t,v),h[v>>>a]|=1<<v)}break}if(Uint8Array&&e instanceof Uint8Array){f(t,8*e.length);for(d=0;d<e.length;d++)for(var p=e[d],y=0;y<8;y++){var g=8*d+y;h[g>>>a]|=(p>>y&1)<<g}break}throw SyntaxError("Invalid param")}}function c(t){if(!(this instanceof c))return new c(t);l(this,t),this.data=this.data.slice()}function f(t,e){for(var n=e>>>a,r=t.data,i=t._,o=r.length;n>=o;n--)r.push(i)}var h={data:[],_:0};c.prototype={data:[],_:0,set:function(t,e){return f(this,t|=0),void 0===e||e?this.data[t>>>a]|=1<<t:this.data[t>>>a]&=~(1<<t),this},get:function(t){t|=0;var e=this.data,n=t>>>a;return n>e.length?1&this._:e[n]>>>t&1},not:function(){for(var t=this.clone(),e=t.data,n=0;n<e.length;n++)e[n]=~e[n];return t._=~t._,t},and:function(t){l(h,t);var e=this.clone(),n=e.data,r=h.data,i=r.length,a=h._;0!==e._&&f(e,i*o-1);for(var s=n.length,u=Math.min(i,s),c=0;c<u;c++)n[c]&=r[c];for(;c<s;c++)n[c]&=a;return e._&=a,e},or:function(t){l(h,t);for(var e=this.clone(),n=e.data,r=h.data,i=r.length-1,o=n.length-1,a=Math.min(o,i),s=i;s>a;s--)n[s]=r[s];for(;s>=0;s--)n[s]|=r[s];return e._|=h._,e},xor:function(t){l(h,t);var e=this.clone(),n=e.data,r=h.data,i=e._,o=h._,a=0,s=n.length-1,u=r.length-1;for(a=s;a>u;a--)n[a]^=o;for(a=u;a>s;a--)n[a]=i^r[a];for(;a>=0;a--)n[a]^=r[a];return e._^=o,e},andNot:function(t){return this.and(new c(t).flip())},flip:function(t,e){if(void 0===t){for(var n=this.data,r=0;r<n.length;r++)n[r]=~n[r];this._=~this._}else if(void 0===e)f(this,t),this.data[t>>>a]^=1<<t;else if(0<=t&&t<=e){f(this,e);for(r=t;r<=e;r++)this.data[r>>>a]^=1<<r}return this},clear:function(t,e){var n=this.data;if(void 0===t){for(var r=n.length-1;r>=0;r--)n[r]=0;this._=0}else if(void 0===e)f(this,t|=0),n[t>>>a]&=~(1<<t);else if(t<=e){f(this,e);for(r=t;r<=e;r++)n[r>>>a]&=~(1<<r)}return this},slice:function(t,e){if(void 0===t)return this.clone();if(void 0===e){e=this.data.length*o,(r=Object.create(c.prototype))._=this._,r.data=[0];for(var n=t;n<=e;n++)r.set(n-t,this.get(n));return r}if(t<=e&&0<=t){var r;(r=Object.create(c.prototype)).data=[0];for(n=t;n<=e;n++)r.set(n-t,this.get(n));return r}return null},setRange:function(t,e,n){for(var r=t;r<=e;r++)this.set(r,n);return this},clone:function(){var t=Object.create(c.prototype);return t.data=this.data.slice(),t._=this._,t},toArray:Math.clz32?function(){for(var t=[],e=this.data,n=e.length-1;n>=0;n--)for(var r=e[n];0!==r;){var i=31-Math.clz32(r);r^=1<<i,t.unshift(n*o+i)}return 0!==this._&&t.push(1/0),t}:function(){for(var t=[],e=this.data,n=0;n<e.length;n++)for(var r=e[n];0!==r;){var i=r&-r;r^=i,t.push(n*o+s(i-1))}return 0!==this._&&t.push(1/0),t},toString:function(t){var e=this.data;if(t||(t=2),0==(t&t-1)&&t<36){for(var n="",r=2+Math.log(4294967295)/Math.log(t)|0,i=e.length-1;i>=0;i--){var a=e[i];a<0&&(a+=4294967296);var s=a.toString(t);""!==n&&(n+="0".repeat(r-s.length-1)),n+=s}return 0===this._?(""===(n=n.replace(/^0+/,""))&&(n="0"),n):(n="1111"+n).replace(/^1+/,"...1111")}if(2>t||t>36)throw SyntaxError("Invalid base");n=[];var l=[];for(i=e.length;i--;)for(var c=o;c--;)l.push(e[i]>>>c&1);do{n.unshift(u(l,t).toString(t))}while(!l.every(function(t){return 0===t}));return n.join("")},isEmpty:function(){if(0!==this._)return!1;for(var t=this.data,e=t.length-1;e>=0;e--)if(0!==t[e])return!1;return!0},cardinality:function(){if(0!==this._)return 1/0;for(var t=0,e=this.data,n=0;n<e.length;n++){var r=e[n];0!==r&&(t+=s(r))}return t},msb:Math.clz32?function(){if(0!==this._)return 1/0;for(var t=this.data,e=t.length;e-- >0;){var n=Math.clz32(t[e]);if(n!==o)return e*o+o-1-n}return 1/0}:function(){if(0!==this._)return 1/0;for(var t=this.data,e=t.length;e-- >0;){var n=t[e],r=0;if(n){for(;(n>>>=1)>0;r++);return e*o+r}}return 1/0},ntz:function(){for(var t=this.data,e=0;e<t.length;e++){var n=t[e];if(0!==n)return e*o+s(n=(n^n-1)>>>1)}return 1/0},lsb:function(){for(var t=this.data,e=0;e<t.length;e++){var n=t[e],r=0;if(n){for(var i=n&-n;i>>>=1;r++);return o*e+r}}return 1&this._},equals:function(t){l(h,t);var e=this.data,n=h.data,r=this._,i=h._,o=e.length-1,a=n.length-1;if(i!==r)return!1;for(var s=o<a?o:a,u=0;u<=s;u++)if(e[u]!==n[u])return!1;for(u=o;u>a;u--)if(e[u]!==i)return!1;for(u=a;u>o;u--)if(n[u]!==r)return!1;return!0}},c.fromBinaryString=function(t){return new c("0b"+t)},c.fromHexString=function(t){return new c("0x"+t)},c.Random=function(t){(void 0===t||t<0)&&(t=o);for(var e=t%o,n=[],r=Math.ceil(t/o),i=Object.create(c.prototype),a=0;a<r;a++)n.push(4294967296*Math.random()|0);return e>0&&(n[r-1]&=(1<<e)-1),i.data=n,i._=0,i},void 0===(r=function(){return c}.apply(e,[]))||(t.exports=r)}()},function(t,e){var n,r,i=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(t){n=o}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(t){r=a}}();var u,l=[],c=!1,f=-1;function h(){c&&u&&(c=!1,u.length?l=u.concat(l):f=-1,l.length&&d())}function d(){if(!c){var t=s(h);c=!0;for(var e=l.length;e;){for(u=l,l=[];++f<e;)u&&u[f].run();f=-1,e=l.length}u=null,c=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function v(t,e){this.fun=t,this.array=e}function p(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];l.push(new v(t,e)),1!==l.length||c||s(d)},v.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=p,i.addListener=p,i.once=p,i.off=p,i.removeListener=p,i.removeAllListeners=p,i.emit=p,i.prependListener=p,i.prependOnceListener=p,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e,n){"use strict";n.d(e,"a",function(){return S});var r,i=n(58),o=n(16),a=n(78),s=n(51),u=n(7),l=n(14),c=n(57),f=n(2);function h(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function d(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(e){v(t,e,n[e])})}return t}function v(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function p(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function y(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function g(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function m(t,e,n){return e&&g(t.prototype,e),n&&g(t,n),t}function b(t){return t}!function(t){t.OR="OR",t.AND="AND",t.SIMPLE="SIMPLE",t.SPRITE="SPRITE"}(r||(r={}));var w=function(){function t(e){y(this,t),this.counter=0,this.prefix=e,this.idMap=new Map,this.jsonMap=new Map}return m(t,[{key:"set",value:function(t,e,n){return this.idMap.has(t)||this.idMap.set(t,n||this.freshId()),this.jsonMap.set(t,e),this.getId(t)}},{key:"get",value:function(t){var e=this.jsonMap.get(t);if(!e)throw new Error("BUG: Element has not been added to the set");return e}},{key:"getId",value:function(t){var e=this.idMap.get(t);if(!e)throw new Error("BUG: Element has not been added to the set");return e}},{key:"toJson",value:function(){var t={},e=!0,n=!1,r=void 0;try{for(var i,o=this.idMap[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=p(i.value,2),s=a[0],u=a[1],l=this.jsonMap.get(s);if(!l)throw new Error('BUG: Could not find matching json representation for "'.concat(u,'"'));t[u]=l}}catch(t){n=!0,r=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}return t}},{key:"freshId",value:function(){return"".concat(this.prefix,"-").concat(this.counter++)}}]),t}(),_=function(){function t(){y(this,t),this.map=new Map}return m(t,[{key:"get",value:function(t){var e=this.map.get(t);if(!e)throw new Error('ERROR: JSON is missing key "'.concat(t,'". Should have already been added'));return e}},{key:"set",value:function(t,e){this.map.set(t,e)}},{key:"values",value:function(){return this.map.values()}}]),t}(),S=function(){function t(e){var n=this;if(y(this,t),this.game=e,this.colorsMap=new Map,this.spritesMap=new w("sprite"),this.soundMap=new w("sound"),this.collisionLayerMap=new w("collision"),this.conditionsMap=new w("bracket"),this.neighborsMap=new w("neighbor"),this.tileWithModifierMap=new w("twm"),this.tileMap=new w("tile"),this.ruleMap=new w("rule"),this.commandMap=new w("command"),this.game.metadata.backgroundColor){var r=this.game.metadata.backgroundColor.toHex();this.colorsMap.set(r,r)}if(this.game.metadata.textColor){var i=this.game.metadata.textColor.toHex();this.colorsMap.set(i,i)}this.game.collisionLayers.forEach(function(t){return n.buildCollisionLayer(t)}),this.game.sounds.forEach(function(t){n.buildSound(t)}),this.game.objects.forEach(function(t){n.buildSprite(t)}),this.orderedRules=this.game.rules.map(function(t){return n.recBuildRule(t)}),this.game.legends.forEach(function(t){n.buildTile(t)}),this.levels=this.game.levels.map(function(t){return n.buildLevel(t)}),this.winConditions=this.game.winConditions.map(function(t){return t instanceof c.a?{_sourceOffset:t.__source.sourceOffset,type:f.j.ON,qualifier:t.qualifier,tile:n.buildTile(t.tile),onTile:n.buildTile(t.onTile)}:{_sourceOffset:t.__source.sourceOffset,type:f.j.SIMPLE,qualifier:t.qualifier,tile:n.buildTile(t.tile)}})}return m(t,null,[{key:"fromJson",value:function(t,e){for(var n=new _,r=new _,v=new _,y=new _,g=new _,m=new _,b=new _,w=new _,S=new _,k=new _,E=Object.entries(t.colors),T=0;T<E.length;T++){var O=p(E[T],2),x=O[0],C=O[1];n.set(x,new o.a({code:e,sourceOffset:0},C))}for(var M=new _,R=Object.entries(t.collisionLayers),I=0;I<R.length;I++){var A=p(R[I],1)[0];M.set(A,[])}for(var L=new o.b({code:e,sourceOffset:0}),P=0,N=Object.entries(t.sprites),D=0;D<N.length;D++){var G=p(N[D],2),B=G[0],F=(C=G[1])._sourceOffset,j=C.name,U=C.pixels,W=new l.e({code:e,sourceOffset:F},j,null,U.map(function(t){return t.map(function(t){return t&&n.get(t)||L})}));W.allSpritesBitSetIndex=P,P++,r.set(B,W),M.get(C.collisionLayer).push(W)}for(var H=Object.entries(t.tiles),q=0;q<H.length;q++){var z=p(H[q],2),V=z[0],K=(F=(C=z[1])._sourceOffset,void 0);switch(C.type){case"OR":K=new l.b({code:e,sourceOffset:F},C.name,C.sprites.map(function(t){return r.get(t)}));break;case"AND":K=new l.a({code:e,sourceOffset:F},C.name,C.sprites.map(function(t){return r.get(t)}));break;case"SIMPLE":case"SPRITE":K=new l.c({code:e,sourceOffset:F},C.name,r.get(C.sprite));break;default:throw new Error("ERROR: Unsupported tile type")}w.set(V,K)}for(var Y=Object.entries(t.sounds),J=0;J<Y.length;J++){var X=p(Y[J],2),$=X[0];switch((C=X[1]).type){case f.g.SFX:case f.g.WHEN:v.set($,d({},C));break;case f.g.SPRITE_DIRECTION:case f.g.SPRITE_EVENT:case f.g.SPRITE_MOVE:v.set($,d({},C,{sprite:w.get(C.sprite)}))}}for(var Z=Object.entries(t.commands),Q=0;Q<Z.length;Q++){var tt=p(Z[Q],2),et=tt[0];switch((C=tt[1]).type){case f.c.MESSAGE:k.set(et,C);break;case f.c.SFX:k.set(et,d({},C,{sound:v.get(C.sound)}));break;case f.c.RESTART:case f.c.AGAIN:case f.c.CANCEL:case f.c.CHECKPOINT:case f.c.WIN:k.set(et,C);break;default:throw new Error("ERROR: Unsupported command type")}}for(var nt=Object.entries(t.collisionLayers),rt=0;rt<nt.length;rt++){var it=p(nt[rt],2),ot=it[0];F=(C=it[1])._sourceOffset;y.set(ot,new i.a({code:e,sourceOffset:F},M.get(ot)))}for(var at=Object.entries(t.tilesWithModifiers),st=0;st<at.length;st++){var ut=p(at[st],2),lt=ut[0];F=(C=ut[1])._sourceOffset;b.set(lt,new u.h({code:e,sourceOffset:F},C.isNegated,C.isRandom,C.direction,w.get(C.tile),C.debugFlag))}for(var ct=Object.entries(t.neighbors),ft=0;ft<ct.length;ft++){var ht=p(ct[ft],2),dt=ht[0];F=(C=ht[1])._sourceOffset;m.set(dt,new u.d({code:e,sourceOffset:F},new Set(C.tileWithModifiers.map(function(t){return b.get(t)})),C.debugFlag))}for(var vt=Object.entries(t.brackets),pt=0;pt<vt.length;pt++){var yt=p(vt[pt],2),gt=yt[0];F=(C=yt[1])._sourceOffset;switch(C.type){case f.a.SIMPLE:g.set(gt,new u.b({code:e,sourceOffset:F},C.direction,C.neighbors.map(function(t){return m.get(t)}),C.debugFlag));break;case f.a.ELLIPSIS:g.set(gt,new u.c({code:e,sourceOffset:F},C.direction,C.beforeNeighbors.map(function(t){return m.get(t)}),C.afterNeighbors.map(function(t){return m.get(t)}),C.debugFlag));break;default:throw new Error("ERROR: Unsupported bracket type")}}for(var mt=Object.entries(t.ruleDefinitions),bt=0;bt<mt.length;bt++){var wt=p(mt[bt],2),_t=wt[0];F=(C=wt[1])._sourceOffset;switch(C.type){case f.f.SIMPLE:S.set(_t,new u.e({code:e,sourceOffset:F},C.conditions.map(function(t){return g.get(t)}),C.actions.map(function(t){return g.get(t)}),C.commands.map(function(t){return k.get(t)}),C.isLate,C.isRigid,C.debugFlag));break;case f.f.GROUP:S.set(_t,new u.f({code:e,sourceOffset:F},C.isRandom,C.rules.map(function(t){return S.get(t)})));break;case f.f.LOOP:S.set(_t,new u.g({code:e,sourceOffset:F},!1,C.rules.map(function(t){return S.get(t)})));break;default:throw new Error("ERROR: Unsupported rule type")}}for(var St=t.levels.map(function(t){switch(t.type){case f.d.MAP:return d({},t,{cells:t.cells.map(function(t){return t.map(function(t){return w.get(t)})})});case f.d.MESSAGE:return t;default:throw new Error("ERROR: Invalid level type")}}),kt=t.winConditions.map(function(t){var n=t._sourceOffset;switch(t.type){case f.j.SIMPLE:return new c.b({code:e,sourceOffset:n},t.qualifier,w.get(t.tile));case f.j.ON:return new c.a({code:e,sourceOffset:n},t.qualifier,w.get(t.tile),w.get(t.onTile));default:throw new Error("ERROR: Unsupported Win Condition type")}}),Et=new s.b,Tt=Object.entries(t.metadata),Ot=0;Ot<Tt.length;Ot++){var xt=p(Tt[Ot],2),Ct=xt[0];if(C=xt[1])switch(Ct){case"backgroundColor":case"textColor":Et._setValue(Ct,n.get(C));break;case"zoomScreen":case"flickScreen":var Mt=C.width,Rt=C.height;Et._setValue(Ct,new s.a(Mt,Rt));break;default:Et._setValue(Ct,C)}}return new a.a({code:e,sourceOffset:0},t.title,Et,h(r.values()),h(w.values()),h(v.values()),h(y.values()),t.rules.map(function(t){return S.get(t)}),kt,St)}}]),m(t,[{key:"buildCollisionLayer",value:function(t){return this.collisionLayerMap.set(t,{_sourceOffset:t.__source.sourceOffset})}},{key:"metadataToJson",value:function(){return{author:this.game.metadata.author,homepage:this.game.metadata.homepage,youtube:this.game.metadata.youtube,zoomscreen:this.game.metadata.zoomscreen,flickscreen:this.game.metadata.flickscreen,colorPalette:this.game.metadata.colorPalette,backgroundColor:this.game.metadata.backgroundColor?this.buildColor(this.game.metadata.backgroundColor):null,textColor:this.game.metadata.textColor?this.buildColor(this.game.metadata.textColor):null,realtimeInterval:this.game.metadata.realtimeInterval,keyRepeatInterval:this.game.metadata.keyRepeatInterval,againInterval:this.game.metadata.againInterval,noAction:this.game.metadata.noAction,noUndo:this.game.metadata.noUndo,runRulesOnLevelStart:this.game.metadata.runRulesOnLevelStart,noRepeatAction:this.game.metadata.noRepeatAction,throttleMovement:this.game.metadata.throttleMovement,noRestart:this.game.metadata.noRestart,requirePlayerMovement:this.game.metadata.requirePlayerMovement,verboseLogging:this.game.metadata.verboseLogging}}},{key:"toJson",value:function(){var t={},e=!0,n=!1,r=void 0;try{for(var i,o=this.colorsMap[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=p(i.value,2),s=a[0],u=a[1];t[s]=u}}catch(t){n=!0,r=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}return{version:1,title:this.game.title,metadata:this.metadataToJson(),colors:t,sounds:this.soundMap.toJson(),collisionLayers:this.collisionLayerMap.toJson(),commands:this.commandMap.toJson(),sprites:this.spritesMap.toJson(),tiles:this.tileMap.toJson(),tilesWithModifiers:this.tileWithModifierMap.toJson(),neighbors:this.neighborsMap.toJson(),brackets:this.conditionsMap.toJson(),ruleDefinitions:this.ruleMap.toJson(),winConditions:this.winConditions,rules:this.orderedRules,levels:this.levels}}},{key:"buildLevel",value:function(t){var e=this;switch(t.type){case f.d.MAP:return d({},t,{cells:t.cells.map(function(t){return t.map(function(t){return e.buildTile(t)})})});case f.d.MESSAGE:return t;default:throw new Error("BUG: Unsupported level subtype")}}},{key:"recBuildRule",value:function(t){var e=this;if(t instanceof u.e)return this.ruleMap.set(t,{type:f.f.SIMPLE,directions:[],conditions:t.conditionBrackets.map(function(t){return e.buildConditionBracket(t)}),actions:t.actionBrackets.map(function(t){return e.buildConditionBracket(t)}),commands:t.commands.map(function(t){return e.buildCommand(t)}),isRandom:null,isLate:t.isLate(),isRigid:t.hasRigid(),_sourceOffset:t.__source.sourceOffset,debugFlag:t.debugFlag});if(t instanceof u.f)return this.ruleMap.set(t,{type:f.f.GROUP,isRandom:t.isRandom,rules:t.getChildRules().map(function(t){return e.recBuildRule(t)}),_sourceOffset:t.__source.sourceOffset,debugFlag:null});if(t instanceof u.g){var n={type:f.f.LOOP,rules:t.getChildRules().map(function(t){return e.recBuildRule(t)}),_sourceOffset:t.__source.sourceOffset,debugFlag:null};return this.ruleMap.set(t,n)}throw new Error("BUG: Unsupported rule type")}},{key:"buildCommand",value:function(t){switch(t.type){case f.c.SFX:return this.commandMap.set(t,d({},t,{sound:this.soundMap.getId(t.sound)}));case f.c.AGAIN:case f.c.CANCEL:case f.c.CHECKPOINT:case f.c.MESSAGE:case f.c.RESTART:case f.c.WIN:return this.commandMap.set(t,t);default:throw new Error("BUG: Unsupoprted command type")}}},{key:"buildConditionBracket",value:function(t){var e=this;if(t instanceof u.c){var n=t,r=n.beforeEllipsisBracket.getNeighbors().map(function(t){return e.buildNeighbor(t)}),i=n.afterEllipsisBracket.getNeighbors().map(function(t){return e.buildNeighbor(t)});return this.conditionsMap.set(t,{type:f.a.ELLIPSIS,direction:b(n.direction),beforeNeighbors:r,afterNeighbors:i,_sourceOffset:t.__source.sourceOffset,debugFlag:n.debugFlag})}if(t instanceof u.b)return this.conditionsMap.set(t,{type:f.a.SIMPLE,direction:b(t.direction),neighbors:t.getNeighbors().map(function(t){return e.buildNeighbor(t)}),_sourceOffset:t.__source.sourceOffset,debugFlag:t.debugFlag});throw new Error("BUG: Unsupported bracket type")}},{key:"buildNeighbor",value:function(t){var e=this;return this.neighborsMap.set(t,{tileWithModifiers:h(t._tilesWithModifier).map(function(t){return e.buildTileWithModifier(t)}),_sourceOffset:t.__source.sourceOffset,debugFlag:null})}},{key:"buildTileWithModifier",value:function(t){return this.tileWithModifierMap.set(t,{direction:t._direction?b(t._direction):null,isNegated:t._isNegated,isRandom:t._isRandom,tile:this.buildTile(t._tile),_sourceOffset:t.__source.sourceOffset,debugFlag:t._debugFlag})}},{key:"buildTile",value:function(t){var e=this;if(t instanceof l.b)return this.tileMap.set(t,{type:r.OR,name:t.getName(),sprites:t.getSprites().map(function(t){return e.buildSprite(t)}),collisionLayers:t.getCollisionLayers().map(function(t){return e.buildCollisionLayer(t)}),_sourceOffset:t.__source.sourceOffset});if(t instanceof l.a)return this.tileMap.set(t,{type:r.AND,name:t.getName(),sprites:t.getSprites().map(function(t){return e.buildSprite(t)}),collisionLayers:t.getCollisionLayers().map(function(t){return e.buildCollisionLayer(t)}),_sourceOffset:t.__source.sourceOffset});if(t instanceof l.c)return this.tileMap.set(t,{type:r.SIMPLE,name:t.getName(),sprite:this.buildSprite(t.getSprites()[0]),collisionLayers:t.getCollisionLayers().map(function(t){return e.buildCollisionLayer(t)}),_sourceOffset:t.__source.sourceOffset});if(t instanceof l.d)return this.tileMap.set(t,{type:r.SPRITE,name:t.getName(),sprite:this.buildSprite(t),collisionLayer:this.buildCollisionLayer(t.getCollisionLayer()),_sourceOffset:t.__source.sourceOffset});throw new Error("BUG: Invalid tile type")}},{key:"buildSprite",value:function(t){var e=this,n=this.game.getSpriteSize(),r=n.spriteHeight,i=n.spriteWidth;return this.spritesMap.set(t,{name:t.getName(),collisionLayer:this.collisionLayerMap.getId(t.getCollisionLayer()),pixels:t.getPixels(r,i).map(function(t){return t.map(function(t){return t.isTransparent()?null:e.buildColor(t)})}),_sourceOffset:t.__source.sourceOffset})}},{key:"buildColor",value:function(t){var e=t.toHex();return this.colorsMap.set(e,e),e}},{key:"buildSound",value:function(t){switch(t.type){case f.g.SFX:case f.g.WHEN:return this.soundMap.set(t,d({},t));case f.g.SPRITE_DIRECTION:case f.g.SPRITE_EVENT:case f.g.SPRITE_MOVE:return this.soundMap.set(t,d({},t,{sprite:this.buildTile(t.sprite)}))}}}]),t}()},function(t,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(t){"object"===("undefined"==typeof window?"undefined":n(window))&&(r=window)}t.exports=r},function(t,e,n){t.exports=!n(10)&&!n(5)(function(){return 7!=Object.defineProperty(n(79)("div"),"a",{get:function(){return 7}}).a})},function(t,e,n){e.f=n(8)},function(t,e,n){var r=n(22),i=n(23),o=n(64)(!1),a=n(81)("IE_PROTO");t.exports=function(t,e){var n,s=i(t),u=0,l=[];for(n in s)n!=a&&r(s,n)&&l.push(n);for(;e.length>u;)r(s,n=e[u++])&&(~o(l,n)||l.push(n));return l}},function(t,e,n){var r=n(11),i=n(3),o=n(43);t.exports=n(10)?Object.defineProperties:function(t,e){i(t);for(var n,a=o(e),s=a.length,u=0;s>u;)r.f(t,n=a[u++],e[n]);return t}},function(t,e,n){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=n(23),o=n(46).f,a={}.toString,s="object"==("undefined"==typeof window?"undefined":r(window))&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return s&&"[object Window]"==a.call(t)?function(t){try{return o(t)}catch(t){return s.slice()}}(t):o(i(t))}},function(t,e,n){"use strict";var r=n(43),i=n(65),o=n(60),a=n(12),s=n(59),u=Object.assign;t.exports=!u||n(5)(function(){var t={},e={},n=Symbol(),r="abcdefghijklmnopqrst";return t[n]=7,r.split("").forEach(function(t){e[t]=t}),7!=u({},t)[n]||Object.keys(u({},e)).join("")!=r})?function(t,e){for(var n=a(t),u=arguments.length,l=1,c=i.f,f=o.f;u>l;)for(var h,d=s(arguments[l++]),v=c?r(d).concat(c(d)):r(d),p=v.length,y=0;p>y;)f.call(d,h=v[y++])&&(n[h]=d[h]);return n}:u},function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}},function(t,e,n){"use strict";var r=n(15),i=n(6),o=n(118),a=[].slice,s={};t.exports=Function.bind||function(t){var e=r(this),n=a.call(arguments,1),u=function r(){var i=n.concat(a.call(arguments));return this instanceof r?function(t,e,n){if(!(e in s)){for(var r=[],i=0;i<e;i++)r[i]="a["+i+"]";s[e]=Function("F,a","return new F("+r.join(",")+")")}return s[e](t,n)}(e,i.length,i):o(e,i,t)};return i(e.prototype)&&(u.prototype=e.prototype),u}},function(t,e){t.exports=function(t,e,n){var r=void 0===n;switch(e.length){case 0:return r?t():t.call(n);case 1:return r?t(e[0]):t.call(n,e[0]);case 2:return r?t(e[0],e[1]):t.call(n,e[0],e[1]);case 3:return r?t(e[0],e[1],e[2]):t.call(n,e[0],e[1],e[2]);case 4:return r?t(e[0],e[1],e[2],e[3]):t.call(n,e[0],e[1],e[2],e[3])}return t.apply(n,e)}},function(t,e,n){var r=n(4).parseInt,i=n(54).trim,o=n(85),a=/^[-+]?0[xX]/;t.exports=8!==r(o+"08")||22!==r(o+"0x16")?function(t,e){var n=i(String(t),3);return r(n,e>>>0||(a.test(n)?16:10))}:r},function(t,e,n){var r=n(4).parseFloat,i=n(54).trim;t.exports=1/r(n(85)+"-0")!=-1/0?function(t){var e=i(String(t),3),n=r(e);return 0===n&&"-"==e.charAt(0)?-0:n}:r},function(t,e,n){var r=n(28);t.exports=function(t,e){if("number"!=typeof t&&"Number"!=r(t))throw TypeError(e);return+t}},function(t,e,n){var r=n(6),i=Math.floor;t.exports=function(t){return!r(t)&&isFinite(t)&&i(t)===t}},function(t,e){t.exports=Math.log1p||function(t){return(t=+t)>-1e-8&&t<1e-8?t-t*t/2:Math.log(1+t)}},function(t,e,n){var r=n(88),i=Math.pow,o=i(2,-52),a=i(2,-23),s=i(2,127)*(2-a),u=i(2,-126);t.exports=Math.fround||function(t){var e,n,i=Math.abs(t),l=r(t);return i<u?l*(i/u/a+1/o-1/o)*u*a:(n=(e=(1+a/o)*i)-(e-i))>s||n!=n?l*(1/0):l*n}},function(t,e,n){var r=n(3);t.exports=function(t,e,n,i){try{return i?e(r(n)[0],n[1]):e(n)}catch(e){var o=t.return;throw void 0!==o&&r(o.call(t)),e}}},function(t,e,n){var r=n(15),i=n(12),o=n(59),a=n(9);t.exports=function(t,e,n,s,u){r(e);var l=i(t),c=o(l),f=a(l.length),h=u?f-1:0,d=u?-1:1;if(n<2)for(;;){if(h in c){s=c[h],h+=d;break}if(h+=d,u?h<0:f<=h)throw TypeError("Reduce of empty array with no initial value")}for(;u?h>=0:f>h;h+=d)h in c&&(s=e(s,c[h],h,l));return s}},function(t,e,n){"use strict";var r=n(12),i=n(44),o=n(9);t.exports=[].copyWithin||function(t,e){var n=r(this),a=o(n.length),s=i(t,a),u=i(e,a),l=arguments.length>2?arguments[2]:void 0,c=Math.min((void 0===l?a:i(l,a))-u,a-s),f=1;for(u<s&&s<u+c&&(f=-1,u+=c-1,s+=c-1);c-- >0;)u in n?n[s]=n[u]:delete n[s],s+=f,u+=f;return n}},function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e,n){"use strict";var r=n(100);n(1)({target:"RegExp",proto:!0,forced:r!==/./.exec},{exec:r})},function(t,e,n){n(10)&&"g"!=/./g.flags&&n(11).f(RegExp.prototype,"flags",{configurable:!0,get:n(61)})},function(t,e){t.exports=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}}},function(t,e,n){var r=n(3),i=n(6),o=n(104);t.exports=function(t,e){if(r(t),i(e)&&e.constructor===t)return e;var n=o.f(t);return(0,n.resolve)(e),n.promise}},function(t,e,n){"use strict";var r=n(134),i=n(56);t.exports=n(73)("Map",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{get:function(t){var e=r.getEntry(i(this,"Map"),t);return e&&e.v},set:function(t,e){return r.def(i(this,"Map"),0===t?0:t,e)}},r,!0)},function(t,e,n){"use strict";var r=n(11).f,i=n(45),o=n(50),a=n(27),s=n(48),u=n(49),l=n(90),c=n(128),f=n(47),h=n(10),d=n(37).fastKey,v=n(56),p=h?"_s":"size",y=function(t,e){var n,r=d(e);if("F"!==r)return t._i[r];for(n=t._f;n;n=n.n)if(n.k==e)return n};t.exports={getConstructor:function(t,e,n,l){var c=t(function(t,r){s(t,c,e,"_i"),t._t=e,t._i=i(null),t._f=void 0,t._l=void 0,t[p]=0,null!=r&&u(r,n,t[l],t)});return o(c.prototype,{clear:function(){for(var t=v(this,e),n=t._i,r=t._f;r;r=r.n)r.r=!0,r.p&&(r.p=r.p.n=void 0),delete n[r.i];t._f=t._l=void 0,t[p]=0},delete:function(t){var n=v(this,e),r=y(n,t);if(r){var i=r.n,o=r.p;delete n._i[r.i],r.r=!0,o&&(o.n=i),i&&(i.p=o),n._f==r&&(n._f=i),n._l==r&&(n._l=o),n[p]--}return!!r},forEach:function(t){v(this,e);for(var n,r=a(t,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(r(n.v,n.k,this);n&&n.r;)n=n.p},has:function(t){return!!y(v(this,e),t)}}),h&&r(c.prototype,"size",{get:function(){return v(this,e)[p]}}),c},def:function(t,e,n){var r,i,o=y(t,e);return o?o.v=n:(t._l=o={i:i=d(e,!0),k:e,v:n,p:r=t._l,n:void 0,r:!1},t._f||(t._f=o),r&&(r.n=o),t[p]++,"F"!==i&&(t._i[i]=o)),t},getEntry:y,setStrong:function(t,e,n){l(t,e,function(t,n){this._t=v(t,e),this._k=n,this._l=void 0},function(){for(var t=this._k,e=this._l;e&&e.r;)e=e.p;return this._t&&(this._l=e=e?e.n:this._t._f)?c(0,"keys"==t?e.k:"values"==t?e.v:[e.k,e.v]):(this._t=void 0,c(1))},n?"entries":"values",!n,!0),f(e)}}},function(t,e,n){"use strict";var r=n(134),i=n(56);t.exports=n(73)("Set",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return r.def(i(this,"Set"),t=0===t?0:t,t)}},r)},function(t,e,n){"use strict";var r,i=n(34)(0),o=n(19),a=n(37),s=n(115),u=n(137),l=n(6),c=n(5),f=n(56),h=a.getWeak,d=Object.isExtensible,v=u.ufstore,p={},y=function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},g={get:function(t){if(l(t)){var e=h(t);return!0===e?v(f(this,"WeakMap")).get(t):e?e[this._i]:void 0}},set:function(t,e){return u.def(f(this,"WeakMap"),t,e)}},m=t.exports=n(73)("WeakMap",y,g,u,!0,!0);c(function(){return 7!=(new m).set((Object.freeze||Object)(p),7).get(p)})&&(s((r=u.getConstructor(y,"WeakMap")).prototype,g),a.NEED=!0,i(["delete","has","get","set"],function(t){var e=m.prototype,n=e[t];o(e,t,function(e,i){if(l(e)&&!d(e)){this._f||(this._f=new r);var o=this._f[t](e,i);return"set"==t?this:o}return n.call(this,e,i)})}))},function(t,e,n){"use strict";var r=n(50),i=n(37).getWeak,o=n(3),a=n(6),s=n(48),u=n(49),l=n(34),c=n(22),f=n(56),h=l(5),d=l(6),v=0,p=function(t){return t._l||(t._l=new y)},y=function(){this.a=[]},g=function(t,e){return h(t.a,function(t){return t[0]===e})};y.prototype={get:function(t){var e=g(this,t);if(e)return e[1]},has:function(t){return!!g(this,t)},set:function(t,e){var n=g(this,t);n?n[1]=e:this.a.push([t,e])},delete:function(t){var e=d(this.a,function(e){return e[0]===t});return~e&&this.a.splice(e,1),!!~e}},t.exports={getConstructor:function(t,e,n,o){var l=t(function(t,r){s(t,l,e,"_i"),t._t=e,t._i=v++,t._l=void 0,null!=r&&u(r,n,t[o],t)});return r(l.prototype,{delete:function(t){if(!a(t))return!1;var n=i(t);return!0===n?p(f(this,e)).delete(t):n&&c(n,this._i)&&delete n[this._i]},has:function(t){if(!a(t))return!1;var n=i(t);return!0===n?p(f(this,e)).has(t):n&&c(n,this._i)}}),l},def:function(t,e,n){var r=i(o(e),!0);return!0===r?p(t).set(e,n):r[t._i]=n,t},ufstore:p}},function(t,e,n){var r=n(29),i=n(9);t.exports=function(t){if(void 0===t)return 0;var e=r(t),n=i(e);if(e!==n)throw RangeError("Wrong length!");return n}},function(t,e,n){var r=n(46),i=n(65),o=n(3),a=n(4).Reflect;t.exports=a&&a.ownKeys||function(t){var e=r.f(o(t)),n=i.f;return n?e.concat(n(t)):e}},function(t,e,n){"use strict";var r=n(66),i=n(6),o=n(9),a=n(27),s=n(8)("isConcatSpreadable");t.exports=function t(e,n,u,l,c,f,h,d){for(var v,p,y=c,g=0,m=!!h&&a(h,d,3);g<l;){if(g in u){if(v=m?m(u[g],g,n):u[g],p=!1,i(v)&&(p=void 0!==(p=v[s])?!!p:r(v)),p&&f>0)y=t(e,n,v,o(v.length),y,f-1)-1;else{if(y>=9007199254740991)throw TypeError();e[y]=v}y++}g++}return y}},function(t,e,n){var r=n(9),i=n(87),o=n(32);t.exports=function(t,e,n,a){var s=String(o(t)),u=s.length,l=void 0===n?" ":String(n),c=r(e);if(c<=u||""==l)return s;var f=c-u,h=i.call(l,Math.ceil(f/l.length));return h.length>f&&(h=h.slice(0,f)),a?h+s:s+h}},function(t,e,n){var r=n(43),i=n(23),o=n(60).f;t.exports=function(t){return function(e){for(var n,a=i(e),s=r(a),u=s.length,l=0,c=[];u>l;)o.call(a,n=s[l++])&&c.push(t?[n,a[n]]:a[n]);return c}}},function(t,e,n){var r=n(53),i=n(144);t.exports=function(t){return function(){if(r(this)!=t)throw TypeError(t+"#toJSON isn't generic");return i(this)}}},function(t,e,n){var r=n(49);t.exports=function(t,e){var n=[];return r(t,!1,n.push,n,e),n}},function(t,e){t.exports=Math.scale||function(t,e,n,r,i){return 0===arguments.length||t!=t||e!=e||n!=n||r!=r||i!=i?NaN:t===1/0||t===-1/0?t:(t-e)*(i-r)/(n-e)+r}},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r=n(148),i=n.n(r);function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var a=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.lru=new i.a({maxSize:e})}var e,n,r;return e=t,(n=[{key:"get",value:function(t,e){var n=this.lru.get(t);if(void 0!==n)return n;var r=e();return this.lru.set(t,r),r}}])&&o(e.prototype,n),r&&o(e,r),t}()},function(t,e,n){"use strict";function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),!(e.maxSize&&e.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");this.maxSize=e.maxSize,this.cache=new Map,this.oldCache=new Map,this._size=0}var e,n,o;return e=t,(n=[{key:"_set",value:function(t,e){this.cache.set(t,e),this._size++,this._size>=this.maxSize&&(this._size=0,this.oldCache=this.cache,this.cache=new Map)}},{key:"get",value:function(t){if(this.cache.has(t))return this.cache.get(t);if(this.oldCache.has(t)){var e=this.oldCache.get(t);return this._set(t,e),e}}},{key:"set",value:function(t,e){return this.cache.has(t)?this.cache.set(t,e):this._set(t,e),this}},{key:"has",value:function(t){return this.cache.has(t)||this.oldCache.has(t)}},{key:"peek",value:function(t){return this.cache.has(t)?this.cache.get(t):this.oldCache.has(t)?this.oldCache.get(t):void 0}},{key:"delete",value:function(t){var e=this.cache.delete(t);return e&&this._size--,this.oldCache.delete(t)||e}},{key:"clear",value:function(){this.cache.clear(),this.oldCache.clear(),this._size=0}},{key:"keys",value:regeneratorRuntime.mark(function t(){var e,n,i,o,a,s,u;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=!0,n=!1,i=void 0,t.prev=3,o=this[Symbol.iterator]();case 5:if(e=(a=o.next()).done){t.next=12;break}return s=r(a.value,1),u=s[0],t.next=9,u;case 9:e=!0,t.next=5;break;case 12:t.next=18;break;case 14:t.prev=14,t.t0=t.catch(3),n=!0,i=t.t0;case 18:t.prev=18,t.prev=19,e||null==o.return||o.return();case 21:if(t.prev=21,!n){t.next=24;break}throw i;case 24:return t.finish(21);case 25:return t.finish(18);case 26:case"end":return t.stop()}},t,this,[[3,14,18,26],[19,,21,25]])})},{key:"values",value:regeneratorRuntime.mark(function t(){var e,n,i,o,a,s,u;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=!0,n=!1,i=void 0,t.prev=3,o=this[Symbol.iterator]();case 5:if(e=(a=o.next()).done){t.next=12;break}return s=r(a.value,2),u=s[1],t.next=9,u;case 9:e=!0,t.next=5;break;case 12:t.next=18;break;case 14:t.prev=14,t.t0=t.catch(3),n=!0,i=t.t0;case 18:t.prev=18,t.prev=19,e||null==o.return||o.return();case 21:if(t.prev=21,!n){t.next=24;break}throw i;case 24:return t.finish(21);case 25:return t.finish(18);case 26:case"end":return t.stop()}},t,this,[[3,14,18,26],[19,,21,25]])})},{key:Symbol.iterator,value:regeneratorRuntime.mark(function t(){var e,n,i,o,a,s,u,l,c,f,h,d,v,p;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=!0,n=!1,i=void 0,t.prev=3,o=this.cache[Symbol.iterator]();case 5:if(e=(a=o.next()).done){t.next=12;break}return s=a.value,t.next=9,s;case 9:e=!0,t.next=5;break;case 12:t.next=18;break;case 14:t.prev=14,t.t0=t.catch(3),n=!0,i=t.t0;case 18:t.prev=18,t.prev=19,e||null==o.return||o.return();case 21:if(t.prev=21,!n){t.next=24;break}throw i;case 24:return t.finish(21);case 25:return t.finish(18);case 26:u=!0,l=!1,c=void 0,t.prev=29,f=this.oldCache[Symbol.iterator]();case 31:if(u=(h=f.next()).done){t.next=40;break}if(d=h.value,v=r(d,1),p=v[0],this.cache.has(p)){t.next=37;break}return t.next=37,d;case 37:u=!0,t.next=31;break;case 40:t.next=46;break;case 42:t.prev=42,t.t1=t.catch(29),l=!0,c=t.t1;case 46:t.prev=46,t.prev=47,u||null==f.return||f.return();case 49:if(t.prev=49,!l){t.next=52;break}throw c;case 52:return t.finish(49);case 53:return t.finish(46);case 54:case"end":return t.stop()}},t,this,[[3,14,18,26],[19,,21,25],[29,42,46,54],[47,,49,53]])})},{key:"size",get:function(){var t=0,e=!0,n=!1,r=void 0;try{for(var i,o=this.oldCache.keys()[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value;this.cache.has(a)||t++}}catch(t){n=!0,r=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}return this._size+t}}])&&i(e.prototype,n),o&&i(e,o),t}();t.exports=o},function(t,e,n){var r,i=n(360).RNG,o=n(361).MakeRiff,a=.25,s=5512,u=8,l=0,c=["square","sawtooth","sine","noise","triangle","breaker"];function f(){try{null==r&&("undefined"!=typeof AudioContext?r=new AudioContext:"undefined"!=typeof webkitAudioContext&&(r=new webkitAudioContext))}catch(t){window.console.log(t)}}f();var h;function d(){var t={};return t.wave_type=l,t.p_env_attack=0,t.p_env_sustain=.3,t.p_env_punch=0,t.p_env_decay=.4,t.p_base_freq=.3,t.p_freq_limit=0,t.p_freq_ramp=0,t.p_freq_dramp=0,t.p_vib_strength=0,t.p_vib_speed=0,t.p_arp_mod=0,t.p_arp_speed=0,t.p_duty=0,t.p_duty_ramp=0,t.p_repeat_speed=0,t.p_pha_offset=0,t.p_pha_ramp=0,t.p_lpf_freq=1,t.p_lpf_ramp=0,t.p_lpf_resonance=0,t.p_hpf_freq=0,t.p_hpf_ramp=0,t.sound_vol=.5,t.sample_rate=44100,t.bit_depth=8,t}var v=!1;function p(t){return v?h.uniform()*t:Math.random()*t}function y(t){return v?Math.floor(h.uniform()*(t+1)):Math.floor(Math.random()*(t+1))}pickupCoin=function(){var t=d();if(t.wave_type=Math.floor(p(c.length)),3===t.wave_type&&(t.wave_type=0),t.p_base_freq=.4+p(.5),t.p_env_attack=0,t.p_env_sustain=p(.1),t.p_env_decay=.1+p(.4),t.p_env_punch=.3+p(.3),y(1)){t.p_arp_speed=.5+p(.2);var e=1+(1|p(7)),n=e+(1|p(7))+2;t.p_arp_mod=+e/+n}return t},laserShoot=function(){var t=d();return t.wave_type=y(2),2===t.wave_type&&y(1)&&(t.wave_type=y(1)),t.wave_type=Math.floor(p(c.length)),3===t.wave_type&&(t.wave_type=l),t.p_base_freq=.5+p(.5),t.p_freq_limit=t.p_base_freq-.2-p(.6),t.p_freq_limit<.2&&(t.p_freq_limit=.2),t.p_freq_ramp=-.15-p(.2),0===y(2)&&(t.p_base_freq=.3+p(.6),t.p_freq_limit=p(.1),t.p_freq_ramp=-.35-p(.3)),y(1)?(t.p_duty=p(.5),t.p_duty_ramp=p(.2)):(t.p_duty=.4+p(.5),t.p_duty_ramp=-p(.7)),t.p_env_attack=0,t.p_env_sustain=.1+p(.2),t.p_env_decay=p(.4),y(1)&&(t.p_env_punch=p(.3)),0===y(2)&&(t.p_pha_offset=p(.2),t.p_pha_ramp=-p(.2)),y(1)&&(t.p_hpf_freq=p(.3)),t},explosion=function(){var t=d();return y(1)?(t.p_base_freq=.1+p(.4),t.p_freq_ramp=-.1+p(.4)):(t.p_base_freq=.2+p(.7),t.p_freq_ramp=-.2-p(.2)),t.p_base_freq*=t.p_base_freq,0===y(4)&&(t.p_freq_ramp=0),0===y(2)&&(t.p_repeat_speed=.3+p(.5)),t.p_env_attack=0,t.p_env_sustain=.1+p(.3),t.p_env_decay=p(.5),0===y(1)&&(t.p_pha_offset=-.3+p(.9),t.p_pha_ramp=-p(.3)),t.p_env_punch=.2+p(.6),y(1)&&(t.p_vib_strength=p(.7),t.p_vib_speed=p(.6)),0===y(2)&&(t.p_arp_speed=.6+p(.3),t.p_arp_mod=.8-p(1.6)),t},birdSound=function(){var t=d();return p(10)<1?(t.wave_type=Math.floor(p(c.length)),3===t.wave_type&&(t.wave_type=l),t.p_env_attack=.4304400932967592+p(.2)-.1,t.p_env_sustain=.15739346034252394+p(.2)-.1,t.p_env_punch=.004488201744871758+p(.2)-.1,t.p_env_decay=.07478075528212291+p(.2)-.1,t.p_base_freq=.9865265720147687+p(.2)-.1,t.p_freq_limit=0+p(.2)-.1,t.p_freq_ramp=-.2995018224359539+p(.2)-.1,p(1)<.5&&(t.p_freq_ramp=.1+p(.15)),t.p_freq_dramp=.004598608156964473+p(.1)-.05,t.p_vib_strength=-.2202799497929496+p(.2)-.1,t.p_vib_speed=.8084998703158364+p(.2)-.1,t.p_arp_mod=0,t.p_arp_speed=0,t.p_duty=-.9031808754347107+p(.2)-.1,t.p_duty_ramp=-.8128699999808343+p(.2)-.1,t.p_repeat_speed=.601486018931999+p(.2)-.1,t.p_pha_offset=-.9424902314367765+p(.2)-.1,t.p_pha_ramp=-.1055482222272056+p(.2)-.1,t.p_lpf_freq=.9989765717851521+p(.2)-.1,t.p_lpf_ramp=-.25051720626043017+p(.2)-.1,t.p_lpf_resonance=.32777871505494693+p(.2)-.1,t.p_hpf_freq=.0023548750981756753+p(.2)-.1,t.p_hpf_ramp=-.002375673204842568+p(.2)-.1,t):p(10)<1?(t.wave_type=Math.floor(p(c.length)),3===t.wave_type&&(t.wave_type=l),t.p_env_attack=.5277795946672003+p(.2)-.1,t.p_env_sustain=.18243733568468432+p(.2)-.1,t.p_env_punch=-.020159754546840117+p(.2)-.1,t.p_env_decay=.1561353422051903+p(.2)-.1,t.p_base_freq=.9028855606533718+p(.2)-.1,t.p_freq_limit=-.008842787837148716,t.p_freq_ramp=-.1,t.p_freq_dramp=-.012891241489551925,t.p_vib_strength=-.17923136138403065+p(.2)-.1,t.p_vib_speed=.908263385610142+p(.2)-.1,t.p_arp_mod=.41690153355414894+p(.2)-.1,t.p_arp_speed=.0010766233195860704+p(.2)-.1,t.p_duty=-.8735363011184684+p(.2)-.1,t.p_duty_ramp=-.7397985366747507+p(.2)-.1,t.p_repeat_speed=.0591789344172107+p(.2)-.1,t.p_pha_offset=-.9961184222777699+p(.2)-.1,t.p_pha_ramp=-.08234769395850523+p(.2)-.1,t.p_lpf_freq=.9412475115697335+p(.2)-.1,t.p_lpf_ramp=-.18261358925834958+p(.2)-.1,t.p_lpf_resonance=.24541438107389477+p(.2)-.1,t.p_hpf_freq=-.01831940280978611+p(.2)-.1,t.p_hpf_ramp=-.03857383633171346+p(.2)-.1,t):p(10)<1?(t.wave_type=Math.floor(p(c.length)),3===t.wave_type&&(t.wave_type=l),t.p_env_attack=.4304400932967592+p(.2)-.1,t.p_env_sustain=.15739346034252394+p(.2)-.1,t.p_env_punch=.004488201744871758+p(.2)-.1,t.p_env_decay=.07478075528212291+p(.2)-.1,t.p_base_freq=.9865265720147687+p(.2)-.1,t.p_freq_limit=0+p(.2)-.1,t.p_freq_ramp=-.2995018224359539+p(.2)-.1,t.p_freq_dramp=.004598608156964473+p(.2)-.1,t.p_vib_strength=-.2202799497929496+p(.2)-.1,t.p_vib_speed=.8084998703158364+p(.2)-.1,t.p_arp_mod=-.46410459213693644+p(.2)-.1,t.p_arp_speed=-.10955361249587248+p(.2)-.1,t.p_duty=-.9031808754347107+p(.2)-.1,t.p_duty_ramp=-.8128699999808343+p(.2)-.1,t.p_repeat_speed=.7014860189319991+p(.2)-.1,t.p_pha_offset=-.9424902314367765+p(.2)-.1,t.p_pha_ramp=-.1055482222272056+p(.2)-.1,t.p_lpf_freq=.9989765717851521+p(.2)-.1,t.p_lpf_ramp=-.25051720626043017+p(.2)-.1,t.p_lpf_resonance=.32777871505494693+p(.2)-.1,t.p_hpf_freq=.0023548750981756753+p(.2)-.1,t.p_hpf_ramp=-.002375673204842568+p(.2)-.1,t):p(5)>1?(t.wave_type=Math.floor(p(c.length)),3===t.wave_type&&(t.wave_type=l),y(1)?(t.p_arp_mod=.2697849293151393+p(.2)-.1,t.p_arp_speed=-.3131172257760948+p(.2)-.1,t.p_base_freq=.8090588299313949+p(.2)-.1,t.p_duty=-.6210022920964955+p(.2)-.1,t.p_duty_ramp=-.00043441813553182567+p(.2)-.1,t.p_env_attack=.004321877246874195+p(.2)-.1,t.p_env_decay=.1+p(.2)-.1,t.p_env_punch=.061737781504416146+p(.2)-.1,t.p_env_sustain=.4987252564798832+p(.2)-.1,t.p_freq_dramp=.31700340314222614+p(.2)-.1,t.p_freq_limit=0+p(.2)-.1,t.p_freq_ramp=-.163380391341416+p(.2)-.1,t.p_hpf_freq=.4709005021145149+p(.2)-.1,t.p_hpf_ramp=.6924667290539194+p(.2)-.1,t.p_lpf_freq=.8351398631384511+p(.2)-.1,t.p_lpf_ramp=.36616557192873134+p(.2)-.1,t.p_lpf_resonance=-.08685777111664439+p(.2)-.1,t.p_pha_offset=-.036084571580025544+p(.2)-.1,t.p_pha_ramp=-.014806445085568108+p(.2)-.1,t.p_repeat_speed=-.8094368475518489+p(.2)-.1,t.p_vib_speed=.4496665457171294+p(.2)-.1,t.p_vib_strength=.23413762515532424+p(.2)-.1):(t.p_arp_mod=-.35697118026766184+p(.2)-.1,t.p_arp_speed=.3581140690559588+p(.2)-.1,t.p_base_freq=1.3260897696157528+p(.2)-.1,t.p_duty=-.30984900436710694+p(.2)-.1,t.p_duty_ramp=-.0014374759133411626+p(.2)-.1,t.p_env_attack=.3160357835682254+p(.2)-.1,t.p_env_decay=.1+p(.2)-.1,t.p_env_punch=.24323114016870148+p(.2)-.1,t.p_env_sustain=.4+p(.2)-.1,t.p_freq_dramp=.2866475886237244+p(.2)-.1,t.p_freq_limit=0+p(.2)-.1,t.p_freq_ramp=-.10956352368742976+p(.2)-.1,t.p_hpf_freq=.20772718017889846+p(.2)-.1,t.p_hpf_ramp=.1564090637378835+p(.2)-.1,t.p_lpf_freq=.6021372770637031+p(.2)-.1,t.p_lpf_ramp=.24016227139979027+p(.2)-.1,t.p_lpf_resonance=-.08787383821160144+p(.2)-.1,t.p_pha_offset=-.381597686151701+p(.2)-.1,t.p_pha_ramp=-.0002481687661373495+p(.2)-.1,t.p_repeat_speed=.07812112809425686+p(.2)-.1,t.p_vib_speed=-.13648848579133943+p(.2)-.1,t.p_vib_strength=.0018874158972302657+p(.2)-.1),t):(t.wave_type=Math.floor(p(c.length)),1!==t.wave_type&&3!==t.wave_type||(t.wave_type=2),t.p_base_freq=.85+p(.15),t.p_freq_ramp=.3+p(.15),t.p_env_attack=0+p(.09),t.p_env_sustain=.2+p(.3),t.p_env_decay=0+p(.1),t.p_duty=p(2)-1,t.p_duty_ramp=Math.pow(p(2)-1,3),t.p_repeat_speed=.5+p(.1),t.p_pha_offset=-.3+p(.9),t.p_pha_ramp=-p(.3),t.p_arp_speed=.4+p(.6),t.p_arp_mod=.8+p(.1),t.p_lpf_resonance=p(2)-1,t.p_lpf_freq=1-Math.pow(p(1),3),t.p_lpf_ramp=Math.pow(p(2)-1,3),t.p_lpf_freq<.1&&t.p_lpf_ramp<-.05&&(t.p_lpf_ramp=-t.p_lpf_ramp),t.p_hpf_freq=Math.pow(p(1),5),t.p_hpf_ramp=Math.pow(p(2)-1,5),t)},pushSound=function(){var t=d();return t.wave_type=Math.floor(p(c.length)),2===t.wave_type&&t.wave_type++,0===t.wave_type&&(t.wave_type=3),t.p_base_freq=.1+p(.4),t.p_freq_ramp=.05+p(.2),t.p_env_attack=.01+p(.09),t.p_env_sustain=.01+p(.09),t.p_env_decay=.01+p(.09),t.p_repeat_speed=.3+p(.5),t.p_pha_offset=-.3+p(.9),t.p_pha_ramp=-p(.3),t.p_arp_speed=.6+p(.3),t.p_arp_mod=.8-p(1.6),t},powerUp=function(){var t=d();return y(1)?t.wave_type=1:t.p_duty=p(.6),t.wave_type=Math.floor(p(c.length)),3===t.wave_type&&(t.wave_type=l),y(1)?(t.p_base_freq=.2+p(.3),t.p_freq_ramp=.1+p(.4),t.p_repeat_speed=.4+p(.4)):(t.p_base_freq=.2+p(.3),t.p_freq_ramp=.05+p(.2),y(1)&&(t.p_vib_strength=p(.7),t.p_vib_speed=p(.6))),t.p_env_attack=0,t.p_env_sustain=p(.4),t.p_env_decay=.1+p(.4),t},hitHurt=function(){return result=d(),result.wave_type=y(2),2===result.wave_type&&(result.wave_type=3),result.wave_type===l&&(result.p_duty=p(.6)),result.wave_type=Math.floor(p(c.length)),result.p_base_freq=.2+p(.6),result.p_freq_ramp=-.3-p(.4),result.p_env_attack=0,result.p_env_sustain=p(.1),result.p_env_decay=.1+p(.2),y(1)&&(result.p_hpf_freq=p(.3)),result},jump=function(){return result=d(),result.wave_type=l,result.wave_type=Math.floor(p(c.length)),3===result.wave_type&&(result.wave_type=l),result.p_duty=p(.6),result.p_base_freq=.3+p(.3),result.p_freq_ramp=.1+p(.2),result.p_env_attack=0,result.p_env_sustain=.1+p(.3),result.p_env_decay=.1+p(.2),y(1)&&(result.p_hpf_freq=p(.3)),y(1)&&(result.p_lpf_freq=1-p(.6)),result},blipSelect=function(){return result=d(),result.wave_type=y(1),result.wave_type=Math.floor(p(c.length)),3===result.wave_type&&(result.wave_type=y(1)),result.wave_type===l&&(result.p_duty=p(.6)),result.p_base_freq=.2+p(.4),result.p_env_attack=0,result.p_env_sustain=.1+p(.1),result.p_env_decay=p(.2),result.p_hpf_freq=.1,result},random=function(){return result=d(),result.wave_type=Math.floor(p(c.length)),result.p_base_freq=Math.pow(p(2)-1,2),y(1)&&(result.p_base_freq=Math.pow(p(2)-1,3)+.5),result.p_freq_limit=0,result.p_freq_ramp=Math.pow(p(2)-1,5),result.p_base_freq>.7&&result.p_freq_ramp>.2&&(result.p_freq_ramp=-result.p_freq_ramp),result.p_base_freq<.2&&result.p_freq_ramp<-.05&&(result.p_freq_ramp=-result.p_freq_ramp),result.p_freq_dramp=Math.pow(p(2)-1,3),result.p_duty=p(2)-1,result.p_duty_ramp=Math.pow(p(2)-1,3),result.p_vib_strength=Math.pow(p(2)-1,3),result.p_vib_speed=p(2)-1,result.p_env_attack=Math.pow(p(2)-1,3),result.p_env_sustain=Math.pow(p(2)-1,2),result.p_env_decay=p(2)-1,result.p_env_punch=Math.pow(p(.8),2),result.p_env_attack+result.p_env_sustain+result.p_env_decay<.2&&(result.p_env_sustain+=.2+p(.3),result.p_env_decay+=.2+p(.3)),result.p_lpf_resonance=p(2)-1,result.p_lpf_freq=1-Math.pow(p(1),3),result.p_lpf_ramp=Math.pow(p(2)-1,3),result.p_lpf_freq<.1&&result.p_lpf_ramp<-.05&&(result.p_lpf_ramp=-result.p_lpf_ramp),result.p_hpf_freq=Math.pow(p(1),5),result.p_hpf_ramp=Math.pow(p(2)-1,5),result.p_pha_offset=Math.pow(p(2)-1,3),result.p_pha_ramp=Math.pow(p(2)-1,3),result.p_repeat_speed=p(2)-1,result.p_arp_speed=p(2)-1,result.p_arp_mod=p(2)-1,result};var g=[pickupCoin,laserShoot,explosion,powerUp,hitHurt,jump,blipSelect,pushSound,random,birdSound];function m(t,e){this._buffer=r.createBuffer(1,t,e)}generateFromSeed=function(t){h=new i(t/100|0),v=!0;var e=(0,g[t%100%g.length])();return e.seed=t,v=!1,e},m.prototype.getBuffer=function(){return this._buffer.getChannelData(0)},m.prototype.play=function(){var t=r.createBufferSource(),e=r.createBiquadFilter(),n=r.createBiquadFilter(),i=r.createBiquadFilter();t.buffer=this._buffer,t.connect(e),e.frequency.value=1600,n.frequency.value=1600,i.frequency.value=1600,e.connect(n),n.connect(i),i.connect(r.destination);var o=r.currentTime;return void 0!==t.start?t.start(o):t.noteOn(o)},m.MIN_SAMPLE_RATE=22050,void 0===r&&((m=function(t,e){this._sample_rate=e,this._buffer=new Array(t),this._audioElement=null}).prototype.getBuffer=function(){return this._audioElement=null,this._buffer},m.prototype.play=function(){if(!this._audioElement){for(var t=0;t<this._buffer.length;t++)this._buffer[t]=255&Math.floor(128*Math.max(0,Math.min(this._buffer[t]+1,2)));var e=o(this._sample_rate,u,this._buffer);return this._audioElement=new Audio,this._audioElement.src=e.dataURI,this._audioElement.play()}this._audioElement.cloneNode(!1).play()},m.MIN_SAMPLE_RATE=1),m.generate=function(t){function e(){n=0,r=100/(t.p_base_freq*t.p_base_freq+.001),i=Math.floor(r),o=100/(t.p_freq_limit*t.p_freq_limit+.001),a=1-.01*Math.pow(t.p_freq_ramp,3),s=1e-6*-Math.pow(t.p_freq_dramp,3),u=.5-.5*t.p_duty,c=5e-5*-t.p_duty_ramp,f=t.p_arp_mod>=0?1-.9*Math.pow(t.p_arp_mod,2):1+10*Math.pow(t.p_arp_mod,2),0,h=Math.floor(2e4*Math.pow(1-t.p_arp_speed,2)+32),1==t.p_arp_speed&&(h=0)}var n,r,i,o,a,s,u,c,f,h;e();var d=0,v=0,p=.1*Math.pow(t.p_lpf_freq,3),y=1+1e-4*t.p_lpf_ramp,g=5/(1+20*Math.pow(t.p_lpf_resonance,2))*(.01+p);g>.8&&(g=.8);var b=0,w=.1*Math.pow(t.p_hpf_freq,2),_=1+3e-4*t.p_hpf_ramp,S=0,k=.01*Math.pow(t.p_vib_speed,2),E=.5*t.p_vib_strength,T=0,O=0,x=0,C=[Math.floor(t.p_env_attack*t.p_env_attack*1e5),Math.floor(t.p_env_sustain*t.p_env_sustain*1e5),Math.floor(t.p_env_decay*t.p_env_decay*1e5)],M=C[0]+C[1]+C[2],R=0,I=1020*Math.pow(t.p_pha_offset,2);t.p_pha_offset<0&&(I=-I);var A=1*Math.pow(t.p_pha_ramp,2);t.p_pha_ramp<0&&(A=-A);for(var L=Math.abs(Math.floor(I)),P=0,N=[],D=0;D<1024;++D)N[D]=0;var G=[];for(D=0;D<32;++D)G[D]=2*Math.random()-1;var B=Math.floor(2e4*Math.pow(1-t.p_repeat_speed,2)+32);0==t.p_repeat_speed&&(B=0);for(var F,j=t.sound_vol,U=(j=Math.exp(t.sound_vol)-1,0),W=0,H=Math.floor(44100/t.sample_rate),q=0,z=Math.ceil(M/H),V=(F=t.sample_rate<m.MIN_SAMPLE_RATE?new m(4*z,m.MIN_SAMPLE_RATE):new m(z,t.sample_rate)).getBuffer(),K=0;;++K){0!=B&&++n>=B&&e(),0!=h&&K>=h&&(h=0,r*=f),(r*=a+=s)>o&&(r=o,t.p_freq_limit>0&&!0);var Y=r;if(E>0&&(S+=k,Y=r*(1+Math.sin(S)*E)),(i=Math.floor(Y))<8&&(i=8),(u+=c)<0&&(u=0),u>.5&&(u=.5),++x>C[O]){for(x=1,O++;O<3&&0===C[O];)O++;if(3===O)break}T=0===O?x/C[0]:1===O?1+2*Math.pow(1-x/C[1],1)*t.p_env_punch:1-x/C[2],I+=A,(L=Math.abs(Math.floor(I)))>1023&&(L=1023),0!=_&&((w*=_)<1e-5&&(w=1e-5),w>.1&&(w=.1));for(var J=0,X=0;X<8;++X){var $=0;if(++R>=i&&(R%=i,3===t.wave_type))for(D=0;D<32;++D)G[D]=2*Math.random()-1;var Z=R/i;if(t.wave_type===l)$=Z<u?.5:-.5;else if(1===t.wave_type)$=1-2*Z;else if(2===t.wave_type)$=Math.sin(2*Z*Math.PI);else if(3===t.wave_type)$=G[Math.floor(32*R/i)];else if(4===t.wave_type)$=Math.abs(1-2*Z)-1;else{if(5!==t.wave_type)throw new Exception("bad wave type! "+t.wave_type);$=Math.abs(1-Z*Z*2)-1}var Q=d;(p*=y)<0&&(p=0),p>.1&&(p=.1),1!=t.p_lpf_freq?(v+=($-d)*p,v-=v*g):(d=$,v=0),b+=(d+=v)-Q,$=b-=b*w,N[1023&P]=$,$+=N[P-L+1024&1023],P=P+1&1023,J+=$*T}U+=J,++W>=H&&(W=0,J=U/H,U=0,J=J/8*1,J*=j,V[q++]=J,t.sample_rate<m.MIN_SAMPLE_RATE&&(V[q++]=J,V[q++]=J,V[q++]=J))}return H>0&&(J=(J=U/H)/8*1,J*=j,V[q++]=J,t.sample_rate<m.MIN_SAMPLE_RATE&&(V[q++]=J,V[q++]=J,V[q++]=J)),F};var b={},w=[],_=50;t.exports={playSound:function(t){return f(),function(t){if(t in b)return b[t];var e=generateFromSeed(t);e.sound_vol=a,e.sample_rate=s,e.bit_depth=u;var n=m.generate(e);for(b[t]=n,w.push(t);w.length>_;){var r=w[0];w=w.slice(1),delete b[r]}return n}(t).play()}}},function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r=n(0),i=n(17);function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var a=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.gamepad=i.b.getAnyGamepad(),this.table=e,this.polledInput=null,this.repeatIntervalInSeconds=null,this.boundKeys=[],this.touchStart=null,this.touchStartedAt=0,this.touchHoldInterval=null;var o=function(t){var r=i.b.key(t,e);return n.boundKeys.push(r),r};this.controls={up:{lastPressed:null,button:i.b.or([this.gamepad.button(i.a.ARROW_UP),o("w"),o("ArrowUp")])},down:{lastPressed:null,button:i.b.or([this.gamepad.button(i.a.ARROW_DOWN),o("s"),o("ArrowDown")])},left:{lastPressed:null,button:i.b.or([this.gamepad.button(i.a.ARROW_LEFT),o("a"),o("ArrowLeft")])},right:{lastPressed:null,button:i.b.or([this.gamepad.button(i.a.ARROW_RIGHT),o("d"),o("ArrowRight")])},action:{lastPressed:null,button:i.b.or([this.gamepad.button(i.a.CLUSTER_BOTTOM),o("x"),o(" "),o("Enter")])},undo:{lastPressed:null,button:i.b.or([this.gamepad.button(i.a.CLUSTER_LEFT),this.gamepad.button(i.a.BUMPER_TOP_LEFT),o("z"),o("u")])},restart:{lastPressed:null,button:i.b.or([this.gamepad.button(i.a.CLUSTER_TOP),o("r")])}},this.stickControls={left:{lastPressed:null,stick:this.gamepad.stick(i.c.LEFT)},right:{lastPressed:null,stick:this.gamepad.stick(i.c.RIGHT)}};var a=function(t,e){return function(){var r=Date.now(),i=1e3*(n.repeatIntervalInSeconds||.25),o=n.controls[t],a=o.button,s=o.lastPressed;a.query()?(!s||s+i<r)&&(e(),n.controls[t].lastPressed=r):n.controls[t].lastPressed=null}},s=function(t){return function(){var e=Date.now(),i=1e3*(n.repeatIntervalInSeconds||.25),o=n.stickControls[t],a=o.stick,s=o.lastPressed,u=a.query(),l=u.x,c=u.y,f=Math.abs(c),h=Math.abs(l);if(f>h){if(f>.5)return void((!s||s+i<e)&&(o.lastPressed=e,n.polledInput=c<0?r.b.UP:r.b.DOWN))}else if(h>.5)return void((!s||s+i<e)&&(o.lastPressed=e,n.polledInput=l<0?r.b.LEFT:r.b.RIGHT));o.lastPressed=null}};this.controlCheckers=[s("left"),s("right"),a("up",function(){return n.polledInput=r.b.UP}),a("down",function(){return n.polledInput=r.b.DOWN}),a("left",function(){return n.polledInput=r.b.LEFT}),a("right",function(){return n.polledInput=r.b.RIGHT}),a("action",function(){return n.polledInput=r.b.ACTION}),a("undo",function(){return n.polledInput=r.b.UNDO}),a("restart",function(){return n.polledInput=r.b.RESTART})],this.onTouchStart=this.onTouchStart.bind(this),this.onTouchMove=this.onTouchMove.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.table.addEventListener("touchstart",this.onTouchStart,{passive:!0}),this.table.addEventListener("touchmove",this.onTouchMove),this.table.addEventListener("touchend",this.onTouchEnd)}var e,n,a;return e=t,(n=[{key:"pollControls",value:function(){if(window.document.activeElement!==this.table)return null;this.controlCheckers.forEach(function(t){return t()});var t=this.polledInput;return this.polledInput=null,t}},{key:"isSomethingPressed",value:function(){for(var t=Object.values(this.controls),e=0;e<t.length;e++){if(t[e].button.query())return!0}return!1}},{key:"setKeyRepeatInterval",value:function(t){this.repeatIntervalInSeconds=t}},{key:"dispose",value:function(){var t=!0,e=!1,n=void 0;try{for(var r,i=this.boundKeys[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){r.value.dispose()}}catch(t){e=!0,n=t}finally{try{t||null==i.return||i.return()}finally{if(e)throw n}}this.table.removeEventListener("touchstart",this.onTouchStart),this.table.removeEventListener("touchmove",this.onTouchMove),this.table.removeEventListener("touchend",this.onTouchEnd)}},{key:"startTouchHoldInterval",value:function(){var t=this;this.touchHoldInterval||(this.touchHoldInterval=setInterval(function(){return t.polledInput=r.b.UNDO},500))}},{key:"endTouchHoldInterval",value:function(){this.touchHoldInterval&&clearInterval(this.touchHoldInterval),this.touchHoldInterval=null}},{key:"onTouchStart",value:function(t){1===t.changedTouches.length&&(this.table.focus(),this.touchStart=t.changedTouches[0],this.touchStartedAt=Date.now(),this.startTouchHoldInterval())}},{key:"onTouchMove",value:function(t){this.touchStart&&1===t.touches.length&&t.preventDefault()}},{key:"onTouchEnd",value:function(t){var e=this,n=function(){var t=Date.now()-e.touchStartedAt;if(t>=2e3){var n=confirm("You were holding for a while. Do you want to restart the level?");e.polledInput=n?r.b.RESTART:null}else t<200&&(e.polledInput=r.b.ACTION)};if(this.endTouchHoldInterval(),this.touchStart&&1===t.changedTouches.length){var i=t.changedTouches[0],o=i.pageX-this.touchStart.pageX,a=i.pageY-this.touchStart.pageY,s=Math.abs(o),u=Math.abs(a);s>u?s>this.table.clientWidth/15?this.polledInput=o>0?r.b.RIGHT:r.b.LEFT:n():u>this.table.clientWidth/15?this.polledInput=a>0?r.b.DOWN:r.b.UP:n(),this.touchStart=null,t.preventDefault()}}}])&&o(e.prototype,n),a&&o(e,a),t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n(0);function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.table=e,this.handler=n,this.columns=1,this.rows=1,this.boundResizeHandler=Object(r.f)(this.trigger.bind(this)),window.addEventListener("resize",this.boundResizeHandler)}var e,n,o;return e=t,(n=[{key:"setLevel",value:function(t,e){this.rows=t,this.columns=e}},{key:"trigger",value:function(){var t=this.columns/this.rows,e=Math.min(window.outerWidth,window.innerWidth)-this.leftWithoutAutoMargins(),n=Math.min(window.outerHeight,window.innerHeight)-this.table.offsetTop,r=0;r=e/t<n?Math.floor(e/this.columns/5)*this.columns*5:Math.floor(n*t/this.rows/5)*this.rows*5,this.handler(Math.floor(r))}},{key:"dispose",value:function(){window.removeEventListener("resize",this.boundResizeHandler)}},{key:"leftWithoutAutoMargins",value:function(){var t=this.table.offsetLeft,e=window.getComputedStyle(this.table).width,n=e?Number.parseFloat(e.replace(/px$/,"")):0;this.table.style.width="".concat(2*t+n,"px");var r=this.table.offsetLeft;return this.table.style.width=e,r}}])&&i(e.prototype,n),o&&i(e,o),t}()},function(t,e,n){"use strict";var r=n(16),i=n(7),o=n(149),a=n(0);function s(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function c(t,e,n){return e&&l(t.prototype,e),n&&l(t,n),t}var f=function(){function t(){u(this,t),this.cache=new Map}return c(t,[{key:"get",value:function(t,e,n,i){var o=t.map(function(t){return t.getName()}).join(" "),a=this.cache.get(o);return a||(a=function(t,e,n,i){if(0===t.length){for(var o=[],a=0;a<n;a++){o[a]=o[a]||[];for(var s=0;s<i;s++)e&&(o[a][s]=e)}return o}0;if(1===t.length)return t[0].getPixels(n,i);if(t.find(function(t){return t.hasAlpha()})){var u=(t=t.reverse())[0].getPixels(n,i);return t.slice(1).forEach(function(t,e){for(var o=t.getPixels(n,i),a=0;a<n;a++){u[a]=u[a]||[];for(var s=0;s<i;s++){var l=o[a][s];if(l.hasAlpha()&&!u[a][s].isTransparent()){var c=u[a][s].toRgb(),f=c.r,h=c.g,d=c.b,v=l.toRgb(),p=v.r,y=v.g,g=v.b,m=v.a;if(null===m)throw new Error("BUG: No alpha channel");var b=Math.round(m*p+(1-m)*f),w=Math.round(m*y+(1-m)*h),_=Math.round(m*g+(1-m)*d),S="".concat(b<16?"0":"").concat(b.toString(16)),k="".concat(w<16?"0":"").concat(w.toString(16)),E="".concat(_<16?"0":"").concat(_.toString(16));u[a][s]=new r.a(l.__source,"#".concat(S).concat(k).concat(E))}else l&&!l.isTransparent()&&(u[a][s]=l)}}}),u}var l=t[0].getPixels(n,i);return t.slice(1).forEach(function(t,e){for(var r=t.getPixels(n,i),o=0;o<n;o++){l[o]=l[o]||[];for(var a=0;a<i;a++){var s=r[o][a];l[o][a]&&!l[o][a].isTransparent()||!s||s.isTransparent()||(l[o][a]=s)}}}),l}(t,e,n,i),this.cache.set(o,a)),a}},{key:"clear",value:function(){this.cache.clear()}}]),t}();var h=function(){function t(){u(this,t),this.cellColorCache=new f,this.renderedPixels=[],this.windowOffsetColStart=0,this.windowOffsetRowStart=0,this.isDumpingScreen=!1,this.PIXEL_HEIGHT=1,this.PIXEL_WIDTH=2,this.SPRITE_HEIGHT=5,this.SPRITE_WIDTH=5,this.hasVisualUi=!0,this.gameData=null,this.currentLevelMessage=null,this.currentLevelCells=null,this.windowOffsetWidth=null,this.windowOffsetHeight=null}return c(t,[{key:"destroy",value:function(){this.gameData=null,this.currentLevelMessage=null,this.currentLevelCells=null,this.renderedPixels=[],this.cellColorCache.clear()}},{key:"onGameChange",value:function(t){if(this.gameData=t,this.renderedPixels=[],this.cellColorCache.clear(),this.clearScreen(),this.windowOffsetColStart=0,this.windowOffsetRowStart=0,this.windowOffsetWidth=null,this.windowOffsetHeight=null,this.gameData.metadata.flickscreen){var e=this.gameData.metadata.flickscreen,n=e.width,r=e.height;this.windowOffsetWidth=n,this.windowOffsetHeight=r}else if(this.gameData.metadata.zoomscreen){var i=this.gameData.metadata.zoomscreen,o=i.width,a=i.height;this.windowOffsetWidth=o,this.windowOffsetHeight=a}var s=this.gameData.getSpriteSize(),u=s.spriteHeight,l=s.spriteWidth;this.SPRITE_HEIGHT=u,this.SPRITE_WIDTH=l}},{key:"getGameData",value:function(){if(!this.gameData)throw new Error("BUG: Game has not been specified yet");return this.gameData}},{key:"onLevelChange",value:function(t,e,n){if(!e&&!n||e&&n)throw new Error("BUG: Must provide either cells or a message (but not both)");this.currentLevelCells=e,this.currentLevelMessage=n}},{key:"getCurrentLevelCells",value:function(){if(!this.currentLevelCells)throw new Error("BUG: There are no cells to render. Maybe it is a message level? Or no level has been set yet");return this.currentLevelCells}},{key:"debugRenderScreen",value:function(){this.renderScreen(!0)}},{key:"renderMessageScreen",value:function(t){var e=this.windowOffsetColStart,n=this.windowOffsetRowStart,r=this.windowOffsetHeight,i=this.windowOffsetWidth;this.windowOffsetColStart=0,this.windowOffsetRowStart=0,this.windowOffsetHeight=13,this.windowOffsetWidth=34,this.clearScreen(),this.windowOffsetColStart=e,this.windowOffsetRowStart=n,this.windowOffsetHeight=r,this.windowOffsetWidth=i}},{key:"renderScreen",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!this.gameData)throw new Error("BUG: gameData was not set yet");this.currentLevelMessage?this.renderMessageScreen(this.currentLevelMessage):this.currentLevelCells&&(t&&(this.cellColorCache.clear(),this.renderedPixels=[]),this.renderLevelScreen(this.currentLevelCells,e))}},{key:"drawCells",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!this.gameData)throw new Error("BUG: gameData was not set yet");var r=Object(a.g)(this.getCurrentLevelCells()),i=this.gameData.getPlayer().getCellsThatMatch(r);if(1===i.size&&n<=1){var o=s(i)[0],u=this.cellPosToXY(o).isOnScreen;this.recenterPlayerIfNeeded(o,u)&&(t=Object(a.g)(this.getCurrentLevelCells()))}this.hasVisualUi&&this.drawCellsAfterRecentering(t,n)}},{key:"getPixelsForCell",value:function(t){if(!this.gameData)throw new Error("BUG: gameData was not set yet");var e=t.getSprites().filter(function(t){return!t.isTransparent()}),n=this.gameData.getMagicBackgroundSprite();return n&&e.push(n),this.cellColorCache.get(e,this.gameData.metadata.backgroundColor,this.SPRITE_HEIGHT,this.SPRITE_WIDTH)}},{key:"createMessageTextScreen",value:function(t){var e=["                                  ","                                  ","                                  ","                                  ","                                  ","                                  ","                                  ","                                  ","                                  ","                                  ","          X to continue           ","                                  ","                                  "];var n=e[9],r=e[10];e[10]=n;var i=e[0].length,o=function(t,e){if(!t)return t;var n=".{1,"+(e=e||75)+"}(\\s|$)|.{"+e+"}|.+$",r=t.match(RegExp(n,"g"));if(r)return r;throw new Error("BUG: Match did not work")}(t,e[0].length),a=5-(o.length/2|0);a<0&&(a=0);for(var s=Math.min(o.length,12),u=0;u<s;u++){var l=o[u],c=a+u,f=(i-l.length)/2|0,h=e[c];e[c]=h.slice(0,f)+l+h.slice(f+l.length)}var d=10;return s>=10&&(d=s<12?s+1:12),e[d]=r,e}},{key:"createMessageSprites",value:function(t){if(!this.gameData)throw new Error("BUG: gameData was not set yet");var e=this.createMessageTextScreen(t),n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value,l=[];n.push(l);var c=!0,f=!1,h=void 0;try{for(var d,v=u[Symbol.iterator]();!(c=(d=v.next()).done);c=!0){var p=d.value,y=this.gameData.getLetterSprite(p);l.push(new Set([y]))}}catch(t){f=!0,h=t}finally{try{c||null==v.return||v.return()}finally{if(f)throw h}}}}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}},{key:"cellPosToXY",value:function(t){var e,n,r=t.colIndex,i=t.rowIndex,o=!0;return this.windowOffsetHeight&&this.windowOffsetWidth&&(this.windowOffsetColStart>r||this.windowOffsetRowStart>i||this.windowOffsetColStart+this.windowOffsetWidth<=r||this.windowOffsetRowStart+this.windowOffsetHeight<=i)&&(o=!1),e=(r-this.windowOffsetColStart)*this.SPRITE_WIDTH,n=(i-this.windowOffsetRowStart)*this.SPRITE_HEIGHT,o&&(o=this.checkIfCellCanBeDrawnOnScreen(e,n)),(e<0||n<0)&&(o=!1),{isOnScreen:o,cellStartX:e,cellStartY:n}}},{key:"clearScreen",value:function(){this.renderedPixels=[]}},{key:"recenterPlayerIfNeeded",value:function(t,e){if(!this.gameData)throw new Error("BUG: gameData was not set yet");var n,r,i,o,a,s,u=this.windowOffsetColStart,l=this.windowOffsetRowStart,c=this.gameData.metadata.flickscreen,f=this.gameData.metadata.zoomscreen,h=this.getMaxSize(),d=h.columns,v=h.rows,p=Math.floor(d/this.SPRITE_WIDTH/this.PIXEL_WIDTH),y=Math.floor(v/this.SPRITE_HEIGHT/this.PIXEL_HEIGHT);if(c?(r=t.rowIndex-t.rowIndex%c.height,n=t.colIndex-t.colIndex%c.width,o=c.height,i=c.width):(n=0,r=0,o=this.getCurrentLevelCells().length,i=this.getCurrentLevelCells()[0].length),f?(s=Math.min(f.height,y),a=Math.min(f.width,p)):(s=y,a=p),!(o<=s&&i<=a)){var g=!1;if(i>a&&(u+Math.round(a/4)>t.colIndex||u+Math.round(3*a/4)<=t.colIndex)){var m=t.colIndex-Math.floor(a/2);(m=Math.max(m,n))+a>n+i&&(m=n+i-a),m!==this.windowOffsetColStart&&(this.windowOffsetColStart=m,g=!0)}if(o>s&&(l+Math.round(s/4)>t.rowIndex||l+Math.round(3*s/4)<=t.rowIndex)){var b=t.rowIndex-Math.floor(s/2);(b=Math.max(b,r))+s>r+o&&(b=r+o-s),b!==this.windowOffsetRowStart&&(this.windowOffsetRowStart=b,g=!0)}return g||e?g:(this.windowOffsetColStart=n,this.windowOffsetRowStart=r,!0)}return!e&&(this.windowOffsetColStart=n,this.windowOffsetRowStart=r,!0)}}]),t}();function d(t){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function v(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function p(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function y(t,e,n,r,i,o,a){try{var s=t[o](a),u=s.value}catch(t){return void n(t)}s.done?e(u):Promise.resolve(u).then(r,i)}function g(t){return function(){var e=this,n=arguments;return new Promise(function(r,i){var o=t.apply(e,n);function a(t){y(o,r,i,a,s,"next",t)}function s(t){y(o,r,i,a,s,"throw",t)}a(void 0)})}}function m(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function b(t,e,n){return(b="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=w(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function w(t){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _(t,e){return(_=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function S(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var k=function(t){function e(t,n){var r,i,o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),i=this,(r=!(o=w(e).call(this))||"object"!==d(o)&&"function"!=typeof o?S(i):o).table=t,r.tableCells=[],r.inputsProcessed=0,r.interactsWithPlayer=new Set,r.usedInMessages=new Set,t.classList.add("ps-table"),r.markAcceptingInput(!1),r.onPress=r.onPress.bind(S(S(r))),r.onLevelChange=r.onLevelChange.bind(S(S(r))),r.handler=new a.a(n?[n]:[]);var s=t.querySelector("[aria-live]")||document.querySelector("[aria-live]");if(!s)throw new Error("Error: For screenreaders to work, an element inside the table (for now) with an aria-live attribute needs to exist in the initial page. See https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/ARIA_Live_Regions");return r.liveLog=s,r.didPressCauseTick=!1,r.silencedOutput=!1,r.messagesSincePress=0,r.isCollecting=!1,r.collectedSprites=new Map,r.collectingTickCount=0,r}var n,s,u;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_(t,e)}(e,h),n=e,(s=[{key:"onPause",value:function(){this.table.setAttribute("data-ps-state","paused"),this.handler.onPause()}},{key:"onResume",value:function(){this.table.setAttribute("data-ps-state","running"),this.handler.onResume()}},{key:"onGameChange",value:function(t){b(w(e.prototype),"onGameChange",this).call(this,t),this.silencedOutput=!1,this.didPressCauseTick=!1,this.interactsWithPlayer=Object(a.q)(this.getGameData()),this.usedInMessages=new Set(this.interactsWithPlayer),this.collectedSprites.clear(),this.handler.onGameChange(t)}},{key:"onPress",value:function(t){switch(this.didPressCauseTick=!0,this.liveLog.innerHTML="",this.markAcceptingInput(!1),t){case a.b.UNDO:case a.b.RESTART:this.renderScreen(!1)}this.handler.onPress(t)}},{key:"onLevelChange",value:function(t,n,r){if(this.clearScreen(),this.table.setAttribute("data-ps-current-level","".concat(t)),n){b(w(e.prototype),"onLevelChange",this).call(this,t,n,r),this.tableCells=[];var i=this.getGameData(),o=i.metadata.flickscreen||i.metadata.zoomscreen||{width:n[0].length,height:n.length},a=o.width,s=o.height;this.table.setAttribute("tabindex","0");for(var u=document.createElement("tbody"),l=0;l<s;l++){for(var c=document.createElement("tr"),f=[],h=0;h<a;h++){var d=document.createElement("td"),v=[];d.classList.add("ps-cell");var p=document.createElement("span");p.classList.add("ps-cell-label"),d.appendChild(p);var y=document.createElement("div");y.classList.add("ps-sprite-whole"),y.setAttribute("aria-hidden","true");for(var g=0;g<this.SPRITE_HEIGHT;g++){var m=document.createElement("div");m.classList.add("ps-sprite-row");for(var _=[],S=0;S<this.SPRITE_WIDTH;S++){var k=document.createElement("span");k.classList.add("ps-sprite-pixel"),m.appendChild(k),_.push(k)}y.appendChild(m),v.push(_)}d.appendChild(y),c.appendChild(d),f.push({td:d,label:p,pixels:v})}u.appendChild(c),this.tableCells.push(f)}this.table.prepend(u);var E=!0,T=!1,O=void 0;try{for(var x,C=n[Symbol.iterator]();!(E=(x=C.next()).done);E=!0){var M=x.value;this.drawCells(M,!1)}}catch(t){T=!0,O=t}finally{try{E||null==C.return||C.return()}finally{if(T)throw O}}}this.markAcceptingInput(!0),this.handler.onLevelChange(t,n,r)}},{key:"onMessage",value:function(){var t=g(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.handler.onMessage(e);case 2:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"onWin",value:function(){this.handler.onWin()}},{key:"onSound",value:function(){var t=g(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return Object(o.playSound)(e.soundCode),t.next=3,this.handler.onSound(e);case 3:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"onTick",value:function(t,e,n,r){this.collectingTickCount++,this.printMessageLog(r,n),this.drawCells(t,!1),this.markAcceptingInput(!n),this.didPressCauseTick=!1,this.handler.onTick(t,e,n,r)}},{key:"willAllLevelsFitOnScreen",value:function(t){return!0}},{key:"_drawPixel",value:function(t,e,n,r,i){var o=Math.floor(e/this.SPRITE_HEIGHT),a=Math.floor(t/this.SPRITE_WIDTH),s=e%this.SPRITE_HEIGHT,u=t%this.SPRITE_WIDTH,l=this.tableCells[o][a].pixels[s][u];if(!l)throw new Error("BUG: Could not set pixel because table is too small");var c="color: ".concat(n,";");r&&(c+=" background-color: ".concat(r,";")),l.setAttribute("style",c)}},{key:"clearScreen",value:function(){b(w(e.prototype),"clearScreen",this).call(this);var t=this.table.querySelector("tbody");t&&t.remove(),this.liveLog.innerHTML="",this.tableCells=[]}},{key:"renderLevelScreen",value:function(t,e){this.drawCells(Object(a.g)(t),!1,e)}},{key:"setPixel",value:function(t,e,n,i,o){var a=Math.floor(e/this.SPRITE_HEIGHT),s=Math.floor(t/this.SPRITE_WIDTH),u=e%this.SPRITE_HEIGHT,l=t%this.SPRITE_WIDTH,c=this.tableCells[a][s].pixels[u][l];if(!c)throw new Error("BUG: Could not set pixel because table is too small");o&&0!==o.trim().length||(o=""),this.renderedPixels[e]||(this.renderedPixels[e]=[]);var f=this.renderedPixels[e][t];if(!f||f.hex!==n||f.chars!==o){this.renderedPixels[e][t]={hex:n,chars:o};var h=Object(r.c)(n),d=h.r,v=h.g,p=h.b,y=h.a;null!==y?c.setAttribute("style","background-color: rgba(".concat(d,",").concat(v,",").concat(p,",").concat(y,")")):c.setAttribute("style","background-color: ".concat(n))}}},{key:"drawCellsAfterRecentering",value:function(t,e){var n=!0,r=!1,i=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;this._drawCell(s,e)}}catch(t){r=!0,i=t}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}}},{key:"checkIfCellCanBeDrawnOnScreen",value:function(t,e){return!0}},{key:"getMaxSize",value:function(){return{columns:1e3,rows:1e3}}},{key:"printMessageLog",value:function(t,e){var n=this;if(!this.silencedOutput||this.didPressCauseTick){var r=[],o=function(t,e){if(r.push(t),n.isCollecting){var i=!0,o=!1,a=void 0;try{for(var s,u=e[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var l=s.value;c=n.collectedSprites,f=l,h=void 0,h=c.get(f),c.set(f,h?h+1:1)}}catch(t){o=!0,a=t}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}}var c,f,h};e&&o("game tick",[]);var s=!0,u=!1,l=void 0;try{for(var c,f=t[Symbol.iterator]();!(s=(c=f.next()).done);s=!0){var h=c.value;switch(h.type){case i.a.ADD:var d=!0,y=!1,g=void 0;try{for(var m,b=Object(a.o)(this.usedInMessages,h.sprites)[Symbol.iterator]();!(d=(m=b.next()).done);d=!0){var w=m.value;o("Added ".concat(w.getName()," @ ").concat(h.cell.rowIndex,",").concat(h.cell.colIndex),[w])}}catch(t){y=!0,g=t}finally{try{d||null==b.return||b.return()}finally{if(y)throw g}}break;case i.a.REPLACE:var _=!0,S=!1,k=void 0;try{for(var E,T=h.replacements[Symbol.iterator]();!(_=(E=T.next()).done);_=!0){var O=E.value,x=O.oldSprite,C=O.newSprite;this.usedInMessages.has(x)?this.usedInMessages.has(C)?o("Replaced ".concat(x.getName()," with ").concat(C.getName()," @ ").concat(h.cell.rowIndex,",").concat(h.cell.colIndex),[x,C]):o("Removed* ".concat(x.getName()," @ ").concat(h.cell.rowIndex,",").concat(h.cell.colIndex),[x]):this.usedInMessages.has(C)&&o("Added* ".concat(C.getName()," @ ").concat(h.cell.rowIndex,",").concat(h.cell.colIndex),[C])}}catch(t){S=!0,k=t}finally{try{_||null==T.return||T.return()}finally{if(S)throw k}}break;case i.a.REMOVE:var M=!0,R=!1,I=void 0;try{for(var A,L=Object(a.o)(this.usedInMessages,h.sprites)[Symbol.iterator]();!(M=(A=L.next()).done);M=!0){var P=A.value;o("Removed ".concat(P.getName()," @ ").concat(h.cell.rowIndex,",").concat(h.cell.colIndex),[P])}}catch(t){R=!0,I=t}finally{try{M||null==L.return||L.return()}finally{if(R)throw I}}break;case i.a.MOVE:o("Moved ".concat(h.sprite.getName()," ").concat(h.direction," to ").concat(h.newCell.rowIndex,",").concat(h.newCell.colIndex),[h.sprite]);break;default:throw new Error("BUG: unsupported a11y message type ".concat(h))}}}catch(t){u=!0,l=t}finally{try{s||null==f.return||f.return()}finally{if(u)throw l}}if(this.didPressCauseTick)r.length>10&&(r=[].concat(p(r.slice(0,4)),["(truncated messages)"],p(r.slice(r.length-4,r.length))));else if(this.silencedOutput)r=[];else if(!this.isCollecting&&(this.messagesSincePress>10||r.length>10))this.collectedSprites.size>0?(this.silencedOutput=!0,r=["Things keep changing so switching to a quieter mode"]):(this.isCollecting=!0,this.collectingTickCount=0,r=["Many things changed (probably animations). Collecting data for a few ticks to see what to ignore"]);else if(this.isCollecting&&this.collectingTickCount<20)r=[];else if(this.isCollecting){this.isCollecting=!1,r=["Done collecting. Found ".concat(this.collectedSprites.size," sprites to ignore: ").concat(p(this.collectedSprites.keys()).map(function(t){return t.getName()}).join(", "))],this.messagesSincePress=0;var N=!0,D=!1,G=void 0;try{for(var B,F=this.collectedSprites[Symbol.iterator]();!(N=(B=F.next()).done);N=!0){var j=v(B.value,2);w=j[0];j[1]>4&&this.usedInMessages.delete(w)}}catch(t){D=!0,G=t}finally{try{N||null==F.return||F.return()}finally{if(D)throw G}}}!function(){for(var t=0;t<r.length;t++){var e=r[t],i=document.createElement("p");i.textContent=e,n.liveLog.append(i),n.didPressCauseTick||n.messagesSincePress++}}(),this.didPressCauseTick&&(this.messagesSincePress=0)}}},{key:"markAcceptingInput",value:function(t){t?this.table.setAttribute("data-ps-accepting-input","true"):(this.inputsProcessed++,this.table.setAttribute("data-ps-accepting-input","false")),this.table.setAttribute("data-ps-last-input-processed","".concat(this.inputsProcessed))}},{key:"_drawCell",value:function(t){var e=this;arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this.gameData)throw new Error("BUG: gameData was not set yet");if(!this.hasVisualUi)throw new Error("BUG: Should not get to this point");var n=t.getSprites().filter(function(t){return e.interactsWithPlayer.has(t)}),r=this.cellPosToXY(t),i=r.isOnScreen,o=r.cellStartX,a=r.cellStartY;if(i){var s=this.tableCells[t.rowIndex-this.windowOffsetRowStart];if(!s)throw new Error("BUG: Should not be trying to draw when there are no table cells");var u=s[t.colIndex-this.windowOffsetColStart];if(!u)throw new Error("BUG: Should not be trying to draw when there is not a matching table cell");var l=u.label;if(!l)throw new Error("BUG: Could not find cell in the table: [".concat(t.rowIndex," - ").concat(this.windowOffsetRowStart,"][").concat(t.colIndex," - ").concat(this.windowOffsetColStart,"]"));if(n.length>0)l.classList.remove("ps-cell-empty"),this.gameData.getPlayer().getSpritesThatMatch(t).size>0?l.classList.add("ps-player"):l.classList.remove("ps-player"),l.textContent=n.map(function(t){return t.getName()}).join(", ");else l.classList.remove("ps-player"),l.classList.add("ps-cell-empty"),l.textContent="(empty)";this.getPixelsForCell(t).forEach(function(t,n){t.forEach(function(t,r){if(!e.gameData)throw new Error("BUG: gameData was not set yet");var i=o+r,s=a+n,u=null;if(t&&(u=t.isTransparent()?e.gameData.metadata.backgroundColor?e.gameData.metadata.backgroundColor:null:t),u){var l=u.toRgb(),c=(l.r,l.g,l.b,u.toHex());e.setPixel(i,s,c,null," ")}})})}}}])&&m(n.prototype,s),u&&m(n,u),e}();e.a=k},,function(t,e,n){"use strict";(function(t){if(n(155),n(351),n(352),t._babelPolyfill)throw new Error("only one instance of babel-polyfill is allowed");t._babelPolyfill=!0;var e="defineProperty";function r(t,n,r){t[n]||Object[e](t,n,{writable:!0,configurable:!0,value:r})}r(String.prototype,"padLeft","".padStart),r(String.prototype,"padRight","".padEnd),"pop,reverse,shift,keys,values,entries,indexOf,every,some,forEach,map,filter,find,findIndex,includes,join,slice,concat,push,splice,unshift,sort,lastIndexOf,reduce,reduceRight,copyWithin,fill".split(",").forEach(function(t){[][t]&&r(Array,t,Function.call.bind([][t]))})}).call(this,n(109))},function(t,e,n){n(156),n(158),n(159),n(160),n(161),n(162),n(163),n(164),n(165),n(166),n(167),n(168),n(169),n(170),n(171),n(172),n(173),n(174),n(175),n(176),n(177),n(178),n(179),n(180),n(181),n(182),n(183),n(184),n(185),n(186),n(187),n(188),n(189),n(190),n(191),n(192),n(193),n(194),n(195),n(196),n(197),n(198),n(199),n(200),n(201),n(202),n(203),n(204),n(205),n(206),n(207),n(208),n(209),n(210),n(211),n(212),n(213),n(214),n(215),n(216),n(217),n(218),n(219),n(220),n(221),n(222),n(223),n(224),n(225),n(226),n(227),n(228),n(229),n(230),n(231),n(232),n(233),n(235),n(236),n(238),n(239),n(240),n(241),n(242),n(243),n(244),n(246),n(247),n(248),n(249),n(250),n(251),n(252),n(253),n(254),n(255),n(256),n(257),n(258),n(99),n(259),n(129),n(260),n(130),n(261),n(262),n(263),n(264),n(265),n(133),n(135),n(136),n(266),n(267),n(268),n(269),n(270),n(271),n(272),n(273),n(274),n(275),n(276),n(277),n(278),n(279),n(280),n(281),n(282),n(283),n(284),n(285),n(286),n(287),n(288),n(289),n(290),n(291),n(292),n(293),n(294),n(295),n(296),n(297),n(298),n(299),n(300),n(301),n(302),n(303),n(304),n(305),n(306),n(307),n(308),n(309),n(310),n(311),n(312),n(313),n(314),n(315),n(316),n(317),n(318),n(319),n(320),n(321),n(322),n(323),n(324),n(325),n(326),n(327),n(328),n(329),n(330),n(331),n(332),n(333),n(334),n(335),n(336),n(337),n(338),n(339),n(340),n(341),n(342),n(343),n(344),n(345),n(346),n(347),n(348),n(349),n(350),t.exports=n(26)},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=n(4),o=n(22),a=n(10),s=n(1),u=n(19),l=n(37).KEY,c=n(5),f=n(63),h=n(52),d=n(42),v=n(8),p=n(111),y=n(80),g=n(157),m=n(66),b=n(3),w=n(6),_=n(23),S=n(31),k=n(41),E=n(45),T=n(114),O=n(24),x=n(11),C=n(43),M=O.f,R=x.f,I=T.f,A=i.Symbol,L=i.JSON,P=L&&L.stringify,N=v("_hidden"),D=v("toPrimitive"),G={}.propertyIsEnumerable,B=f("symbol-registry"),F=f("symbols"),j=f("op-symbols"),U=Object.prototype,W="function"==typeof A,H=i.QObject,q=!H||!H.prototype||!H.prototype.findChild,z=a&&c(function(){return 7!=E(R({},"a",{get:function(){return R(this,"a",{value:7}).a}})).a})?function(t,e,n){var r=M(U,e);r&&delete U[e],R(t,e,n),r&&t!==U&&R(U,e,r)}:R,V=function(t){var e=F[t]=E(A.prototype);return e._k=t,e},K=W&&"symbol"==r(A.iterator)?function(t){return"symbol"==r(t)}:function(t){return t instanceof A},Y=function(t,e,n){return t===U&&Y(j,e,n),b(t),e=S(e,!0),b(n),o(F,e)?(n.enumerable?(o(t,N)&&t[N][e]&&(t[N][e]=!1),n=E(n,{enumerable:k(0,!1)})):(o(t,N)||R(t,N,k(1,{})),t[N][e]=!0),z(t,e,n)):R(t,e,n)},J=function(t,e){b(t);for(var n,r=g(e=_(e)),i=0,o=r.length;o>i;)Y(t,n=r[i++],e[n]);return t},X=function(t){var e=G.call(this,t=S(t,!0));return!(this===U&&o(F,t)&&!o(j,t))&&(!(e||!o(this,t)||!o(F,t)||o(this,N)&&this[N][t])||e)},$=function(t,e){if(t=_(t),e=S(e,!0),t!==U||!o(F,e)||o(j,e)){var n=M(t,e);return!n||!o(F,e)||o(t,N)&&t[N][e]||(n.enumerable=!0),n}},Z=function(t){for(var e,n=I(_(t)),r=[],i=0;n.length>i;)o(F,e=n[i++])||e==N||e==l||r.push(e);return r},Q=function(t){for(var e,n=t===U,r=I(n?j:_(t)),i=[],a=0;r.length>a;)!o(F,e=r[a++])||n&&!o(U,e)||i.push(F[e]);return i};W||(u((A=function(){if(this instanceof A)throw TypeError("Symbol is not a constructor!");var t=d(arguments.length>0?arguments[0]:void 0);return a&&q&&z(U,t,{configurable:!0,set:function e(n){this===U&&e.call(j,n),o(this,N)&&o(this[N],t)&&(this[N][t]=!1),z(this,t,k(1,n))}}),V(t)}).prototype,"toString",function(){return this._k}),O.f=$,x.f=Y,n(46).f=T.f=Z,n(60).f=X,n(65).f=Q,a&&!n(38)&&u(U,"propertyIsEnumerable",X,!0),p.f=function(t){return V(v(t))}),s(s.G+s.W+s.F*!W,{Symbol:A});for(var tt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),et=0;tt.length>et;)v(tt[et++]);for(var nt=C(v.store),rt=0;nt.length>rt;)y(nt[rt++]);s(s.S+s.F*!W,"Symbol",{for:function(t){return o(B,t+="")?B[t]:B[t]=A(t)},keyFor:function(t){if(!K(t))throw TypeError(t+" is not a symbol!");for(var e in B)if(B[e]===t)return e},useSetter:function(){q=!0},useSimple:function(){q=!1}}),s(s.S+s.F*!W,"Object",{create:function(t,e){return void 0===e?E(t):J(E(t),e)},defineProperty:Y,defineProperties:J,getOwnPropertyDescriptor:$,getOwnPropertyNames:Z,getOwnPropertySymbols:Q}),L&&s(s.S+s.F*(!W||c(function(){var t=A();return"[null]"!=P([t])||"{}"!=P({a:t})||"{}"!=P(Object(t))})),"JSON",{stringify:function(t){for(var e,n,r=[t],i=1;arguments.length>i;)r.push(arguments[i++]);if(n=e=r[1],(w(e)||void 0!==t)&&!K(t))return m(e)||(e=function(t,e){if("function"==typeof n&&(e=n.call(this,t,e)),!K(e))return e}),r[1]=e,P.apply(L,r)}}),A.prototype[D]||n(18)(A.prototype,D,A.prototype.valueOf),h(A,"Symbol"),h(Math,"Math",!0),h(i.JSON,"JSON",!0)},function(t,e,n){var r=n(43),i=n(65),o=n(60);t.exports=function(t){var e=r(t),n=i.f;if(n)for(var a,s=n(t),u=o.f,l=0;s.length>l;)u.call(t,a=s[l++])&&e.push(a);return e}},function(t,e,n){var r=n(1);r(r.S,"Object",{create:n(45)})},function(t,e,n){var r=n(1);r(r.S+r.F*!n(10),"Object",{defineProperty:n(11).f})},function(t,e,n){var r=n(1);r(r.S+r.F*!n(10),"Object",{defineProperties:n(113)})},function(t,e,n){var r=n(23),i=n(24).f;n(33)("getOwnPropertyDescriptor",function(){return function(t,e){return i(r(t),e)}})},function(t,e,n){var r=n(12),i=n(25);n(33)("getPrototypeOf",function(){return function(t){return i(r(t))}})},function(t,e,n){var r=n(12),i=n(43);n(33)("keys",function(){return function(t){return i(r(t))}})},function(t,e,n){n(33)("getOwnPropertyNames",function(){return n(114).f})},function(t,e,n){var r=n(6),i=n(37).onFreeze;n(33)("freeze",function(t){return function(e){return t&&r(e)?t(i(e)):e}})},function(t,e,n){var r=n(6),i=n(37).onFreeze;n(33)("seal",function(t){return function(e){return t&&r(e)?t(i(e)):e}})},function(t,e,n){var r=n(6),i=n(37).onFreeze;n(33)("preventExtensions",function(t){return function(e){return t&&r(e)?t(i(e)):e}})},function(t,e,n){var r=n(6);n(33)("isFrozen",function(t){return function(e){return!r(e)||!!t&&t(e)}})},function(t,e,n){var r=n(6);n(33)("isSealed",function(t){return function(e){return!r(e)||!!t&&t(e)}})},function(t,e,n){var r=n(6);n(33)("isExtensible",function(t){return function(e){return!!r(e)&&(!t||t(e))}})},function(t,e,n){var r=n(1);r(r.S+r.F,"Object",{assign:n(115)})},function(t,e,n){var r=n(1);r(r.S,"Object",{is:n(116)})},function(t,e,n){var r=n(1);r(r.S,"Object",{setPrototypeOf:n(84).set})},function(t,e,n){"use strict";var r=n(53),i={};i[n(8)("toStringTag")]="z",i+""!="[object z]"&&n(19)(Object.prototype,"toString",function(){return"[object "+r(this)+"]"},!0)},function(t,e,n){var r=n(1);r(r.P,"Function",{bind:n(117)})},function(t,e,n){var r=n(11).f,i=Function.prototype,o=/^\s*function ([^ (]*)/;"name"in i||n(10)&&r(i,"name",{configurable:!0,get:function(){try{return(""+this).match(o)[1]}catch(t){return""}}})},function(t,e,n){"use strict";var r=n(6),i=n(25),o=n(8)("hasInstance"),a=Function.prototype;o in a||n(11).f(a,o,{value:function(t){if("function"!=typeof this||!r(t))return!1;if(!r(this.prototype))return t instanceof this;for(;t=i(t);)if(this.prototype===t)return!0;return!1}})},function(t,e,n){var r=n(1),i=n(119);r(r.G+r.F*(parseInt!=i),{parseInt:i})},function(t,e,n){var r=n(1),i=n(120);r(r.G+r.F*(parseFloat!=i),{parseFloat:i})},function(t,e,n){"use strict";var r=n(4),i=n(22),o=n(28),a=n(86),s=n(31),u=n(5),l=n(46).f,c=n(24).f,f=n(11).f,h=n(54).trim,d=r.Number,v=d,p=d.prototype,y="Number"==o(n(45)(p)),g="trim"in String.prototype,m=function(t){var e=s(t,!1);if("string"==typeof e&&e.length>2){var n,r,i,o=(e=g?e.trim():h(e,3)).charCodeAt(0);if(43===o||45===o){if(88===(n=e.charCodeAt(2))||120===n)return NaN}else if(48===o){switch(e.charCodeAt(1)){case 66:case 98:r=2,i=49;break;case 79:case 111:r=8,i=55;break;default:return+e}for(var a,u=e.slice(2),l=0,c=u.length;l<c;l++)if((a=u.charCodeAt(l))<48||a>i)return NaN;return parseInt(u,r)}}return+e};if(!d(" 0o1")||!d("0b1")||d("+0x1")){d=function(t){var e=arguments.length<1?0:t,n=this;return n instanceof d&&(y?u(function(){p.valueOf.call(n)}):"Number"!=o(n))?a(new v(m(e)),n,d):m(e)};for(var b,w=n(10)?l(v):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),_=0;w.length>_;_++)i(v,b=w[_])&&!i(d,b)&&f(d,b,c(v,b));d.prototype=p,p.constructor=d,n(19)(r,"Number",d)}},function(t,e,n){"use strict";var r=n(1),i=n(29),o=n(121),a=n(87),s=1..toFixed,u=Math.floor,l=[0,0,0,0,0,0],c="Number.toFixed: incorrect invocation!",f=function(t,e){for(var n=-1,r=e;++n<6;)r+=t*l[n],l[n]=r%1e7,r=u(r/1e7)},h=function(t){for(var e=6,n=0;--e>=0;)n+=l[e],l[e]=u(n/t),n=n%t*1e7},d=function(){for(var t=6,e="";--t>=0;)if(""!==e||0===t||0!==l[t]){var n=String(l[t]);e=""===e?n:e+a.call("0",7-n.length)+n}return e},v=function t(e,n,r){return 0===n?r:n%2==1?t(e,n-1,r*e):t(e*e,n/2,r)};r(r.P+r.F*(!!s&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!n(5)(function(){s.call({})})),"Number",{toFixed:function(t){var e,n,r,s,u=o(this,c),l=i(t),p="",y="0";if(l<0||l>20)throw RangeError(c);if(u!=u)return"NaN";if(u<=-1e21||u>=1e21)return String(u);if(u<0&&(p="-",u=-u),u>1e-21)if(n=(e=function(t){for(var e=0,n=t;n>=4096;)e+=12,n/=4096;for(;n>=2;)e+=1,n/=2;return e}(u*v(2,69,1))-69)<0?u*v(2,-e,1):u/v(2,e,1),n*=4503599627370496,(e=52-e)>0){for(f(0,n),r=l;r>=7;)f(1e7,0),r-=7;for(f(v(10,r,1),0),r=e-1;r>=23;)h(1<<23),r-=23;h(1<<r),f(1,1),h(2),y=d()}else f(0,n),f(1<<-e,0),y=d()+a.call("0",l);return y=l>0?p+((s=y.length)<=l?"0."+a.call("0",l-s)+y:y.slice(0,s-l)+"."+y.slice(s-l)):p+y}})},function(t,e,n){"use strict";var r=n(1),i=n(5),o=n(121),a=1..toPrecision;r(r.P+r.F*(i(function(){return"1"!==a.call(1,void 0)})||!i(function(){a.call({})})),"Number",{toPrecision:function(t){var e=o(this,"Number#toPrecision: incorrect invocation!");return void 0===t?a.call(e):a.call(e,t)}})},function(t,e,n){var r=n(1);r(r.S,"Number",{EPSILON:Math.pow(2,-52)})},function(t,e,n){var r=n(1),i=n(4).isFinite;r(r.S,"Number",{isFinite:function(t){return"number"==typeof t&&i(t)}})},function(t,e,n){var r=n(1);r(r.S,"Number",{isInteger:n(122)})},function(t,e,n){var r=n(1);r(r.S,"Number",{isNaN:function(t){return t!=t}})},function(t,e,n){var r=n(1),i=n(122),o=Math.abs;r(r.S,"Number",{isSafeInteger:function(t){return i(t)&&o(t)<=9007199254740991}})},function(t,e,n){var r=n(1);r(r.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(t,e,n){var r=n(1);r(r.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(t,e,n){var r=n(1),i=n(120);r(r.S+r.F*(Number.parseFloat!=i),"Number",{parseFloat:i})},function(t,e,n){var r=n(1),i=n(119);r(r.S+r.F*(Number.parseInt!=i),"Number",{parseInt:i})},function(t,e,n){var r=n(1),i=n(123),o=Math.sqrt,a=Math.acosh;r(r.S+r.F*!(a&&710==Math.floor(a(Number.MAX_VALUE))&&a(1/0)==1/0),"Math",{acosh:function(t){return(t=+t)<1?NaN:t>94906265.62425156?Math.log(t)+Math.LN2:i(t-1+o(t-1)*o(t+1))}})},function(t,e,n){var r=n(1),i=Math.asinh;r(r.S+r.F*!(i&&1/i(0)>0),"Math",{asinh:function t(e){return isFinite(e=+e)&&0!=e?e<0?-t(-e):Math.log(e+Math.sqrt(e*e+1)):e}})},function(t,e,n){var r=n(1),i=Math.atanh;r(r.S+r.F*!(i&&1/i(-0)<0),"Math",{atanh:function(t){return 0==(t=+t)?t:Math.log((1+t)/(1-t))/2}})},function(t,e,n){var r=n(1),i=n(88);r(r.S,"Math",{cbrt:function(t){return i(t=+t)*Math.pow(Math.abs(t),1/3)}})},function(t,e,n){var r=n(1);r(r.S,"Math",{clz32:function(t){return(t>>>=0)?31-Math.floor(Math.log(t+.5)*Math.LOG2E):32}})},function(t,e,n){var r=n(1),i=Math.exp;r(r.S,"Math",{cosh:function(t){return(i(t=+t)+i(-t))/2}})},function(t,e,n){var r=n(1),i=n(89);r(r.S+r.F*(i!=Math.expm1),"Math",{expm1:i})},function(t,e,n){var r=n(1);r(r.S,"Math",{fround:n(124)})},function(t,e,n){var r=n(1),i=Math.abs;r(r.S,"Math",{hypot:function(t,e){for(var n,r,o=0,a=0,s=arguments.length,u=0;a<s;)u<(n=i(arguments[a++]))?(o=o*(r=u/n)*r+1,u=n):o+=n>0?(r=n/u)*r:n;return u===1/0?1/0:u*Math.sqrt(o)}})},function(t,e,n){var r=n(1),i=Math.imul;r(r.S+r.F*n(5)(function(){return-5!=i(4294967295,5)||2!=i.length}),"Math",{imul:function(t,e){var n=+t,r=+e,i=65535&n,o=65535&r;return 0|i*o+((65535&n>>>16)*o+i*(65535&r>>>16)<<16>>>0)}})},function(t,e,n){var r=n(1);r(r.S,"Math",{log10:function(t){return Math.log(t)*Math.LOG10E}})},function(t,e,n){var r=n(1);r(r.S,"Math",{log1p:n(123)})},function(t,e,n){var r=n(1);r(r.S,"Math",{log2:function(t){return Math.log(t)/Math.LN2}})},function(t,e,n){var r=n(1);r(r.S,"Math",{sign:n(88)})},function(t,e,n){var r=n(1),i=n(89),o=Math.exp;r(r.S+r.F*n(5)(function(){return-2e-17!=!Math.sinh(-2e-17)}),"Math",{sinh:function(t){return Math.abs(t=+t)<1?(i(t)-i(-t))/2:(o(t-1)-o(-t-1))*(Math.E/2)}})},function(t,e,n){var r=n(1),i=n(89),o=Math.exp;r(r.S,"Math",{tanh:function(t){var e=i(t=+t),n=i(-t);return e==1/0?1:n==1/0?-1:(e-n)/(o(t)+o(-t))}})},function(t,e,n){var r=n(1);r(r.S,"Math",{trunc:function(t){return(t>0?Math.floor:Math.ceil)(t)}})},function(t,e,n){var r=n(1),i=n(44),o=String.fromCharCode,a=String.fromCodePoint;r(r.S+r.F*(!!a&&1!=a.length),"String",{fromCodePoint:function(t){for(var e,n=[],r=arguments.length,a=0;r>a;){if(e=+arguments[a++],i(e,1114111)!==e)throw RangeError(e+" is not a valid code point");n.push(e<65536?o(e):o(55296+((e-=65536)>>10),e%1024+56320))}return n.join("")}})},function(t,e,n){var r=n(1),i=n(23),o=n(9);r(r.S,"String",{raw:function(t){for(var e=i(t.raw),n=o(e.length),r=arguments.length,a=[],s=0;n>s;)a.push(String(e[s++])),s<r&&a.push(String(arguments[s]));return a.join("")}})},function(t,e,n){"use strict";n(54)("trim",function(t){return function(){return t(this,3)}})},function(t,e,n){"use strict";var r=n(67)(!0);n(90)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=r(e,n),this._i+=t.length,{value:t,done:!1})})},function(t,e,n){"use strict";var r=n(1),i=n(67)(!1);r(r.P,"String",{codePointAt:function(t){return i(this,t)}})},function(t,e,n){"use strict";var r=n(1),i=n(9),o=n(92),a="".endsWith;r(r.P+r.F*n(93)("endsWith"),"String",{endsWith:function(t){var e=o(this,t,"endsWith"),n=arguments.length>1?arguments[1]:void 0,r=i(e.length),s=void 0===n?r:Math.min(i(n),r),u=String(t);return a?a.call(e,u,s):e.slice(s-u.length,s)===u}})},function(t,e,n){"use strict";var r=n(1),i=n(92);r(r.P+r.F*n(93)("includes"),"String",{includes:function(t){return!!~i(this,t,"includes").indexOf(t,arguments.length>1?arguments[1]:void 0)}})},function(t,e,n){var r=n(1);r(r.P,"String",{repeat:n(87)})},function(t,e,n){"use strict";var r=n(1),i=n(9),o=n(92),a="".startsWith;r(r.P+r.F*n(93)("startsWith"),"String",{startsWith:function(t){var e=o(this,t,"startsWith"),n=i(Math.min(arguments.length>1?arguments[1]:void 0,e.length)),r=String(t);return a?a.call(e,r,n):e.slice(n,n+r.length)===r}})},function(t,e,n){"use strict";n(20)("anchor",function(t){return function(e){return t(this,"a","name",e)}})},function(t,e,n){"use strict";n(20)("big",function(t){return function(){return t(this,"big","","")}})},function(t,e,n){"use strict";n(20)("blink",function(t){return function(){return t(this,"blink","","")}})},function(t,e,n){"use strict";n(20)("bold",function(t){return function(){return t(this,"b","","")}})},function(t,e,n){"use strict";n(20)("fixed",function(t){return function(){return t(this,"tt","","")}})},function(t,e,n){"use strict";n(20)("fontcolor",function(t){return function(e){return t(this,"font","color",e)}})},function(t,e,n){"use strict";n(20)("fontsize",function(t){return function(e){return t(this,"font","size",e)}})},function(t,e,n){"use strict";n(20)("italics",function(t){return function(){return t(this,"i","","")}})},function(t,e,n){"use strict";n(20)("link",function(t){return function(e){return t(this,"a","href",e)}})},function(t,e,n){"use strict";n(20)("small",function(t){return function(){return t(this,"small","","")}})},function(t,e,n){"use strict";n(20)("strike",function(t){return function(){return t(this,"strike","","")}})},function(t,e,n){"use strict";n(20)("sub",function(t){return function(){return t(this,"sub","","")}})},function(t,e,n){"use strict";n(20)("sup",function(t){return function(){return t(this,"sup","","")}})},function(t,e,n){var r=n(1);r(r.S,"Date",{now:function(){return(new Date).getTime()}})},function(t,e,n){"use strict";var r=n(1),i=n(12),o=n(31);r(r.P+r.F*n(5)(function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}),"Date",{toJSON:function(t){var e=i(this),n=o(e);return"number"!=typeof n||isFinite(n)?e.toISOString():null}})},function(t,e,n){var r=n(1),i=n(234);r(r.P+r.F*(Date.prototype.toISOString!==i),"Date",{toISOString:i})},function(t,e,n){"use strict";var r=n(5),i=Date.prototype.getTime,o=Date.prototype.toISOString,a=function(t){return t>9?t:"0"+t};t.exports=r(function(){return"0385-07-25T07:06:39.999Z"!=o.call(new Date(-5e13-1))})||!r(function(){o.call(new Date(NaN))})?function(){if(!isFinite(i.call(this)))throw RangeError("Invalid time value");var t=this,e=t.getUTCFullYear(),n=t.getUTCMilliseconds(),r=e<0?"-":e>9999?"+":"";return r+("00000"+Math.abs(e)).slice(r?-6:-4)+"-"+a(t.getUTCMonth()+1)+"-"+a(t.getUTCDate())+"T"+a(t.getUTCHours())+":"+a(t.getUTCMinutes())+":"+a(t.getUTCSeconds())+"."+(n>99?n:"0"+a(n))+"Z"}:o},function(t,e,n){var r=Date.prototype,i=r.toString,o=r.getTime;new Date(NaN)+""!="Invalid Date"&&n(19)(r,"toString",function(){var t=o.call(this);return t==t?i.call(this):"Invalid Date"})},function(t,e,n){var r=n(8)("toPrimitive"),i=Date.prototype;r in i||n(18)(i,r,n(237))},function(t,e,n){"use strict";var r=n(3),i=n(31);t.exports=function(t){if("string"!==t&&"number"!==t&&"default"!==t)throw TypeError("Incorrect hint");return i(r(this),"number"!=t)}},function(t,e,n){var r=n(1);r(r.S,"Array",{isArray:n(66)})},function(t,e,n){"use strict";var r=n(27),i=n(1),o=n(12),a=n(125),s=n(94),u=n(9),l=n(95),c=n(96);i(i.S+i.F*!n(69)(function(t){Array.from(t)}),"Array",{from:function(t){var e,n,i,f,h=o(t),d="function"==typeof this?this:Array,v=arguments.length,p=v>1?arguments[1]:void 0,y=void 0!==p,g=0,m=c(h);if(y&&(p=r(p,v>2?arguments[2]:void 0,2)),null==m||d==Array&&s(m))for(n=new d(e=u(h.length));e>g;g++)l(n,g,y?p(h[g],g):h[g]);else for(f=m.call(h),n=new d;!(i=f.next()).done;g++)l(n,g,y?a(f,p,[i.value,g],!0):i.value);return n.length=g,n}})},function(t,e,n){"use strict";var r=n(1),i=n(95);r(r.S+r.F*n(5)(function(){function t(){}return!(Array.of.call(t)instanceof t)}),"Array",{of:function(){for(var t=0,e=arguments.length,n=new("function"==typeof this?this:Array)(e);e>t;)i(n,t,arguments[t++]);return n.length=e,n}})},function(t,e,n){"use strict";var r=n(1),i=n(23),o=[].join;r(r.P+r.F*(n(59)!=Object||!n(30)(o)),"Array",{join:function(t){return o.call(i(this),void 0===t?",":t)}})},function(t,e,n){"use strict";var r=n(1),i=n(83),o=n(28),a=n(44),s=n(9),u=[].slice;r(r.P+r.F*n(5)(function(){i&&u.call(i)}),"Array",{slice:function(t,e){var n=s(this.length),r=o(this);if(e=void 0===e?n:e,"Array"==r)return u.call(this,t,e);for(var i=a(t,n),l=a(e,n),c=s(l-i),f=new Array(c),h=0;h<c;h++)f[h]="String"==r?this.charAt(i+h):this[i+h];return f}})},function(t,e,n){"use strict";var r=n(1),i=n(15),o=n(12),a=n(5),s=[].sort,u=[1,2,3];r(r.P+r.F*(a(function(){u.sort(void 0)})||!a(function(){u.sort(null)})||!n(30)(s)),"Array",{sort:function(t){return void 0===t?s.call(o(this)):s.call(o(this),i(t))}})},function(t,e,n){"use strict";var r=n(1),i=n(34)(0),o=n(30)([].forEach,!0);r(r.P+r.F*!o,"Array",{forEach:function(t){return i(this,t,arguments[1])}})},function(t,e,n){var r=n(6),i=n(66),o=n(8)("species");t.exports=function(t){var e;return i(t)&&("function"!=typeof(e=t.constructor)||e!==Array&&!i(e.prototype)||(e=void 0),r(e)&&null===(e=e[o])&&(e=void 0)),void 0===e?Array:e}},function(t,e,n){"use strict";var r=n(1),i=n(34)(1);r(r.P+r.F*!n(30)([].map,!0),"Array",{map:function(t){return i(this,t,arguments[1])}})},function(t,e,n){"use strict";var r=n(1),i=n(34)(2);r(r.P+r.F*!n(30)([].filter,!0),"Array",{filter:function(t){return i(this,t,arguments[1])}})},function(t,e,n){"use strict";var r=n(1),i=n(34)(3);r(r.P+r.F*!n(30)([].some,!0),"Array",{some:function(t){return i(this,t,arguments[1])}})},function(t,e,n){"use strict";var r=n(1),i=n(34)(4);r(r.P+r.F*!n(30)([].every,!0),"Array",{every:function(t){return i(this,t,arguments[1])}})},function(t,e,n){"use strict";var r=n(1),i=n(126);r(r.P+r.F*!n(30)([].reduce,!0),"Array",{reduce:function(t){return i(this,t,arguments.length,arguments[1],!1)}})},function(t,e,n){"use strict";var r=n(1),i=n(126);r(r.P+r.F*!n(30)([].reduceRight,!0),"Array",{reduceRight:function(t){return i(this,t,arguments.length,arguments[1],!0)}})},function(t,e,n){"use strict";var r=n(1),i=n(64)(!1),o=[].indexOf,a=!!o&&1/[1].indexOf(1,-0)<0;r(r.P+r.F*(a||!n(30)(o)),"Array",{indexOf:function(t){return a?o.apply(this,arguments)||0:i(this,t,arguments[1])}})},function(t,e,n){"use strict";var r=n(1),i=n(23),o=n(29),a=n(9),s=[].lastIndexOf,u=!!s&&1/[1].lastIndexOf(1,-0)<0;r(r.P+r.F*(u||!n(30)(s)),"Array",{lastIndexOf:function(t){if(u)return s.apply(this,arguments)||0;var e=i(this),n=a(e.length),r=n-1;for(arguments.length>1&&(r=Math.min(r,o(arguments[1]))),r<0&&(r=n+r);r>=0;r--)if(r in e&&e[r]===t)return r||0;return-1}})},function(t,e,n){var r=n(1);r(r.P,"Array",{copyWithin:n(127)}),n(39)("copyWithin")},function(t,e,n){var r=n(1);r(r.P,"Array",{fill:n(98)}),n(39)("fill")},function(t,e,n){"use strict";var r=n(1),i=n(34)(5),o=!0;"find"in[]&&Array(1).find(function(){o=!1}),r(r.P+r.F*o,"Array",{find:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),n(39)("find")},function(t,e,n){"use strict";var r=n(1),i=n(34)(6),o="findIndex",a=!0;o in[]&&Array(1)[o](function(){a=!1}),r(r.P+r.F*a,"Array",{findIndex:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),n(39)(o)},function(t,e,n){n(47)("Array")},function(t,e,n){var r=n(4),i=n(86),o=n(11).f,a=n(46).f,s=n(68),u=n(61),l=r.RegExp,c=l,f=l.prototype,h=/a/g,d=/a/g,v=new l(h)!==h;if(n(10)&&(!v||n(5)(function(){return d[n(8)("match")]=!1,l(h)!=h||l(d)==d||"/a/i"!=l(h,"i")}))){l=function(t,e){var n=this instanceof l,r=s(t),o=void 0===e;return!n&&r&&t.constructor===l&&o?t:i(v?new c(r&&!o?t.source:t,e):c((r=t instanceof l)?t.source:t,r&&o?u.call(t):e),n?this:f,l)};for(var p=function(t){t in l||o(l,t,{configurable:!0,get:function(){return c[t]},set:function(e){c[t]=e}})},y=a(c),g=0;y.length>g;)p(y[g++]);f.constructor=l,l.prototype=f,n(19)(r,"RegExp",l)}n(47)("RegExp")},function(t,e,n){"use strict";n(130);var r=n(3),i=n(61),o=n(10),a=/./.toString,s=function(t){n(19)(RegExp.prototype,"toString",t,!0)};n(5)(function(){return"/a/b"!=a.call({source:"a",flags:"b"})})?s(function(){var t=r(this);return"/".concat(t.source,"/","flags"in t?t.flags:!o&&t instanceof RegExp?i.call(t):void 0)}):"toString"!=a.name&&s(function(){return a.call(this)})},function(t,e,n){"use strict";var r=n(3),i=n(9),o=n(101),a=n(70);n(71)("match",1,function(t,e,n,s){return[function(n){var r=t(this),i=null==n?void 0:n[e];return void 0!==i?i.call(n,r):new RegExp(n)[e](String(r))},function(t){var e=s(n,t,this);if(e.done)return e.value;var u=r(t),l=String(this);if(!u.global)return a(u,l);var c=u.unicode;u.lastIndex=0;for(var f,h=[],d=0;null!==(f=a(u,l));){var v=String(f[0]);h[d]=v,""===v&&(u.lastIndex=o(l,i(u.lastIndex),c)),d++}return 0===d?null:h}]})},function(t,e,n){"use strict";var r=n(3),i=n(12),o=n(9),a=n(29),s=n(101),u=n(70),l=Math.max,c=Math.min,f=Math.floor,h=/\$([$&`']|\d\d?|<[^>]*>)/g,d=/\$([$&`']|\d\d?)/g;n(71)("replace",2,function(t,e,n,v){return[function(r,i){var o=t(this),a=null==r?void 0:r[e];return void 0!==a?a.call(r,o,i):n.call(String(o),r,i)},function(t,e){var i=v(n,t,this,e);if(i.done)return i.value;var f=r(t),h=String(this),d="function"==typeof e;d||(e=String(e));var y=f.global;if(y){var g=f.unicode;f.lastIndex=0}for(var m=[];;){var b=u(f,h);if(null===b)break;if(m.push(b),!y)break;""===String(b[0])&&(f.lastIndex=s(h,o(f.lastIndex),g))}for(var w,_="",S=0,k=0;k<m.length;k++){b=m[k];for(var E=String(b[0]),T=l(c(a(b.index),h.length),0),O=[],x=1;x<b.length;x++)O.push(void 0===(w=b[x])?w:String(w));var C=b.groups;if(d){var M=[E].concat(O,T,h);void 0!==C&&M.push(C);var R=String(e.apply(void 0,M))}else R=p(E,h,T,O,C,e);T>=S&&(_+=h.slice(S,T)+R,S=T+E.length)}return _+h.slice(S)}];function p(t,e,r,o,a,s){var u=r+t.length,l=o.length,c=d;return void 0!==a&&(a=i(a),c=h),n.call(s,c,function(n,i){var s;switch(i.charAt(0)){case"$":return"$";case"&":return t;case"`":return e.slice(0,r);case"'":return e.slice(u);case"<":s=a[i.slice(1,-1)];break;default:var c=+i;if(0===c)return i;if(c>l){var h=f(c/10);return 0===h?i:h<=l?void 0===o[h-1]?i.charAt(1):o[h-1]+i.charAt(1):i}s=o[c-1]}return void 0===s?"":s})}})},function(t,e,n){"use strict";var r=n(3),i=n(116),o=n(70);n(71)("search",1,function(t,e,n,a){return[function(n){var r=t(this),i=null==n?void 0:n[e];return void 0!==i?i.call(n,r):new RegExp(n)[e](String(r))},function(t){var e=a(n,t,this);if(e.done)return e.value;var s=r(t),u=String(this),l=s.lastIndex;i(l,0)||(s.lastIndex=0);var c=o(s,u);return i(s.lastIndex,l)||(s.lastIndex=l),null===c?-1:c.index}]})},function(t,e,n){"use strict";var r=n(68),i=n(3),o=n(62),a=n(101),s=n(9),u=n(70),l=n(100),c=Math.min,f=[].push,h=!!function(){try{return new RegExp("x","y")}catch(t){}}();n(71)("split",2,function(t,e,n,d){var v=n;return"c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?v=function(t,e){var i=String(this);if(void 0===t&&0===e)return[];if(!r(t))return n.call(i,t,e);for(var o,a,s,u=[],c=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),h=0,d=void 0===e?4294967295:e>>>0,v=new RegExp(t.source,c+"g");(o=l.call(v,i))&&!((a=v.lastIndex)>h&&(u.push(i.slice(h,o.index)),o.length>1&&o.index<i.length&&f.apply(u,o.slice(1)),s=o[0].length,h=a,u.length>=d));)v.lastIndex===o.index&&v.lastIndex++;return h===i.length?!s&&v.test("")||u.push(""):u.push(i.slice(h)),u.length>d?u.slice(0,d):u}:"0".split(void 0,0).length&&(v=function(t,e){return void 0===t&&0===e?[]:n.call(this,t,e)}),[function(n,r){var i=t(this),o=null==n?void 0:n[e];return void 0!==o?o.call(n,i,r):v.call(String(i),n,r)},function(t,e){var r=d(v,t,this,e,v!==n);if(r.done)return r.value;var l=i(t),f=String(this),p=o(l,RegExp),y=l.unicode,g=(l.ignoreCase?"i":"")+(l.multiline?"m":"")+(l.unicode?"u":"")+(h?"y":"g"),m=new p(h?l:"^(?:"+l.source+")",g),b=void 0===e?4294967295:e>>>0;if(0===b)return[];if(0===f.length)return null===u(m,f)?[f]:[];for(var w=0,_=0,S=[];_<f.length;){m.lastIndex=h?_:0;var k,E=u(m,h?f:f.slice(_));if(null===E||(k=c(s(m.lastIndex+(h?0:_)),f.length))===w)_=a(f,_,y);else{if(S.push(f.slice(w,_)),S.length===b)return S;for(var T=1;T<=E.length-1;T++)if(S.push(E[T]),S.length===b)return S;_=w=k}}return S.push(f.slice(w)),S}]})},function(t,e,n){"use strict";var r,i,o,a,s=n(38),u=n(4),l=n(27),c=n(53),f=n(1),h=n(6),d=n(15),v=n(48),p=n(49),y=n(62),g=n(102).set,m=n(103)(),b=n(104),w=n(131),_=n(72),S=n(132),k=u.TypeError,E=u.process,T=E&&E.versions,O=T&&T.v8||"",x=u.Promise,C="process"==c(E),M=function(){},R=i=b.f,I=!!function(){try{var t=x.resolve(1),e=(t.constructor={})[n(8)("species")]=function(t){t(M,M)};return(C||"function"==typeof PromiseRejectionEvent)&&t.then(M)instanceof e&&0!==O.indexOf("6.6")&&-1===_.indexOf("Chrome/66")}catch(t){}}(),A=function(t){var e;return!(!h(t)||"function"!=typeof(e=t.then))&&e},L=function(t,e){if(!t._n){t._n=!0;var n=t._c;m(function(){for(var r=t._v,i=1==t._s,o=0,a=function(e){var n,o,a,s=i?e.ok:e.fail,u=e.resolve,l=e.reject,c=e.domain;try{s?(i||(2==t._h&&D(t),t._h=1),!0===s?n=r:(c&&c.enter(),n=s(r),c&&(c.exit(),a=!0)),n===e.promise?l(k("Promise-chain cycle")):(o=A(n))?o.call(n,u,l):u(n)):l(r)}catch(t){c&&!a&&c.exit(),l(t)}};n.length>o;)a(n[o++]);t._c=[],t._n=!1,e&&!t._h&&P(t)})}},P=function(t){g.call(u,function(){var e,n,r,i=t._v,o=N(t);if(o&&(e=w(function(){C?E.emit("unhandledRejection",i,t):(n=u.onunhandledrejection)?n({promise:t,reason:i}):(r=u.console)&&r.error&&r.error("Unhandled promise rejection",i)}),t._h=C||N(t)?2:1),t._a=void 0,o&&e.e)throw e.v})},N=function(t){return 1!==t._h&&0===(t._a||t._c).length},D=function(t){g.call(u,function(){var e;C?E.emit("rejectionHandled",t):(e=u.onrejectionhandled)&&e({promise:t,reason:t._v})})},G=function(t){var e=this;e._d||(e._d=!0,(e=e._w||e)._v=t,e._s=2,e._a||(e._a=e._c.slice()),L(e,!0))},B=function t(e){var n,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===e)throw k("Promise can't be resolved itself");(n=A(e))?m(function(){var i={_w:r,_d:!1};try{n.call(e,l(t,i,1),l(G,i,1))}catch(t){G.call(i,t)}}):(r._v=e,r._s=1,L(r,!1))}catch(t){G.call({_w:r,_d:!1},t)}}};I||(x=function(t){v(this,x,"Promise","_h"),d(t),r.call(this);try{t(l(B,this,1),l(G,this,1))}catch(t){G.call(this,t)}},(r=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=n(50)(x.prototype,{then:function(t,e){var n=R(y(this,x));return n.ok="function"!=typeof t||t,n.fail="function"==typeof e&&e,n.domain=C?E.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&L(this,!1),n.promise},catch:function(t){return this.then(void 0,t)}}),o=function(){var t=new r;this.promise=t,this.resolve=l(B,t,1),this.reject=l(G,t,1)},b.f=R=function(t){return t===x||t===a?new o(t):i(t)}),f(f.G+f.W+f.F*!I,{Promise:x}),n(52)(x,"Promise"),n(47)("Promise"),a=n(26).Promise,f(f.S+f.F*!I,"Promise",{reject:function(t){var e=R(this);return(0,e.reject)(t),e.promise}}),f(f.S+f.F*(s||!I),"Promise",{resolve:function(t){return S(s&&this===a?x:this,t)}}),f(f.S+f.F*!(I&&n(69)(function(t){x.all(t).catch(M)})),"Promise",{all:function(t){var e=this,n=R(e),r=n.resolve,i=n.reject,o=w(function(){var n=[],o=0,a=1;p(t,!1,function(t){var s=o++,u=!1;n.push(void 0),a++,e.resolve(t).then(function(t){u||(u=!0,n[s]=t,--a||r(n))},i)}),--a||r(n)});return o.e&&i(o.v),n.promise},race:function(t){var e=this,n=R(e),r=n.reject,i=w(function(){p(t,!1,function(t){e.resolve(t).then(n.resolve,r)})});return i.e&&r(i.v),n.promise}})},function(t,e,n){"use strict";var r=n(137),i=n(56);n(73)("WeakSet",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return r.def(i(this,"WeakSet"),t,!0)}},r,!1,!0)},function(t,e,n){"use strict";var r=n(1),i=n(74),o=n(105),a=n(3),s=n(44),u=n(9),l=n(6),c=n(4).ArrayBuffer,f=n(62),h=o.ArrayBuffer,d=o.DataView,v=i.ABV&&c.isView,p=h.prototype.slice,y=i.VIEW;r(r.G+r.W+r.F*(c!==h),{ArrayBuffer:h}),r(r.S+r.F*!i.CONSTR,"ArrayBuffer",{isView:function(t){return v&&v(t)||l(t)&&y in t}}),r(r.P+r.U+r.F*n(5)(function(){return!new h(2).slice(1,void 0).byteLength}),"ArrayBuffer",{slice:function(t,e){if(void 0!==p&&void 0===e)return p.call(a(this),t);for(var n=a(this).byteLength,r=s(t,n),i=s(void 0===e?n:e,n),o=new(f(this,h))(u(i-r)),l=new d(this),c=new d(o),v=0;r<i;)c.setUint8(v++,l.getUint8(r++));return o}}),n(47)("ArrayBuffer")},function(t,e,n){var r=n(1);r(r.G+r.W+r.F*!n(74).ABV,{DataView:n(105).DataView})},function(t,e,n){n(35)("Int8",1,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,e,n){n(35)("Uint8",1,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,e,n){n(35)("Uint8",1,function(t){return function(e,n,r){return t(this,e,n,r)}},!0)},function(t,e,n){n(35)("Int16",2,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,e,n){n(35)("Uint16",2,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,e,n){n(35)("Int32",4,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,e,n){n(35)("Uint32",4,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,e,n){n(35)("Float32",4,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,e,n){n(35)("Float64",8,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,e,n){var r=n(1),i=n(15),o=n(3),a=(n(4).Reflect||{}).apply,s=Function.apply;r(r.S+r.F*!n(5)(function(){a(function(){})}),"Reflect",{apply:function(t,e,n){var r=i(t),u=o(n);return a?a(r,e,u):s.call(r,e,u)}})},function(t,e,n){var r=n(1),i=n(45),o=n(15),a=n(3),s=n(6),u=n(5),l=n(117),c=(n(4).Reflect||{}).construct,f=u(function(){function t(){}return!(c(function(){},[],t)instanceof t)}),h=!u(function(){c(function(){})});r(r.S+r.F*(f||h),"Reflect",{construct:function(t,e){o(t),a(e);var n=arguments.length<3?t:o(arguments[2]);if(h&&!f)return c(t,e,n);if(t==n){switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3])}var r=[null];return r.push.apply(r,e),new(l.apply(t,r))}var u=n.prototype,d=i(s(u)?u:Object.prototype),v=Function.apply.call(t,d,e);return s(v)?v:d}})},function(t,e,n){var r=n(11),i=n(1),o=n(3),a=n(31);i(i.S+i.F*n(5)(function(){Reflect.defineProperty(r.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function(t,e,n){o(t),e=a(e,!0),o(n);try{return r.f(t,e,n),!0}catch(t){return!1}}})},function(t,e,n){var r=n(1),i=n(24).f,o=n(3);r(r.S,"Reflect",{deleteProperty:function(t,e){var n=i(o(t),e);return!(n&&!n.configurable)&&delete t[e]}})},function(t,e,n){"use strict";var r=n(1),i=n(3),o=function(t){this._t=i(t),this._i=0;var e,n=this._k=[];for(e in t)n.push(e)};n(91)(o,"Object",function(){var t,e=this._k;do{if(this._i>=e.length)return{value:void 0,done:!0}}while(!((t=e[this._i++])in this._t));return{value:t,done:!1}}),r(r.S,"Reflect",{enumerate:function(t){return new o(t)}})},function(t,e,n){var r=n(24),i=n(25),o=n(22),a=n(1),s=n(6),u=n(3);a(a.S,"Reflect",{get:function t(e,n){var a,l,c=arguments.length<3?e:arguments[2];return u(e)===c?e[n]:(a=r.f(e,n))?o(a,"value")?a.value:void 0!==a.get?a.get.call(c):void 0:s(l=i(e))?t(l,n,c):void 0}})},function(t,e,n){var r=n(24),i=n(1),o=n(3);i(i.S,"Reflect",{getOwnPropertyDescriptor:function(t,e){return r.f(o(t),e)}})},function(t,e,n){var r=n(1),i=n(25),o=n(3);r(r.S,"Reflect",{getPrototypeOf:function(t){return i(o(t))}})},function(t,e,n){var r=n(1);r(r.S,"Reflect",{has:function(t,e){return e in t}})},function(t,e,n){var r=n(1),i=n(3),o=Object.isExtensible;r(r.S,"Reflect",{isExtensible:function(t){return i(t),!o||o(t)}})},function(t,e,n){var r=n(1);r(r.S,"Reflect",{ownKeys:n(139)})},function(t,e,n){var r=n(1),i=n(3),o=Object.preventExtensions;r(r.S,"Reflect",{preventExtensions:function(t){i(t);try{return o&&o(t),!0}catch(t){return!1}}})},function(t,e,n){var r=n(11),i=n(24),o=n(25),a=n(22),s=n(1),u=n(41),l=n(3),c=n(6);s(s.S,"Reflect",{set:function t(e,n,s){var f,h,d=arguments.length<4?e:arguments[3],v=i.f(l(e),n);if(!v){if(c(h=o(e)))return t(h,n,s,d);v=u(0)}if(a(v,"value")){if(!1===v.writable||!c(d))return!1;if(f=i.f(d,n)){if(f.get||f.set||!1===f.writable)return!1;f.value=s,r.f(d,n,f)}else r.f(d,n,u(0,s));return!0}return void 0!==v.set&&(v.set.call(d,s),!0)}})},function(t,e,n){var r=n(1),i=n(84);i&&r(r.S,"Reflect",{setPrototypeOf:function(t,e){i.check(t,e);try{return i.set(t,e),!0}catch(t){return!1}}})},function(t,e,n){"use strict";var r=n(1),i=n(64)(!0);r(r.P,"Array",{includes:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),n(39)("includes")},function(t,e,n){"use strict";var r=n(1),i=n(140),o=n(12),a=n(9),s=n(15),u=n(97);r(r.P,"Array",{flatMap:function(t){var e,n,r=o(this);return s(t),e=a(r.length),n=u(r,0),i(n,r,r,e,0,1,t,arguments[1]),n}}),n(39)("flatMap")},function(t,e,n){"use strict";var r=n(1),i=n(140),o=n(12),a=n(9),s=n(29),u=n(97);r(r.P,"Array",{flatten:function(){var t=arguments[0],e=o(this),n=a(e.length),r=u(e,0);return i(r,e,e,n,0,void 0===t?1:s(t)),r}}),n(39)("flatten")},function(t,e,n){"use strict";var r=n(1),i=n(67)(!0);r(r.P,"String",{at:function(t){return i(this,t)}})},function(t,e,n){"use strict";var r=n(1),i=n(141),o=n(72);r(r.P+r.F*/Version\/10\.\d+(\.\d+)? Safari\//.test(o),"String",{padStart:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0,!0)}})},function(t,e,n){"use strict";var r=n(1),i=n(141),o=n(72);r(r.P+r.F*/Version\/10\.\d+(\.\d+)? Safari\//.test(o),"String",{padEnd:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0,!1)}})},function(t,e,n){"use strict";n(54)("trimLeft",function(t){return function(){return t(this,1)}},"trimStart")},function(t,e,n){"use strict";n(54)("trimRight",function(t){return function(){return t(this,2)}},"trimEnd")},function(t,e,n){"use strict";var r=n(1),i=n(32),o=n(9),a=n(68),s=n(61),u=RegExp.prototype,l=function(t,e){this._r=t,this._s=e};n(91)(l,"RegExp String",function(){var t=this._r.exec(this._s);return{value:t,done:null===t}}),r(r.P,"String",{matchAll:function(t){if(i(this),!a(t))throw TypeError(t+" is not a regexp!");var e=String(this),n="flags"in u?String(t.flags):s.call(t),r=new RegExp(t.source,~n.indexOf("g")?n:"g"+n);return r.lastIndex=o(t.lastIndex),new l(r,e)}})},function(t,e,n){n(80)("asyncIterator")},function(t,e,n){n(80)("observable")},function(t,e,n){var r=n(1),i=n(139),o=n(23),a=n(24),s=n(95);r(r.S,"Object",{getOwnPropertyDescriptors:function(t){for(var e,n,r=o(t),u=a.f,l=i(r),c={},f=0;l.length>f;)void 0!==(n=u(r,e=l[f++]))&&s(c,e,n);return c}})},function(t,e,n){var r=n(1),i=n(142)(!1);r(r.S,"Object",{values:function(t){return i(t)}})},function(t,e,n){var r=n(1),i=n(142)(!0);r(r.S,"Object",{entries:function(t){return i(t)}})},function(t,e,n){"use strict";var r=n(1),i=n(12),o=n(15),a=n(11);n(10)&&r(r.P+n(75),"Object",{__defineGetter__:function(t,e){a.f(i(this),t,{get:o(e),enumerable:!0,configurable:!0})}})},function(t,e,n){"use strict";var r=n(1),i=n(12),o=n(15),a=n(11);n(10)&&r(r.P+n(75),"Object",{__defineSetter__:function(t,e){a.f(i(this),t,{set:o(e),enumerable:!0,configurable:!0})}})},function(t,e,n){"use strict";var r=n(1),i=n(12),o=n(31),a=n(25),s=n(24).f;n(10)&&r(r.P+n(75),"Object",{__lookupGetter__:function(t){var e,n=i(this),r=o(t,!0);do{if(e=s(n,r))return e.get}while(n=a(n))}})},function(t,e,n){"use strict";var r=n(1),i=n(12),o=n(31),a=n(25),s=n(24).f;n(10)&&r(r.P+n(75),"Object",{__lookupSetter__:function(t){var e,n=i(this),r=o(t,!0);do{if(e=s(n,r))return e.set}while(n=a(n))}})},function(t,e,n){var r=n(1);r(r.P+r.R,"Map",{toJSON:n(143)("Map")})},function(t,e,n){var r=n(1);r(r.P+r.R,"Set",{toJSON:n(143)("Set")})},function(t,e,n){n(76)("Map")},function(t,e,n){n(76)("Set")},function(t,e,n){n(76)("WeakMap")},function(t,e,n){n(76)("WeakSet")},function(t,e,n){n(77)("Map")},function(t,e,n){n(77)("Set")},function(t,e,n){n(77)("WeakMap")},function(t,e,n){n(77)("WeakSet")},function(t,e,n){var r=n(1);r(r.G,{global:n(4)})},function(t,e,n){var r=n(1);r(r.S,"System",{global:n(4)})},function(t,e,n){var r=n(1),i=n(28);r(r.S,"Error",{isError:function(t){return"Error"===i(t)}})},function(t,e,n){var r=n(1);r(r.S,"Math",{clamp:function(t,e,n){return Math.min(n,Math.max(e,t))}})},function(t,e,n){var r=n(1);r(r.S,"Math",{DEG_PER_RAD:Math.PI/180})},function(t,e,n){var r=n(1),i=180/Math.PI;r(r.S,"Math",{degrees:function(t){return t*i}})},function(t,e,n){var r=n(1),i=n(145),o=n(124);r(r.S,"Math",{fscale:function(t,e,n,r,a){return o(i(t,e,n,r,a))}})},function(t,e,n){var r=n(1);r(r.S,"Math",{iaddh:function(t,e,n,r){var i=t>>>0,o=n>>>0;return(e>>>0)+(r>>>0)+((i&o|(i|o)&~(i+o>>>0))>>>31)|0}})},function(t,e,n){var r=n(1);r(r.S,"Math",{isubh:function(t,e,n,r){var i=t>>>0,o=n>>>0;return(e>>>0)-(r>>>0)-((~i&o|~(i^o)&i-o>>>0)>>>31)|0}})},function(t,e,n){var r=n(1);r(r.S,"Math",{imulh:function(t,e){var n=+t,r=+e,i=65535&n,o=65535&r,a=n>>16,s=r>>16,u=(a*o>>>0)+(i*o>>>16);return a*s+(u>>16)+((i*s>>>0)+(65535&u)>>16)}})},function(t,e,n){var r=n(1);r(r.S,"Math",{RAD_PER_DEG:180/Math.PI})},function(t,e,n){var r=n(1),i=Math.PI/180;r(r.S,"Math",{radians:function(t){return t*i}})},function(t,e,n){var r=n(1);r(r.S,"Math",{scale:n(145)})},function(t,e,n){var r=n(1);r(r.S,"Math",{umulh:function(t,e){var n=+t,r=+e,i=65535&n,o=65535&r,a=n>>>16,s=r>>>16,u=(a*o>>>0)+(i*o>>>16);return a*s+(u>>>16)+((i*s>>>0)+(65535&u)>>>16)}})},function(t,e,n){var r=n(1);r(r.S,"Math",{signbit:function(t){return(t=+t)!=t?t:0==t?1/t==1/0:t>0}})},function(t,e,n){"use strict";var r=n(1),i=n(26),o=n(4),a=n(62),s=n(132);r(r.P+r.R,"Promise",{finally:function(t){var e=a(this,i.Promise||o.Promise),n="function"==typeof t;return this.then(n?function(n){return s(e,t()).then(function(){return n})}:t,n?function(n){return s(e,t()).then(function(){throw n})}:t)}})},function(t,e,n){"use strict";var r=n(1),i=n(104),o=n(131);r(r.S,"Promise",{try:function(t){var e=i.f(this),n=o(t);return(n.e?e.reject:e.resolve)(n.v),e.promise}})},function(t,e,n){var r=n(36),i=n(3),o=r.key,a=r.set;r.exp({defineMetadata:function(t,e,n,r){a(t,e,i(n),o(r))}})},function(t,e,n){var r=n(36),i=n(3),o=r.key,a=r.map,s=r.store;r.exp({deleteMetadata:function(t,e){var n=arguments.length<3?void 0:o(arguments[2]),r=a(i(e),n,!1);if(void 0===r||!r.delete(t))return!1;if(r.size)return!0;var u=s.get(e);return u.delete(n),!!u.size||s.delete(e)}})},function(t,e,n){var r=n(36),i=n(3),o=n(25),a=r.has,s=r.get,u=r.key;r.exp({getMetadata:function(t,e){return function t(e,n,r){if(a(e,n,r))return s(e,n,r);var i=o(n);return null!==i?t(e,i,r):void 0}(t,i(e),arguments.length<3?void 0:u(arguments[2]))}})},function(t,e,n){var r=n(135),i=n(144),o=n(36),a=n(3),s=n(25),u=o.keys,l=o.key;o.exp({getMetadataKeys:function(t){return function t(e,n){var o=u(e,n),a=s(e);if(null===a)return o;var l=t(a,n);return l.length?o.length?i(new r(o.concat(l))):l:o}(a(t),arguments.length<2?void 0:l(arguments[1]))}})},function(t,e,n){var r=n(36),i=n(3),o=r.get,a=r.key;r.exp({getOwnMetadata:function(t,e){return o(t,i(e),arguments.length<3?void 0:a(arguments[2]))}})},function(t,e,n){var r=n(36),i=n(3),o=r.keys,a=r.key;r.exp({getOwnMetadataKeys:function(t){return o(i(t),arguments.length<2?void 0:a(arguments[1]))}})},function(t,e,n){var r=n(36),i=n(3),o=n(25),a=r.has,s=r.key;r.exp({hasMetadata:function(t,e){return function t(e,n,r){if(a(e,n,r))return!0;var i=o(n);return null!==i&&t(e,i,r)}(t,i(e),arguments.length<3?void 0:s(arguments[2]))}})},function(t,e,n){var r=n(36),i=n(3),o=r.has,a=r.key;r.exp({hasOwnMetadata:function(t,e){return o(t,i(e),arguments.length<3?void 0:a(arguments[2]))}})},function(t,e,n){var r=n(36),i=n(3),o=n(15),a=r.key,s=r.set;r.exp({metadata:function(t,e){return function(n,r){s(t,e,(void 0!==r?i:o)(n),a(r))}}})},function(t,e,n){var r=n(1),i=n(103)(),o=n(4).process,a="process"==n(28)(o);r(r.G,{asap:function(t){var e=a&&o.domain;i(e?e.bind(t):t)}})},function(t,e,n){"use strict";var r=n(1),i=n(4),o=n(26),a=n(103)(),s=n(8)("observable"),u=n(15),l=n(3),c=n(48),f=n(50),h=n(18),d=n(49),v=d.RETURN,p=function(t){return null==t?void 0:u(t)},y=function(t){var e=t._c;e&&(t._c=void 0,e())},g=function(t){return void 0===t._o},m=function(t){g(t)||(t._o=void 0,y(t))},b=function(t,e){l(t),this._c=void 0,this._o=t,t=new w(this);try{var n=e(t),r=n;null!=n&&("function"==typeof n.unsubscribe?n=function(){r.unsubscribe()}:u(n),this._c=n)}catch(e){return void t.error(e)}g(this)&&y(this)};b.prototype=f({},{unsubscribe:function(){m(this)}});var w=function(t){this._s=t};w.prototype=f({},{next:function(t){var e=this._s;if(!g(e)){var n=e._o;try{var r=p(n.next);if(r)return r.call(n,t)}catch(t){try{m(e)}finally{throw t}}}},error:function(t){var e=this._s;if(g(e))throw t;var n=e._o;e._o=void 0;try{var r=p(n.error);if(!r)throw t;t=r.call(n,t)}catch(t){try{y(e)}finally{throw t}}return y(e),t},complete:function(t){var e=this._s;if(!g(e)){var n=e._o;e._o=void 0;try{var r=p(n.complete);t=r?r.call(n,t):void 0}catch(t){try{y(e)}finally{throw t}}return y(e),t}}});var _=function(t){c(this,_,"Observable","_f")._f=u(t)};f(_.prototype,{subscribe:function(t){return new b(t,this._f)},forEach:function(t){var e=this;return new(o.Promise||i.Promise)(function(n,r){u(t);var i=e.subscribe({next:function(e){try{return t(e)}catch(t){r(t),i.unsubscribe()}},error:r,complete:n})})}}),f(_,{from:function(t){var e="function"==typeof this?this:_,n=p(l(t)[s]);if(n){var r=l(n.call(t));return r.constructor===e?r:new e(function(t){return r.subscribe(t)})}return new e(function(e){var n=!1;return a(function(){if(!n){try{if(d(t,!1,function(t){if(e.next(t),n)return v})===v)return}catch(t){if(n)throw t;return void e.error(t)}e.complete()}}),function(){n=!0}})},of:function(){for(var t=0,e=arguments.length,n=new Array(e);t<e;)n[t]=arguments[t++];return new("function"==typeof this?this:_)(function(t){var e=!1;return a(function(){if(!e){for(var r=0;r<n.length;++r)if(t.next(n[r]),e)return;t.complete()}}),function(){e=!0}})}}),h(_.prototype,s,function(){return this}),r(r.G,{Observable:_}),n(47)("Observable")},function(t,e,n){var r=n(4),i=n(1),o=n(72),a=[].slice,s=/MSIE .\./.test(o),u=function(t){return function(e,n){var r=arguments.length>2,i=!!r&&a.call(arguments,2);return t(r?function(){("function"==typeof e?e:Function(e)).apply(this,i)}:e,n)}};i(i.G+i.B+i.F*s,{setTimeout:u(r.setTimeout),setInterval:u(r.setInterval)})},function(t,e,n){var r=n(1),i=n(102);r(r.G+r.B,{setImmediate:i.set,clearImmediate:i.clear})},function(t,e,n){for(var r=n(99),i=n(43),o=n(19),a=n(4),s=n(18),u=n(55),l=n(8),c=l("iterator"),f=l("toStringTag"),h=u.Array,d={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},v=i(d),p=0;p<v.length;p++){var y,g=v[p],m=d[g],b=a[g],w=b&&b.prototype;if(w&&(w[c]||s(w,c,h),w[f]||s(w,f,g),u[g]=h,m))for(y in r)w[y]||o(w,y,r[y],!0)}},function(t,e,n){(function(t,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(t){"use strict";var r,i=Object.prototype,o=i.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag",c="object"===n(e),f=t.regeneratorRuntime;if(f)c&&(e.exports=f);else{(f=t.regeneratorRuntime=c?e.exports:{}).wrap=_;var h="suspendedStart",d="suspendedYield",v="executing",p="completed",y={},g={};g[s]=function(){return this};var m=Object.getPrototypeOf,b=m&&m(m(A([])));b&&b!==i&&o.call(b,s)&&(g=b);var w=T.prototype=k.prototype=Object.create(g);E.prototype=w.constructor=T,T.constructor=E,T[l]=E.displayName="GeneratorFunction",f.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===E||"GeneratorFunction"===(e.displayName||e.name))},f.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,T):(t.__proto__=T,l in t||(t[l]="GeneratorFunction")),t.prototype=Object.create(w),t},f.awrap=function(t){return{__await:t}},O(x.prototype),x.prototype[u]=function(){return this},f.AsyncIterator=x,f.async=function(t,e,n,r){var i=new x(_(t,e,n,r));return f.isGeneratorFunction(e)?i:i.next().then(function(t){return t.done?t.value:i.next()})},O(w),w[l]="Generator",w[s]=function(){return this},w.toString=function(){return"[object Generator]"},f.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},f.values=A,I.prototype={constructor:I,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(R),!t)for(var e in this)"t"===e.charAt(0)&&o.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=r)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(n,i){return s.type="throw",s.arg=t,e.next=n,i&&(e.method="next",e.arg=r),!!i}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var u=o.call(a,"catchLoc"),l=o.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&o.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),R(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;R(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:A(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=r),y}}}function _(t,e,n,r){var i=e&&e.prototype instanceof k?e:k,o=Object.create(i.prototype),a=new I(r||[]);return o._invoke=function(t,e,n){var r=h;return function(i,o){if(r===v)throw new Error("Generator is already running");if(r===p){if("throw"===i)throw o;return L()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=C(a,n);if(s){if(s===y)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===h)throw r=p,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=v;var u=S(t,e,n);if("normal"===u.type){if(r=n.done?p:d,u.arg===y)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r=p,n.method="throw",n.arg=u.arg)}}}(t,n,a),o}function S(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}function k(){}function E(){}function T(){}function O(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function x(e){function r(t,i,a,s){var u=S(e[t],e,i);if("throw"!==u.type){var l=u.arg,c=l.value;return c&&"object"===n(c)&&o.call(c,"__await")?Promise.resolve(c.__await).then(function(t){r("next",t,a,s)},function(t){r("throw",t,a,s)}):Promise.resolve(c).then(function(t){l.value=t,a(l)},s)}s(u.arg)}var i;"object"===n(t.process)&&t.process.domain&&(r=t.process.domain.bind(r)),this._invoke=function(t,e){function n(){return new Promise(function(n,i){r(t,e,n,i)})}return i=i?i.then(n,n):n()}}function C(t,e){var n=t.iterator[e.method];if(n===r){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=r,C(t,e),"throw"===e.method))return y;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return y}var i=S(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,y;var o=i.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=r),e.delegate=null,y):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,y)}function M(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function R(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(M,this),this.reset(!0)}function A(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(o.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=r,e.done=!0,e};return i.next=i}}return{next:L}}function L(){return{value:r,done:!0}}}("object"===(void 0===t?"undefined":n(t))?t:"object"===("undefined"==typeof window?"undefined":n(window))?window:"object"===("undefined"==typeof self?"undefined":n(self))?self:this)}).call(this,n(109),n(146)(t))},function(t,e,n){n(353),t.exports=n(26).RegExp.escape},function(t,e,n){var r=n(1),i=n(354)(/[\\^$*+?.()|[\]{}]/g,"\\$&");r(r.S,"RegExp",{escape:function(t){return i(t)}})},function(t,e){t.exports=function(t,e){var n=e===Object(e)?function(t){return e[t]}:e;return function(e){return String(e).replace(t,n)}}},function(t,e,n){"use strict";n.d(e,"a",function(){return _});var r=n(51),i=n(7),o=n(2),a=n(108),s=n(152),u=n(0),l=n(150),c=n(151);function f(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function h(t,e,n,r,i,o,a){try{var s=t[o](a),u=s.value}catch(t){return void n(t)}s.done?e(u):Promise.resolve(u).then(r,i)}function d(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(e){v(t,e,n[e])})}return t}function v(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function p(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function y(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function g(t,e,n){return e&&y(t.prototype,e),n&&y(t,n),t}var m=function(){function t(e,n,r){p(this,t),this.rowIndex=e,this.colIndex=n,this.sprites=r}return g(t,[{key:"getSprites",value:function(){return this.sprites}},{key:"getSpritesAsSet",value:function(){return new Set(this.sprites)}},{key:"getWantsToMove",value:function(){return u.d.STATIONARY}}]),t}(),b=new TextDecoder,w=new TextEncoder,_=function(){function t(e,n,r){var i=this;p(this,t),this.worker=e,this.table=n;r&&r.onMessage||(r=d({},r,{onMessage:function(t){return Object(u.j)(10,function(){return!i.inputWatcher.isSomethingPressed()&&(alert(t),!0)})}})),this.cellCache=[],this.levelNum=-123456,this.gameData=null,this.ui=new s.a(n,r),this.resizeWatcher=new c.a(n,this.handleResize.bind(this)),this.inputWatcher=new l.a(n),this.pause=this.pause.bind(this),this.resume=this.resume.bind(this),this.messageListener=this.messageListener.bind(this),this.pollInputWatcher=this.pollInputWatcher.bind(this),n.addEventListener("blur",this.pause),n.addEventListener("focus",this.resume),e.addEventListener("message",this.messageListener),this.inputInterval=window.setInterval(this.pollInputWatcher,10)}return g(t,[{key:"setGame",value:function(t,e,n){var r=w.encode(t).buffer;this.worker.postMessage({type:u.c.ON_GAME_CHANGE,code:r,level:e,checkpoint:n},[r])}},{key:"dispose",value:function(){this.inputWatcher.dispose(),this.resizeWatcher.dispose(),clearInterval(this.inputInterval)}},{key:"press",value:function(t){this.worker.postMessage({type:u.c.PRESS,button:t})}},{key:"pause",value:function(){this.worker.postMessage({type:u.c.PAUSE}),this.inputInterval&&clearInterval(this.inputInterval),this.inputInterval=0}},{key:"resume",value:function(){this.worker.postMessage({type:u.c.RESUME}),this.inputInterval||(this.inputInterval=window.setInterval(this.pollInputWatcher,10))}},{key:"resize",value:function(){this.resizeWatcher.trigger()}},{key:"pollInputWatcher",value:function(){var t=this.inputWatcher.pollControls();t&&this.press(t)}},{key:"getScreenDimensions",value:function(t){var e=this.getGameData().metadata;return e.flickscreen||e.zoomscreen||new r.a(t[0].length,t.length)}},{key:"messageListener",value:function(){var t,e=(t=regeneratorRuntime.mark(function t(e){var n,r,i,o,s,l=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=e.data,t.t0=n.type,t.next=t.t0===u.c.ON_GAME_CHANGE?4:t.t0===u.c.ON_LEVEL_CHANGE?8:t.t0===u.c.ON_MESSAGE?14:t.t0===u.c.ON_PRESS?19:t.t0===u.c.ON_TICK?21:t.t0===u.c.ON_SOUND?23:t.t0===u.c.ON_PAUSE?26:t.t0===u.c.ON_RESUME?28:t.t0===u.c.TICK?30:t.t0===u.c.PRESS?30:t.t0===u.c.PAUSE?30:t.t0===u.c.RESUME?30:31;break;case 4:return r=a.a.fromJson(JSON.parse(b.decode(n.payload)),"**source not included because of laziness**"),this.gameData=r,this.ui.onGameChange(r),t.abrupt("break",32);case 8:return this.cellCache=[],this.levelNum=n.level,n.cells?(this.ui.onLevelChange(n.level,n.cells.map(function(t){return t.map(function(t){return l.convertToCellish(t)})}),null),i=this.getScreenDimensions(n.cells),o=i.width,s=i.height,this.resizeWatcher.setLevel(s,o)):this.ui.onLevelChange(n.level,null,n.message),this.resizeWatcher.trigger(),this.table.focus(),t.abrupt("break",32);case 14:return t.next=16,this.ui.onMessage(n.message);case 16:return this.worker.postMessage({type:u.c.ON_MESSAGE_DONE}),this.table.focus(),t.abrupt("break",32);case 19:return this.ui.onPress(n.direction),t.abrupt("break",32);case 21:return this.ui.onTick(new Set(n.changedCells.map(function(t){return l.convertToCellish(t)})),n.checkpoint,n.hasAgain,this.convertToA11yMessages(n.a11yMessages)),t.abrupt("break",32);case 23:return t.next=25,this.ui.onSound({soundCode:n.soundCode});case 25:return t.abrupt("break",32);case 26:return this.ui.onPause(),t.abrupt("break",32);case 28:return this.ui.onResume(),t.abrupt("break",32);case 30:return t.abrupt("break",32);case 31:console.log('BUG: Unhandled Event occurred. Ignoring "'.concat(n.type,'"'),n);case 32:case"end":return t.stop()}},t,this)}),function(){var e=this,n=arguments;return new Promise(function(r,i){var o=t.apply(e,n);function a(t){h(o,r,i,a,s,"next",t)}function s(t){h(o,r,i,a,s,"throw",t)}a(void 0)})});return function(t){return e.apply(this,arguments)}}()},{key:"convertToA11yMessages",value:function(t){var e=this;return t.map(function(t){switch(t.type){case i.a.ADD:return d({},t,{cell:e.convertToCellish(t.cell),sprites:f(t.sprites).map(function(t){return e.lookupSprite(t)})});case i.a.MOVE:return d({},t,{oldCell:e.convertToCellish(t.oldCell),newCell:e.convertToCellish(t.newCell),sprite:e.lookupSprite(t.sprite)});case i.a.REMOVE:return d({},t,{cell:e.convertToCellish(t.cell),sprites:f(t.sprites).map(function(t){return e.lookupSprite(t)})});case i.a.REPLACE:return d({},t,{cell:e.convertToCellish(t.cell),replacements:f(t.replacements).map(function(t){var n=t.oldSprite,r=t.newSprite;return{oldSprite:e.lookupSprite(n),newSprite:e.lookupSprite(r)}})})}})}},{key:"lookupSprite",value:function(t){var e=this.getGameData()._getSpriteByName(t);if(!e)throw new Error('Could not find sprite "'.concat(t,'"'));return e}},{key:"convertToCellish",value:function(t){var e=this,n=t.rowIndex,r=t.colIndex,i=t.spriteNames;this.cellCache[n]||(this.cellCache[n]=[]),this.cellCache[n][r]||(this.cellCache[n][r]=new m(n,r,[]));var o=this.cellCache[n][r];return o.sprites=i.map(function(t){return e.lookupSprite(t)}),o}},{key:"getGameData",value:function(){if(!this.gameData)throw new Error("BUG: Game Data has not been retreived from the worker yet");return this.gameData}},{key:"isCurrentLevelAMessage",value:function(){return this.getGameData().levels[this.levelNum].type===o.d.MESSAGE}},{key:"handleResize",value:function(t){this.isCurrentLevelAMessage()||this.table.setAttribute("style","width: ".concat(t,"px;"))}}]),t}()},,,,,function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function o(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}
/**
 * Seedable random number generator functions.
 * @version 1.0.0
 * @license Public Domain
 *
 * @example
 * var rng = new RNG('Example');
 * rng.random(40, 50);  // =>  42
 * rng.uniform();       // =>  0.7972798995050903
 * rng.normal();        // => -0.6698504543216376
 * rng.exponential();   // =>  1.0547367609131555
 * rng.poisson(4);      // =>  2
 * rng.gamma(4);        // =>  2.781724687386858
 */n.r(e),n.d(e,"RNG",function(){return s});var a=function(){function t(e){r(this,t),this.s=new Array(256),this.i=0,this.j=0;for(var n=0;n<256;n++)this.s[n]=n;e&&this.mix(e)}return o(t,[{key:"_swap",value:function(t,e){var n=this.s[t];this.s[t]=this.s[e],this.s[e]=n}},{key:"mix",value:function(t){for(var e=function(t){for(var e=[],n=0;n<t.length;n++){var r=t.charCodeAt(n),i=[];do{i.push(255&r),r>>=8}while(r>0);e=e.concat(i.reverse())}return e}(t),n=0,r=0;r<this.s.length;r++)n+=this.s[r]+e[r%e.length],n%=256,this._swap(r,n)}},{key:"next",value:function(){return this.i=(this.i+1)%256,this.j=(this.j+this.s[this.i])%256,this._swap(this.i,this.j),this.s[(this.s[this.i]+this.s[this.j])%256]}}]),t}(),s=function(){function t(e){r(this,t),this._normal=null,this._state=new a(JSON.stringify(e))}return o(t,[{key:"nextByte",value:function(){return this._state.next()}},{key:"uniform",value:function(){for(var t=0,e=0;e<7;e++)t*=256,t+=this.nextByte();return t/(Math.pow(2,56)-1)}},{key:"random",value:function(t,e){return null===t?this.uniform():(null===e&&(e=t,t=0),t+Math.floor(this.uniform()*(e-t)))}},{key:"normal",value:function(){if(null!==this._normal){var t=this._normal;return this._normal=null,t}var e=this.uniform()||Math.pow(2,-53),n=this.uniform();return this._normal=Math.sqrt(-2*Math.log(e))*Math.sin(2*Math.PI*n),Math.sqrt(-2*Math.log(e))*Math.cos(2*Math.PI*n)}},{key:"exponential",value:function(){return-Math.log(this.uniform()||Math.pow(2,-53))}},{key:"poisson",value:function(t){var e=Math.exp(-(t||1)),n=0,r=1;do{n++,r*=this.uniform()}while(r>e);return n-1}}]),t}()},function(t,e,n){"use strict";n.r(e),n.d(e,"MakeRiff",function(){return u}),n.d(e,"FastBase64_Encode",function(){return o});var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i=[];function o(t){for(var e,n=t.length,o="",a=0;n>2;)e=t[a]<<16|t[a+1]<<8|t[a+2],o+=i[e>>12]+i[4095&e],n-=3,a+=3;if(n>0){var s=(252&t[a])>>2,u=(3&t[a])<<4;if(n>1&&(u|=(240&t[++a])>>4),o+=r[s],o+=r[u],2===n){var l=(15&t[a++])<<2;l|=(192&t[a])>>6,o+=r[l]}1===n&&(o+="="),o+="="}return o}function a(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]}function s(t){return[255&t,t>>8&255]}function u(t,e,n){var r,i={audioFormat:1,bitsPerSample:e,blockAlign:0,byteRate:0,chunkId:[82,73,70,70],chunkSize:0,format:[87,65,86,69],numChannels:1,sampleRate:t,subChunk1Id:[102,109,116,32],subChunk1Size:16,subChunk2Id:[100,97,116,97],subChunk2Size:0};return i.byteRate=i.sampleRate*i.numChannels*i.bitsPerSample>>3,i.blockAlign=i.numChannels*i.bitsPerSample>>3,i.subChunk2Size=n.length,i.chunkSize=36+i.subChunk2Size,{dat:[],dataURI:"data:audio/wav;base64,"+o(r=i.chunkId.concat(a(i.chunkSize),i.format,i.subChunk1Id,a(i.subChunk1Size),s(i.audioFormat),s(i.numChannels),a(i.sampleRate),a(i.byteRate),s(i.blockAlign),s(i.bitsPerSample),i.subChunk2Id,a(i.subChunk2Size),n)),header:i,wav:r}}!function(){for(var t=0;t<4096;t++)i[t]=r[t>>6]+r[63&t]}()},function(t,e,n){(function(t){var r;function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(){var o=window.CustomEvent;function a(t){for(;t;){if("dialog"===t.localName)return t;t=t.parentElement}return null}function s(t){t&&t.blur&&t!==document.body&&t.blur()}function u(t,e){for(var n=0;n<t.length;++n)if(t[n]===e)return!0;return!1}function l(t){return!(!t||!t.hasAttribute("method"))&&"dialog"===t.getAttribute("method").toLowerCase()}function c(t){if(this.dialog_=t,this.replacedStyleTop_=!1,this.openAsModal_=!1,t.hasAttribute("role")||t.setAttribute("role","dialog"),t.show=this.show.bind(this),t.showModal=this.showModal.bind(this),t.close=this.close.bind(this),"returnValue"in t||(t.returnValue=""),"MutationObserver"in window){new MutationObserver(this.maybeHideModal.bind(this)).observe(t,{attributes:!0,attributeFilter:["open"]})}else{var e,n=!1,r=function(){n?this.downgradeModal():this.maybeHideModal(),n=!1}.bind(this),i=function(i){if(i.target===t){var o="DOMNodeRemoved";n|=i.type.substr(0,o.length)===o,window.clearTimeout(e),e=window.setTimeout(r,0)}};["DOMAttrModified","DOMNodeRemoved","DOMNodeRemovedFromDocument"].forEach(function(e){t.addEventListener(e,i)})}Object.defineProperty(t,"open",{set:this.setOpen.bind(this),get:t.hasAttribute.bind(t,"open")}),this.backdrop_=document.createElement("div"),this.backdrop_.className="backdrop",this.backdrop_.addEventListener("click",this.backdropClick_.bind(this))}o&&"object"!==i(o)||((o=function(t,e){e=e||{};var n=document.createEvent("CustomEvent");return n.initCustomEvent(t,!!e.bubbles,!!e.cancelable,e.detail||null),n}).prototype=window.Event.prototype),c.prototype={get dialog(){return this.dialog_},maybeHideModal:function(){this.dialog_.hasAttribute("open")&&document.body.contains(this.dialog_)||this.downgradeModal()},downgradeModal:function(){this.openAsModal_&&(this.openAsModal_=!1,this.dialog_.style.zIndex="",this.replacedStyleTop_&&(this.dialog_.style.top="",this.replacedStyleTop_=!1),this.backdrop_.parentNode&&this.backdrop_.parentNode.removeChild(this.backdrop_),f.dm.removeDialog(this))},setOpen:function(t){t?this.dialog_.hasAttribute("open")||this.dialog_.setAttribute("open",""):(this.dialog_.removeAttribute("open"),this.maybeHideModal())},backdropClick_:function(t){if(this.dialog_.hasAttribute("tabindex"))this.dialog_.focus();else{var e=document.createElement("div");this.dialog_.insertBefore(e,this.dialog_.firstChild),e.tabIndex=-1,e.focus(),this.dialog_.removeChild(e)}var n=document.createEvent("MouseEvents");n.initMouseEvent(t.type,t.bubbles,t.cancelable,window,t.detail,t.screenX,t.screenY,t.clientX,t.clientY,t.ctrlKey,t.altKey,t.shiftKey,t.metaKey,t.button,t.relatedTarget),this.dialog_.dispatchEvent(n),t.stopPropagation()},focus_:function(){var t=this.dialog_.querySelector("[autofocus]:not([disabled])");if(!t&&this.dialog_.tabIndex>=0&&(t=this.dialog_),!t){var e=["button","input","keygen","select","textarea"].map(function(t){return t+":not([disabled])"});e.push('[tabindex]:not([disabled]):not([tabindex=""])'),t=this.dialog_.querySelector(e.join(", "))}s(document.activeElement),t&&t.focus()},updateZIndex:function(t,e){if(t<e)throw new Error("dialogZ should never be < backdropZ");this.dialog_.style.zIndex=t,this.backdrop_.style.zIndex=e},show:function(){this.dialog_.open||(this.setOpen(!0),this.focus_())},showModal:function(){if(this.dialog_.hasAttribute("open"))throw new Error("Failed to execute 'showModal' on dialog: The element is already open, and therefore cannot be opened modally.");if(!document.body.contains(this.dialog_))throw new Error("Failed to execute 'showModal' on dialog: The element is not in a Document.");if(!f.dm.pushDialog(this))throw new Error("Failed to execute 'showModal' on dialog: There are too many open modal dialogs.");(function(t){for(;t&&t!==document.body;){var e=window.getComputedStyle(t),n=function(t,n){return!(void 0===e[t]||e[t]===n)};if(e.opacity<1||n("zIndex","auto")||n("transform","none")||n("mixBlendMode","normal")||n("filter","none")||n("perspective","none")||"isolate"===e.isolation||"fixed"===e.position||"touch"===e.webkitOverflowScrolling)return!0;t=t.parentElement}return!1})(this.dialog_.parentElement)&&console.warn("A dialog is being shown inside a stacking context. This may cause it to be unusable. For more information, see this link: https://github.com/GoogleChrome/dialog-polyfill/#stacking-context"),this.setOpen(!0),this.openAsModal_=!0,f.needsCentering(this.dialog_)?(f.reposition(this.dialog_),this.replacedStyleTop_=!0):this.replacedStyleTop_=!1,this.dialog_.parentNode.insertBefore(this.backdrop_,this.dialog_.nextSibling),this.focus_()},close:function(t){if(!this.dialog_.hasAttribute("open"))throw new Error("Failed to execute 'close' on dialog: The element does not have an 'open' attribute, and therefore cannot be closed.");this.setOpen(!1),void 0!==t&&(this.dialog_.returnValue=t);var e=new o("close",{bubbles:!1,cancelable:!1});this.dialog_.dispatchEvent(e)}};var f={reposition:function(t){var e=document.body.scrollTop||document.documentElement.scrollTop,n=e+(window.innerHeight-t.offsetHeight)/2;t.style.top=Math.max(e,n)+"px"},isInlinePositionSetByStylesheet:function(t){for(var e=0;e<document.styleSheets.length;++e){var n=document.styleSheets[e],r=null;try{r=n.cssRules}catch(t){}if(r)for(var i=0;i<r.length;++i){var o=r[i],a=null;try{a=document.querySelectorAll(o.selectorText)}catch(t){}if(a&&u(a,t)){var s=o.style.getPropertyValue("top"),l=o.style.getPropertyValue("bottom");if(s&&"auto"!==s||l&&"auto"!==l)return!0}}}return!1},needsCentering:function(t){return"absolute"===window.getComputedStyle(t).position&&(!("auto"!==t.style.top&&""!==t.style.top||"auto"!==t.style.bottom&&""!==t.style.bottom)&&!f.isInlinePositionSetByStylesheet(t))},forceRegisterDialog:function(t){if((window.HTMLDialogElement||t.showModal)&&console.warn("This browser already supports <dialog>, the polyfill may not work correctly",t),"dialog"!==t.localName)throw new Error("Failed to register dialog: The element is not a dialog.");new c(t)},registerDialog:function(t){t.showModal||f.forceRegisterDialog(t)},DialogManager:function(){this.pendingDialogStack=[];var t=this.checkDOM_.bind(this);this.overlay=document.createElement("div"),this.overlay.className="_dialog_overlay",this.overlay.addEventListener("click",function(e){this.forwardTab_=void 0,e.stopPropagation(),t([])}.bind(this)),this.handleKey_=this.handleKey_.bind(this),this.handleFocus_=this.handleFocus_.bind(this),this.zIndexLow_=1e5,this.zIndexHigh_=100150,this.forwardTab_=void 0,"MutationObserver"in window&&(this.mo_=new MutationObserver(function(e){var n=[];e.forEach(function(t){for(var e,r=0;e=t.removedNodes[r];++r)e instanceof Element&&("dialog"===e.localName&&n.push(e),n=n.concat(e.querySelectorAll("dialog")))}),n.length&&t(n)}))}};if(f.DialogManager.prototype.blockDocument=function(){document.documentElement.addEventListener("focus",this.handleFocus_,!0),document.addEventListener("keydown",this.handleKey_),this.mo_&&this.mo_.observe(document,{childList:!0,subtree:!0})},f.DialogManager.prototype.unblockDocument=function(){document.documentElement.removeEventListener("focus",this.handleFocus_,!0),document.removeEventListener("keydown",this.handleKey_),this.mo_&&this.mo_.disconnect()},f.DialogManager.prototype.updateStacking=function(){for(var t,e=this.zIndexHigh_,n=0;t=this.pendingDialogStack[n];++n)t.updateZIndex(--e,--e),0===n&&(this.overlay.style.zIndex=--e);var r=this.pendingDialogStack[0];r?(r.dialog.parentNode||document.body).appendChild(this.overlay):this.overlay.parentNode&&this.overlay.parentNode.removeChild(this.overlay)},f.DialogManager.prototype.containedByTopDialog_=function(t){for(;t=a(t);){for(var e,n=0;e=this.pendingDialogStack[n];++n)if(e.dialog===t)return 0===n;t=t.parentElement}return!1},f.DialogManager.prototype.handleFocus_=function(t){if(!this.containedByTopDialog_(t.target)&&(t.preventDefault(),t.stopPropagation(),s(t.target),void 0!==this.forwardTab_)){var e=this.pendingDialogStack[0];return e.dialog.compareDocumentPosition(t.target)&Node.DOCUMENT_POSITION_PRECEDING&&(this.forwardTab_?e.focus_():document.documentElement.focus()),!1}},f.DialogManager.prototype.handleKey_=function(t){if(this.forwardTab_=void 0,27===t.keyCode){t.preventDefault(),t.stopPropagation();var e=new o("cancel",{bubbles:!1,cancelable:!0}),n=this.pendingDialogStack[0];n&&n.dialog.dispatchEvent(e)&&n.dialog.close()}else 9===t.keyCode&&(this.forwardTab_=!t.shiftKey)},f.DialogManager.prototype.checkDOM_=function(t){this.pendingDialogStack.slice().forEach(function(e){-1!==t.indexOf(e.dialog)?e.downgradeModal():e.maybeHideModal()})},f.DialogManager.prototype.pushDialog=function(t){var e=(this.zIndexHigh_-this.zIndexLow_)/2-1;return!(this.pendingDialogStack.length>=e)&&(1===this.pendingDialogStack.unshift(t)&&this.blockDocument(),this.updateStacking(),!0)},f.DialogManager.prototype.removeDialog=function(t){var e=this.pendingDialogStack.indexOf(t);-1!==e&&(this.pendingDialogStack.splice(e,1),0===this.pendingDialogStack.length&&this.unblockDocument(),this.updateStacking())},f.dm=new f.DialogManager,f.formSubmitter=null,f.useValue=null,void 0===window.HTMLDialogElement){var h=document.createElement("form");if(h.setAttribute("method","dialog"),"dialog"!==h.method){var d=Object.getOwnPropertyDescriptor(HTMLFormElement.prototype,"method");if(d){var v=d.get;d.get=function(){return l(this)?"dialog":v.call(this)};var p=d.set;d.set=function(t){return"string"==typeof t&&"dialog"===t.toLowerCase()?this.setAttribute("method",t):p.call(this,t)},Object.defineProperty(HTMLFormElement.prototype,"method",d)}}document.addEventListener("click",function(t){if(f.formSubmitter=null,f.useValue=null,!t.defaultPrevented){var e=t.target;if(e&&l(e.form)){if(!("submit"===e.type&&["button","input"].indexOf(e.localName)>-1)){if("input"!==e.localName||"image"!==e.type)return;f.useValue=t.offsetX+","+t.offsetY}a(e)&&(f.formSubmitter=e)}}},!1);var y=HTMLFormElement.prototype.submit;HTMLFormElement.prototype.submit=function(){if(!l(this))return y.call(this);var t=a(this);t&&t.close()},document.addEventListener("submit",function(t){var e=t.target;if(l(e)){t.preventDefault();var n=a(e);if(n){var r=f.formSubmitter;r&&r.form===e?n.close(f.useValue||r.value):n.close(),f.formSubmitter=null}}},!0)}f.forceRegisterDialog=f.forceRegisterDialog,f.registerDialog=f.registerDialog,"amd"in n(364)?void 0===(r=function(){return f}.call(e,n,e,t))||(t.exports=r):"object"===i(t)&&"object"===i(t.exports)?t.exports=f:window.dialogPolyfill=f}()}).call(this,n(146)(t))},function(t,e,n){var r=n(365);t.exports={locale:r.locale,long:r.long,short:r.short,narrow:r.narrow,"short-time":n(370),"short-convenient":n(371),"long-time":n(372),"long-convenient":n(373),tiny:n(374),quantify:r.quantify}},function(t,e){t.exports=function(){throw new Error("define cannot be used indirect")}},function(t,e,n){t.exports={locale:"en",long:n(366),short:n(367),narrow:n(368),quantify:n(369)}},function(t){t.exports={year:{previous:"last year",current:"this year",next:"next year",past:{one:"{0} year ago",other:"{0} years ago"},future:{one:"in {0} year",other:"in {0} years"}},quarter:{previous:"last quarter",current:"this quarter",next:"next quarter",past:{one:"{0} quarter ago",other:"{0} quarters ago"},future:{one:"in {0} quarter",other:"in {0} quarters"}},month:{previous:"last month",current:"this month",next:"next month",past:{one:"{0} month ago",other:"{0} months ago"},future:{one:"in {0} month",other:"in {0} months"}},week:{previous:"last week",current:"this week",next:"next week",past:{one:"{0} week ago",other:"{0} weeks ago"},future:{one:"in {0} week",other:"in {0} weeks"}},day:{previous:"yesterday",current:"today",next:"tomorrow",past:{one:"{0} day ago",other:"{0} days ago"},future:{one:"in {0} day",other:"in {0} days"}},hour:{current:"this hour",past:{one:"{0} hour ago",other:"{0} hours ago"},future:{one:"in {0} hour",other:"in {0} hours"}},minute:{current:"this minute",past:{one:"{0} minute ago",other:"{0} minutes ago"},future:{one:"in {0} minute",other:"in {0} minutes"}},second:{current:"now",past:{one:"{0} second ago",other:"{0} seconds ago"},future:{one:"in {0} second",other:"in {0} seconds"}}}},function(t){t.exports={year:{previous:"last yr.",current:"this yr.",next:"next yr.",past:"{0} yr. ago",future:"in {0} yr."},quarter:{previous:"last qtr.",current:"this qtr.",next:"next qtr.",past:{one:"{0} qtr. ago",other:"{0} qtrs. ago"},future:{one:"in {0} qtr.",other:"in {0} qtrs."}},month:{previous:"last mo.",current:"this mo.",next:"next mo.",past:"{0} mo. ago",future:"in {0} mo."},week:{previous:"last wk.",current:"this wk.",next:"next wk.",past:"{0} wk. ago",future:"in {0} wk."},day:{previous:"yesterday",current:"today",next:"tomorrow",past:{one:"{0} day ago",other:"{0} days ago"},future:{one:"in {0} day",other:"in {0} days"}},hour:{current:"this hour",past:"{0} hr. ago",future:"in {0} hr."},minute:{current:"this minute",past:"{0} min. ago",future:"in {0} min."},second:{current:"now",past:"{0} sec. ago",future:"in {0} sec."}}},function(t){t.exports={year:{previous:"last yr.",current:"this yr.",next:"next yr.",past:"{0} yr. ago",future:"in {0} yr."},quarter:{previous:"last qtr.",current:"this qtr.",next:"next qtr.",past:{one:"{0} qtr. ago",other:"{0} qtrs. ago"},future:{one:"in {0} qtr.",other:"in {0} qtrs."}},month:{previous:"last mo.",current:"this mo.",next:"next mo.",past:"{0} mo. ago",future:"in {0} mo."},week:{previous:"last wk.",current:"this wk.",next:"next wk.",past:"{0} wk. ago",future:"in {0} wk."},day:{previous:"yesterday",current:"today",next:"tomorrow",past:{one:"{0} day ago",other:"{0} days ago"},future:{one:"in {0} day",other:"in {0} days"}},hour:{current:"this hour",past:"{0} hr. ago",future:"in {0} hr."},minute:{current:"this minute",past:"{0} min. ago",future:"in {0} min."},second:{current:"now",past:"{0} sec. ago",future:"in {0} sec."}}},function(t,e){t.exports=function(t){var e=!String(t).split(".")[1];return 1==t&&e?"one":"other"}},function(t){t.exports={year:"{0} yr.",month:"{0} mo.",week:"{0} wk.",day:{one:"{0} day",other:"{0} days"},hour:"{0} hr.",minute:"{0} min.",second:"{0} sec.",now:"now"}},function(t){t.exports={year:{previous:"last yr.",current:"this yr.",next:"next yr.",past:"{0} yr. ago",future:"in {0} yr."},quarter:{previous:"last qtr.",current:"this qtr.",next:"next qtr.",past:{one:"{0} qtr. ago",other:"{0} qtrs. ago"},future:{one:"in {0} qtr.",other:"in {0} qtrs."}},month:{previous:"last mo.",current:"this mo.",next:"next mo.",past:"{0} mo. ago",future:"in {0} mo."},week:{previous:"last wk.",current:"this wk.",next:"next wk.",past:"{0} wk. ago",future:"in {0} wk."},day:{previous:"yesterday",current:"today",next:"tomorrow",past:{one:"{0} day ago",other:"{0} days ago"},future:{one:"in {0} day",other:"in {0} days"}},hour:{current:"this hour",past:"{0} hr. ago",future:"in {0} hr."},minute:{current:"this minute",past:"{0} min. ago",future:"in {0} min."},second:{current:"now",past:"{0} sec. ago",future:"in {0} sec."},now:{future:"in a moment",past:"just now"}}},function(t){t.exports={year:{one:"{0} year",other:"{0} years"},month:{one:"{0} month",other:"{0} months"},week:{one:"{0} week",other:"{0} weeks"},day:{one:"{0} day",other:"{0} days"},hour:{one:"{0} hour",other:"{0} hours"},minute:{one:"{0} minute",other:"{0} minutes"},second:{one:"{0} second",other:"{0} seconds"},now:{future:"in a moment",past:"just now"}}},function(t){t.exports={year:{previous:"last year",current:"this year",next:"next year",past:{one:"a year ago",other:"{0} years ago"},future:{one:"in a year",other:"in {0} years"}},quarter:{previous:"last quarter",current:"this quarter",next:"next quarter",past:{one:"a quarter ago",other:"{0} quarters ago"},future:{one:"in a quarter",other:"in {0} quarters"}},month:{previous:"last month",current:"this month",next:"next month",past:{one:"a month ago",other:"{0} months ago"},future:{one:"in a month",other:"in {0} months"}},week:{previous:"last week",current:"this week",next:"next week",past:{one:"a week ago",other:"{0} weeks ago"},future:{one:"in a week",other:"in {0} weeks"}},day:{previous:"yesterday",current:"today",next:"tomorrow",past:{one:"a day ago",other:"{0} days ago"},future:{one:"in a day",other:"in {0} days"}},hour:{current:"this hour",past:{one:"an hour ago",other:"{0} hours ago"},future:{one:"in an hour",other:"in {0} hours"}},minute:{current:"this minute",past:{one:"a minute ago",other:"{0} minutes ago"},future:{one:"in a minute",other:"in {0} minutes"}},second:{current:"now",past:{one:"a second ago",other:"{0} seconds ago"},future:{one:"in a second",other:"in {0} seconds"}},now:{future:"in a moment",past:"just now"}}},function(t){t.exports={year:"{0}yr",month:"{0}mo",week:"{0}wk",day:"{0}d",hour:"{0}h",minute:"{0}m",second:"{0}s",now:"now"}},,function(t,e,n){"use strict";n.r(e);n(154);var r=n(362),i="en",o={};function a(){return i}function s(t){return o[t]}function u(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).localeMatcher||"lookup";switch(e){case"lookup":case"best fit":return l(t);default:throw new RangeError('Invalid "localeMatcher" option: '.concat(e))}}function l(t){if(s(t))return t;for(var e=t.split("-");t.length>1;)if(e.pop(),s(t=e.join("-")))return t}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function f(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var h=["second","minute","hour","day","week","month","quarter","year"],d=["auto","always"],v=["long","short","narrow"],p=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),f(this,"numeric","always"),f(this,"style","long"),f(this,"localeMatcher","lookup");var r=n.numeric,i=n.style,o=n.localeMatcher;if(r){if(d.indexOf(r)<0)throw new RangeError('Invalid "numeric" option: '.concat(r));this.numeric=r}if(i){if(v.indexOf(i)<0)throw new RangeError('Invalid "style" option: '.concat(i));this.style=i}if(o&&(this.localeMatcher=o),"string"==typeof e&&(e=[e]),e.push(a()),this.locale=t.supportedLocalesOf(e,{localeMatcher:this.localeMatcher})[0],!this.locale)throw new TypeError("No supported locale was found");this.locale=u(this.locale,{localeMatcher:this.localeMatcher}),"undefined"!=typeof Intl&&Intl.NumberFormat&&(this.numberFormat=new Intl.NumberFormat(this.locale))}var e,n,r;return e=t,(n=[{key:"format",value:function(t,e){return this.getRule(t,e).replace("{0}",this.formatNumber(Math.abs(t)))}},{key:"formatToParts",value:function(t,e){var n=this.getRule(t,e),r=n.indexOf("{0}");if(r<0)return[{type:"literal",value:n}];var i=[];return r>0&&i.push({type:"literal",value:n.slice(0,r)}),i.push({unit:e,type:"integer",value:this.formatNumber(Math.abs(t))}),r+"{0}".length<n.length-1&&i.push({type:"literal",value:n.slice(r+"{0}".length)}),i}},{key:"getRule",value:function(t,e){if(h.indexOf(e)<0)throw new RangeError("Unknown time unit: ".concat(e,"."));var n=s(this.locale)[this.style][e];if("auto"===this.numeric)if(-2===t||-1===t){var r=n["previous".concat(-1===t?"":"-"+Math.abs(t))];if(r)return r}else if(1===t||2===t){var i=n["next".concat(1===t?"":"-"+Math.abs(t))];if(i)return i}else if(0===t&&n.current)return n.current;var o=n[t<=0?"past":"future"];if("string"==typeof o)return o;var a=s(this.locale).quantify,u=a&&a(Math.abs(t));return o[u=u||"other"]||o.other}},{key:"formatNumber",value:function(t){return this.numberFormat?this.numberFormat.format(t):String(t)}},{key:"resolvedOptions",value:function(){return{locale:this.locale,style:this.style,numeric:this.numeric}}}])&&c(e.prototype,n),r&&c(e,r),t}();function y(t){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function g(t){return(g="function"==typeof Symbol&&"symbol"===y(Symbol.iterator)?function(t){return y(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":y(t)})(t)}function m(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}p.supportedLocalesOf=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"string"==typeof t&&(t=[t]),t.filter(function(t){return u(t,e)})},p.addLocale=function(t){if(!t)throw new Error("No locale data passed");o[t.locale]=t},p.setDefaultLocale=function(t){i=t},p.getDefaultLocale=a;var b=function(){function t(){var e,n,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),r={},(n="cache")in(e=this)?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r}var e,n,r;return e=t,(n=[{key:"get",value:function(){for(var t=this.cache,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];for(var i=0;i<n.length;i++){var o=n[i];if("object"!==g(t))return;t=t[o]}return t}},{key:"put",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=e.pop(),i=e.pop(),o=this.cache,a=0;a<e.length;a++){var s=e[a];"object"!==g(o[s])&&(o[s]={}),o=o[s]}return o[i]=r}}])&&m(e.prototype,n),r&&m(e,r),t}(),w=86400;function _(t,e){var n=t,r=Array.isArray(n),i=0;for(n=r?n:n[Symbol.iterator]();;){var o;if(r){if(i>=n.length)break;o=n[i++]}else{if((i=n.next()).done)break;o=i.value}var a=o;if(a.unit===e)return a}}function S(t){return t instanceof Date?t:new Date(t)}var k=[{factor:1,unit:"now"},{threshold:1,threshold_for_now:45,factor:1,unit:"second"},{threshold:45,factor:60,unit:"minute"},{threshold:150,factor:60,granularity:5,unit:"minute"},{threshold:1350,factor:1800,unit:"half-hour"},{threshold:2550,threshold_for_minute:3150,factor:3600,unit:"hour"},{threshold:73800,factor:w,unit:"day"},{threshold:475200,factor:7*w,unit:"week"},{threshold:2116800,factor:2630016,unit:"month"},{threshold:27615168,factor:31556952,unit:"year"}];function E(t){return(E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function T(t){return(T="function"==typeof Symbol&&"symbol"===E(Symbol.iterator)?function(t){return E(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":E(t)})(t)}function O(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:k;if(0!==(r=function(t,e){return t.filter(function(t){var n=t.unit;return!n||e.indexOf(n)>=0})}(r,n)).length){var i=function t(e,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(e<function(t,e,n){var r;t&&(t.id||t.unit)&&(r=e["threshold_for_".concat(t.id||t.unit)]);void 0===r&&(r=e.threshold);"function"==typeof r&&(r=r(n));if(t&&"number"!=typeof r){var i=T(r);throw new Error('Each step of a gradation must have a threshold defined except for the first one. Got "'.concat(r,'", ').concat(i,". Step: ").concat(JSON.stringify(e)))}return r}(r[i-1],r[i],n))return i-1;if(i===r.length-1)return i;return t(e,n,r,i+1)}(t,e,r),o=r[i];if(-1!==i){if(o.granularity)if(0===Math.round(t/o.factor/o.granularity)*o.granularity&&i>0)return r[i-1];return o}}}function x(t){return(x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function C(t){return(C="function"==typeof Symbol&&"symbol"===x(Symbol.iterator)?function(t){return x(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":x(t)})(t)}function M(){return"object"===("undefined"==typeof Intl?"undefined":C(Intl))&&"function"==typeof Intl.DateTimeFormat}var R={gradation:k,flavour:["long-convenient","long"],units:["now","minute","hour","day","week","month","year"]},I=[{factor:1,unit:"now"},{threshold:.5,factor:1,unit:"second"},{threshold:59.5,factor:60,unit:"minute"},{threshold:3570,factor:3600,unit:"hour"},{threshold:84600,factor:w,unit:"day"},{threshold:561600,factor:7*w,unit:"week"},{threshold:2116800,factor:2630016,unit:"month"},{threshold:30245184,factor:31556952,unit:"year"}];function A(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var L={},P={gradation:[function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(e){A(t,e,n[e])})}return t}({},_(I,"minute"),{threshold:45}),_(I,"hour"),{threshold:84600,format:function(t,e){if(M())return L[e]||(L[e]={}),L[e].this_year||(L[e].this_year=new Intl.DateTimeFormat(e,{month:"short",day:"numeric"})),L[e].this_year.format(S(t))}},{threshold:function(t){return(new Date(new Date(t).getFullYear()+1,0).getTime()-t)/1e3},format:function(t,e){if(M())return L[e]||(L[e]={}),L[e].other||(L[e].other=new Intl.DateTimeFormat(e,{year:"numeric",month:"short",day:"numeric"})),L[e].other.format(S(t))}}],flavour:["tiny","short-time","narrow","short"]},N={gradation:k,flavour:"long-time",units:["now","minute","hour","day","week","month","year"]},D={};function G(t){return D[t]}function B(t){return(B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function F(t){return(F="function"==typeof Symbol&&"symbol"===B(Symbol.iterator)?function(t){return B(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":B(t)})(t)}function j(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var U=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),"string"==typeof e&&(e=[e]),this.locale=function(t,e){var n=t,r=Array.isArray(n),i=0;for(n=r?n:n[Symbol.iterator]();;){var o;if(r){if(i>=n.length)break;o=n[i++]}else{if((i=n.next()).done)break;o=i.value}var a=o;if(e(a))return a;for(var s=a.split("-");s.length>1;)if(s.pop(),e(a=s.join("-")))return a}throw new Error("No locale data has been registered for any of the locales: ".concat(t.join(", ")))}(e.concat(p.getDefaultLocale()),G),"undefined"!=typeof Intl&&Intl.NumberFormat&&(this.numberFormat=new Intl.NumberFormat(this.locale)),this.relativeTimeFormatCache=new b}var e,n,r;return e=t,(n=[{key:"format",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:R;if("string"==typeof e)switch(e){case"twitter":e=P;break;case"time":e=N;break;default:e=R}var n=function(t){if(t.constructor===Date)return{date:t,time:t.getTime()};if("number"==typeof t)return{time:t};throw new Error("Unsupported relative time formatter input: ".concat(F(t),", ").concat(t))}(t),r=n.date,i=n.time,o=this.getLocaleData(e.flavour),a=o.flavour,s=o.localeData,u=e.now||Date.now(),l=(u-i)/1e3;if(e.custom){var c=e.custom({now:u,date:r,time:i,elapsed:l,locale:this.locale});if(void 0!==c)return c}var f=function(t,e){var n=Object.keys(t);e&&(n=e.filter(function(t){return n.indexOf(t)>=0}));(!e||e.indexOf("now")>=0)&&n.indexOf("now")<0&&t.second.current&&n.unshift("now");return n}(s,e.units);if(0===f.length)return console.error('Units "'.concat(f.join(", "),'" were not found in locale data for "').concat(this.locale,'".')),"";var h=O(Math.abs(l),u,f,e.gradation);if(!h)return"";if(h.format)return h.format(r||i,this.locale);var d=h.unit,v=h.factor,p=h.granularity,y=Math.abs(l)/v;if(p&&(y=Math.round(y/p)*p),"now"===d)return function(t,e){if(t.now)return"string"==typeof t.now?t.now:e<=0?t.now.past:t.now.future;return t.second.current}(s,-1*Math.sign(l));switch(a){case"long":case"short":case"narrow":return this.getFormatter(a).format(-1*Math.sign(l)*Math.round(y),d);default:return this.formatValue(-1*Math.sign(l)*Math.round(y),d,s)}}},{key:"formatValue",value:function(t,e,n){return this.getRule(t,e,n).replace("{0}",this.formatNumber(Math.abs(t)))}},{key:"getRule",value:function(t,e,n){var r=n[e];if("string"==typeof r)return r;var i=r[t<=0?"past":"future"]||r;if("string"==typeof i)return i;var o=G(this.locale).quantify,a=o&&o(Math.abs(t));return i[a=a||"other"]||i.other}},{key:"formatNumber",value:function(t){return this.numberFormat?this.numberFormat.format(t):String(t)}},{key:"getFormatter",value:function(t){return this.relativeTimeFormatCache.get(this.locale,t)||this.relativeTimeFormatCache.put(this.locale,t,new p(this.locale,{style:t}))}},{key:"getLocaleData",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=G(this.locale);"string"==typeof t&&(t=[t]);var n=t=t.concat("long"),r=Array.isArray(n),i=0;for(n=r?n:n[Symbol.iterator]();;){var o;if(r){if(i>=n.length)break;o=n[i++]}else{if((i=n.next()).done)break;o=i.value}var a=o;if(e[a])return{flavour:a,localeData:e[a]}}}}])&&j(e.prototype,n),r&&j(e,r),t}();U.getDefaultLocale=p.getDefaultLocale,U.setDefaultLocale=p.setDefaultLocale,U.addLocale=function(t){!function(t){if(!t)throw new Error("[javascript-time-ago] No locale data passed.");D[t.locale]=t}(t),p.addLocale(t)},U.locale=U.addLocale;var W=n(363),H=n.n(W),q=n(17),z=n(355),V=new Map;V.set("Skipping Stones to Lonely Homes","skipping-stones"),V.set("Spikes 'n' Stuff","spikes-n-stuff"),V.set("1-2-3-Ban","1-2-3-ban"),V.set("2D Whale World","2d-whale-world"),V.set("A Sneeze A Day Keeps The Crates Away","a-sneeze-a-day"),V.set("Aaaah! I'm Being Attacked by a Giant Tentacle!","aaaah-i-m-being-attacked"),V.set("Alien Disco","alien-disco"),V.set("Atlas Shrank","atlas-shrank"),V.set("Barrier Trail","barrier-trail"),V.set("Beam Islands","beam-islands"),V.set("Block touching","block-touching"),V.set("Blocker snake","blocker-snake"),V.set("bomb n ice","bomb-n-ice"),V.set("Botsket Ball","botsket-ball"),V.set("Boxes & Balloons","boxes-and-balloons"),V.set("Boxes Love Bloxing Gloves","boxes-love-bloxing-gloves"),V.set("Bubble Butler: CMD REORGANIZE","bubble-butler"),V.set("Memories Of Castlemouse","castlemouse"),V.set("climbing cubes","climbing-cubes"),V.set("Closure Demake","closure-demake"),V.set("Coin Counter","coin-counter"),V.set("Collapsable Sokoban","collapsable-sokoban"),V.set("Collapse","collapse"),V.set("Covering holes","covering-holes"),V.set("Cubes barrier","cubes-barrier"),V.set("cubes medusa","cubes-medusa"),V.set("Cyber-Lasso","cyber-lasso"),V.set("Dang I'm Huge","dang-i-m-huge"),V.set("Dangerous Dungeon","dangerous-dungeon"),V.set("Directional","directional"),V.set("duality","duality"),V.set("Dungeon Janitor","dungeon-janitor"),V.set("dup-block","dup-block"),V.set("Easy Enigma","easy-enigma"),V.set("Electric wire","electric-wire"),V.set("Element Walkers","element-walkers"),V.set("Enqueue","enqueue"),V.set("Entanglement - Chapter One","entanglement-one"),V.set("Entanglement - Chapter Two","entanglement-two"),V.set("ESL Puzzle Game -- アダムのパズルゲーム","esl-puzzle-game"),V.set("Explod","explod"),V.set("Extra lives","extra-lives"),V.set("Fatigued square maze","fatigued-square-maze"),V.set("fire in winter","fire-in-winter"),V.set("Fish Friend","fish-friend"),V.set("Flying Kick","flying-kick"),V.set("Garten der Medusen","garten-der-medusen"),V.set("Gobble Rush!","gobble-rush"),V.set("Grouping","grouping"),V.set("Hack the Net","hack-the-net"),V.set("Hue change","hue-change"),V.set("i herd u liek water templs","i-herd-u-liek-water-templs"),V.set("🍡 -ooo- 🍡","ice-cream-stick"),V.set("Ice path","ice-path"),V.set("IceCrates","icecrates"),V.set("interconnection","interconnection"),V.set("Islands","islands"),V.set("Kettle","kettle"),V.set("Life is Hard","life-is-hard"),V.set("Lime Rick","lime-rick"),V.set("Linked","linked"),V.set("Maera Public Works","maera-public-works"),V.set("Magik","magik"),V.set("magnetic","magnetic"),V.set("Magnetized","magnetized"),V.set("Manic Ammo","manic-ammo"),V.set("MazezaM","mazezam"),V.set("MC Escher's Equestrian Armageddon","mc-escher-s-equestrian-armageddon"),V.set("Microban","microban"),V.set("Midas","midas"),V.set("Mirror Isles","mirror-isles"),V.set("Miss Direction","miss-direction"),V.set("Modality","modality"),V.set("monster mess","monster-mess"),V.set("Moving target","moving-target"),V.set("Mowing","mowing"),V.set("Multi-word Dictionary Game","multi-word-dictionary-game"),V.set("Newton's Crates","newton-s-crates"),V.set("Okosban","okosban"),V.set("out of bounds [lite demo v2]","out-of-bounds"),V.set("Out There","out-there"),V.set("Outward force","outward-force"),V.set("Overstep","overstep"),V.set("Pants, Shirt, Cap","pants-shirt-cap"),V.set("Path lines","path-lines"),V.set("Pathmaker","pathmaker"),V.set("Positional","positional"),V.set("Pot Wash Panic","pot-wash-panic"),V.set("pretender to the crown","pretender-to-the-crown"),V.set("PrograMaze","programaze"),V.set("purple","purple"),V.set("PUSH","push"),V.set("Pushcat Jr","pushcat-jr"),V.set("Rock, Paper, Scissors","rock-paper-scissors"),V.set("Roll those Sixes","roll-those-sixes"),V.set("rows and columns","rows-and-columns"),V.set("Scaling walls","scaling-walls"),V.set("Season Finale","season-finale"),V.set("Separation","separation"),V.set("skippa","skippa"),V.set("Sleepy players","sleepy-players"),V.set("Slidings","slidings"),V.set("Slime Swap","slime-swap"),V.set("Sokobond: The Demake","sokobond"),V.set("Sokoboros","sokoboros"),V.set("Some lines were meant to be crossed","some-lines-crossed"),V.set("Some pits","some-pits"),V.set("Spacekoban","spacekoban"),V.set("Spider's Hollow","spider-s-hollow"),V.set("Spikes 'n' Stuff","spikes-n-stuff"),V.set("Spooky Pumpkin Game","spooky-pumpkin-game"),V.set("square colours","square-colours"),V.set("Stairs","stairs"),V.set("Stairways","stairways"),V.set("Stand Off","stand-off"),V.set("sticky","sticky"),V.set("swap","swap"),V.set("SwapBot","swapbot"),V.set("Symbols","symbols"),V.set("Take Heart Lass","take-heart-lass"),V.set("Telefrag","telefrag"),V.set("Teleporters","teleporters"),V.set("the art of cloning","the-art-of-cloning"),V.set("The art of storage","the-art-of-storage"),V.set("the big dig","the-big-dig"),V.set("the copying","the-copying"),V.set("The fire calls","the-fire-calls"),V.set("the laser","the-laser"),V.set("The packing crate","the-packing-crate"),V.set("the switch","the-switch"),V.set("Then another","then-another"),V.set("Tiaradventur","tiaradventur"),V.set("Tidy the Cafe!","tidy-the-cafe"),V.set("tiny treasure hunt 1.0","tiny-treasure-hunt"),V.set("To nothing and back","to-nothing-and-back"),V.set("Train Braining","train-braining"),V.set("Train","train"),V.set("triple match","triple-match"),V.set("Tunnel Rat","tunnel-rat"),V.set("Unconventional Guns","unconventional-guns"),V.set("Vacuum","vacuum"),V.set("Vines","vines"),V.set("Wall-bonding","wall-bonding"),V.set("wall shuffle","wall-shuffle"),V.set("White Pillars","white-pillars");var K=V,Y=n(16),J=n(0);function X(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function $(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Z(t,e,n,r,i,o,a){try{var s=t[o](a),u=s.value}catch(t){return void n(t)}s.done?e(u):Promise.resolve(u).then(r,i)}function Q(t){return function(){var e=this,n=arguments;return new Promise(function(r,i){var o=t.apply(e,n);function a(t){Z(o,r,i,a,s,"next",t)}function s(t){Z(o,r,i,a,s,"throw",t)}a(void 0)})}}function tt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function et(t){var e=document.querySelector(t);if(!e)throw new Error('BUG: Could not find "'.concat(t,'" in the page'));return e}window.addEventListener("load",function(){var t="puzzlescriptGameProgress",e="puzzlescriptGameCheckpoint",n=et("title"),i=et("#theGame"),o=et("#gameSelection"),a=et("#loadingIndicator"),s=et("#authorSection"),u=et("#authorInfo"),l=et("#testShowNotificationButton"),c=et("#gameInstructionsButton"),f=et("#gameInstructionsButton2"),h=et("#gameInstructionsDialog"),d=et("#gameInstructionsDialogClose"),v=et("#enterFullscreen"),p=et("#exitFullscreen"),y=et("#messageDialog"),g=et("#messageDialogText"),m=et("#messageDialogClose");r.registerDialog(y),r.registerDialog(h),U.addLocale(H.a);var b=new U("en-US");if(!o)throw new Error("BUG: Could not find game selection dropdown");if(!a)throw new Error("BUG: Could not find loading indicator");var w=new(function(){function n(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),this.gameId="",this.levelNum=null}var r,i,a;return r=n,(i=[{key:"setGameId",value:function(t){this.gameId=t,this.levelNum=null,o.value=t}},{key:"getGameId",value:function(){if(""===this.gameId)throw new Error("BUG: Did not set game id");return this.gameId}},{key:"hasGame",value:function(){return!!this.gameId}},{key:"getLevelNum",value:function(){if(null===this.levelNum)throw new Error("BUG: Did not set level num");return this.levelNum}},{key:"setGameAndLevel",value:function(t,e){this.gameId=t,this.levelNum=e,o.value=t}},{key:"loadStorage",value:function(){return this.loadJson(t,{_version:2})}},{key:"loadCurrentLevelNum",value:function(){var t=this.getGameId(),e=this.loadStorage()[t];return e?e.currentLevelNum:null}},{key:"loadCheckpoint",value:function(){var t=this.getGameId();return this.loadJson("".concat(e,".").concat(t),null)}},{key:"saveCurrentLevelNum",value:function(e){var n=this.getGameId(),r=this.loadStorage();r[n]=r[n]||{},r[n].currentLevelNum=e,r[n].completedLevelAt=Date.now(),r[n].lastPlayedAt=Date.now(),this.saveJson(t,r),ga&&ga("send","event","game","level",n,e),w.levelNum=e}},{key:"saveGameInfo",value:function(e,n){var r=this.getGameId(),i=this.loadStorage();i[r]=i[r]||{},i[r].levelMaps=e.map(function(t){return"LEVEL_MAP"===t.type}),i[r].title=n,i[r].lastPlayedAt=Date.now(),this.saveJson(t,i)}},{key:"saveCheckpoint",value:function(t){var n=this.getGameId(),r={_version:2,levelNum:this.getLevelNum(),data:t};this.saveJson("".concat(e,".").concat(n),r)}},{key:"getNumberOfPlayedGames",value:function(){var t=this.loadStorage();return Object.keys(t).length-1}},{key:"loadJson",value:function(t,e){var n=window.localStorage.getItem(t);return n?JSON.parse(n):e}},{key:"saveJson",value:function(t,e){window.localStorage.setItem(t,JSON.stringify(e))}}])&&tt(r.prototype,i),a&&tt(r,a),n}());!function(){var n=w.loadStorage(),r=n;if(1===r._version){var i=new Map;i.set("gist-f0b9b8e95d0bc87c9fb9e411756daa23","icecrates"),i.set("gist-7f4470ab80d9f7ffe4b9e28c83b26adc","push"),i.set("pot-wash-panic_itch","pot-wash-panic"),i.set("gist-457c6d8be68ffb6d921211d40ca48c15","pants-shirt-cap⁣"),i.set("gist-e13482e035a5f75e9b0e4d0b5f28f8b6","pushcat-jr⁣"),i.set("separation_itch","separation⁣"),i.set("roll-those-sixes-itch","roll-those-sixes⁣"),i.set("gist-6daa8b63cf79202cd085c1b168048c09","rock-paper-scissors"),i.set("gist-c5ec035de4e0c145a85327942fb76098","some-lines-crossed⁣"),i.set("sleepy-player_itch","sleepy-players⁣"),i.set("skipping-stones_d6fd6fcf84de185e2584","skipping-stones"),i.set("gist-8074d60a0af768f970ef055d4460414d","bubble-butler"),i.set("gist-ee39bfe12012c774acfc5e3d32fb4f89","boxes-and-balloons⁣"),i.set("mirror-isles_219a7db6511dad557b84","mirror-isles⁣"),i.set("gist-e86e1d6cf24307499c1cd1aaaa733a91","swapbot⁣"),i.set("spikes-n-stuff_dc5c4a669e362e389e994025075f7d0b","spikes-n-stuff⁣"),i.set("aunt-floras-mansion","aunt-flora-s-mansion"),i.set("spacekoban_6a6c07f71d7039e4155e","spacekoban⁣"),i.set("gist-181f370a15625905ca6e844a972a4abf","miss-direction⁣"),i.set("gist-711d6220e4fe2a36254cc544c6ba4885","castlemouse⁣"),i.set("rosden.itch.io_islands","islands⁣"),i.set("rosden.itch.io_bomb-n-ice","bomb-n-ice⁣"),i.set("cyber-lasso-e3e444f7c63fb21b6ec0","cyber-lasso⁣"),i.set("boxes-love-bloxing_c2d717a77f9aa02ecb1b793111f3a921","boxes-love-bloxing-gloves⁣"),i.set("hack-the-net_8b5eb39cb825277832d261b3142f084b","hack-the-net⁣"),i.set("spooky-pumpkin_7242443","spooky-pumpkin-game⁣"),i.set("gist-b6c8ba9363b4cca270d8ce5e88f79abf","vacuum⁣"),i.set("gist-542b97948cb1d377dce6d276c0bcd9d5","sokoboros⁣"),i.set("gist-2b9ece642cd7cdfb4a5f2c9fa8455e40","beam-islands⁣"),i.set("entanglement","entanglement-one");var o=!0,a=!1,s=void 0;try{for(var u,l=i.entries()[Symbol.iterator]();!(o=(u=l.next()).done);o=!0){var c=$(u.value,2),f=c[0],h=c[1],d=n[f];d&&(delete n[f],n[h]=d);var v="".concat(e,".").concat(f),p=window.localStorage.getItem(v);p&&(window.localStorage.setItem("".concat(e,".").concat(h),p),window.localStorage.removeItem(v))}}catch(t){a=!0,s=t}finally{try{o||null==l.return||l.return()}finally{if(a)throw s}}r._version=2,w.saveJson(t,n)}}(),m.addEventListener("click",function(){y.close(),i.focus()}),c.addEventListener("click",function(){h.showModal()}),f.addEventListener("click",function(){h.showModal()}),d.addEventListener("click",function(){h.close(),i.focus()}),v.addEventListener("click",function(){document.body.classList.add("is-zen-screen"),ot.resize(),i.focus()}),p.addEventListener("click",function(){document.body.classList.remove("is-zen-screen"),i.focus(),ot.resize()});var _={onMessage:function(){var t=Q(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(J.j)(10,function(){return!ot.inputWatcher.isSomethingPressed()});case 2:return g.textContent=e,y.showModal(),m.focus(),t.next=7,Object(J.j)(10,function(){return!y.open});case 7:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),onLevelChange:function(t){a.classList.add("hidden"),o.removeAttribute("disabled"),mt(w.getGameId(),t),w.saveCurrentLevelNum(t),ht()},onGameChange:function(t){var e=t.metadata.backgroundColor;(e=e||new Y.a({code:"",sourceOffset:0},"#000000")).toRgb().isDark()?window.document.body.classList.add("is-background-dark"):window.document.body.classList.remove("is-background-dark"),window.document.body.style.backgroundColor=e.toHex();var r,i=t.metadata,a=i.author,l=i.homepage;a&&(u.textContent=a,l?u.setAttribute("href",/^https?:\/\//.test(r=l)?r:"http://".concat(r)):u.removeAttribute("href"),s.classList.remove("hidden")),w.saveGameInfo(t.levels,t.title),o.value=w.getGameId(),n.textContent=t.title},onTick:function(t,e){e&&w.saveCheckpoint(e)}};function S(t,e){var n=o.querySelector("option[value='".concat(t,"']"));if(n)n.textContent=e;else{var r=document.createElement("option");r.setAttribute("value",t),r.textContent=e,o.appendChild(r)}}o.querySelectorAll("option").forEach(function(t,e){t.setAttribute("data-original-index","".concat(e))});var k=[],E=new Set;function T(t,e){k.push({id:t,title:e}),E.add(t)}for(var O=Array.from(o.querySelectorAll("option[value]:not([value='...more...'])")),x=0;x<O.length;x++){var C=O[x];C.remove(),T(C.getAttribute("value")||"BUG:SHOULD_ALWAYS_HAVE_A_VALUE",C.textContent||"BUG:SHOULD_ALWAYS_HAVE_A_TITLE")}var M=!0,R=!1,I=void 0;try{for(var A,L=K.entries()[Symbol.iterator]();!(M=(A=L.next()).done);M=!0){var P=$(A.value,2),N=P[0],D=P[1];E.has(D)||T(D,N)}}catch(t){R=!0,I=t}finally{try{M||null==L.return||L.return()}finally{if(R)throw I}}var G=w.loadStorage();for(var B in G){if("_version"!==B&&!o.querySelector("option[value='".concat(B,"']")))S(B,K.get(B)||B)}if(window.location.hash){var F=$(window.location.hash.substring(1).split("|"),2),j=F[0],W=F[1];S(j,K.get(j)||j),w.setGameAndLevel(j,W?Number.parseInt(W,10):null)}for(var V=0;V<k.length;V++){var Z=k[V];if(S(Z.id,Z.title),at()>=5)break}if(S("...more...","More Games..."),ht(),!w.hasGame()){var nt=o.querySelector("option[value]"),rt=nt?nt.getAttribute("value"):null;rt&&w.setGameId(rt)}if(!i)throw new Error("BUG: Could not find table on the page");var it=new Worker("./puzzlescript-webworker.js"),ot=new z.a(it,i,_);function at(){return o.querySelectorAll("option[value]:not([value='...more...'])").length}function st(){a.classList.remove("hidden"),s.classList.add("hidden"),o.setAttribute("disabled","disabled"),fetch("./games/".concat(w.getGameId(),"/script.txt"),{redirect:"follow"}).then(function(t){if(t.ok)return t.text().then(function(t){var e=null!==w.levelNum?w.levelNum:w.loadCurrentLevelNum(),n=w.loadCheckpoint();if(n){var r=n.levelNum,i=n.data;if(e!==r)throw new Error("BUG: Checkpoint level number (".concat(r,") does not match current level number (").concat(e,")"));ot.setGame(t,e||0,i)}else ot.setGame(t,e||0,null);o.value=w.getGameId()});alert("Problem finding game file. Please choose another one"),a.classList.add("hidden"),o.removeAttribute("disabled")},function(t){alert("Could not download the game. Are you connected to the internet?"),console.error(t),a.classList.add("hidden"),o.removeAttribute("disabled")})}ot.inputWatcher&&setInterval(function(){ot.inputWatcher.gamepad.isRecognized()?(ut.classList.contains("enabled")||ga&&ga("send","event","gamepad","recognized"),ut.classList.add("enabled"),lt.classList.add("hidden"),ct.classList.remove("hidden"),ft.classList.add("hidden"),y.open&&ot.inputWatcher.gamepad.isButtonPressed(q.a.CLUSTER_BOTTOM)&&m.click()):ot.inputWatcher.gamepad.isSomethingConnected()?(ft.classList.contains("hidden")&&ga&&ga("send","event","gamepad","something-connected"),ut.classList.remove("enabled"),lt.classList.add("hidden"),ct.classList.add("hidden"),ft.classList.remove("hidden")):(ut.classList.remove("enabled"),lt.classList.remove("hidden"),ct.classList.add("hidden"),ft.classList.add("hidden"))},200),st(),o.addEventListener("change",function(t){"...more..."===o.value?(!function(){var t=w.getNumberOfPlayedGames(),e=at();if(e>=1.5*t)alert("Try ".concat(Math.ceil(e-1.5*t)," more game(s) to unlock more"));else{for(var n=0;n<k.length;n++){var r=k[n];if(S(r.id,r.title),at()-t>=1.5*t)break}ht(),alert("Games unlocked!")}}(),o.value=w.getGameId()):o.value&&(w.setGameAndLevel(o.value,null),st())});var ut=et("#gamepadIcon"),lt=et("#gamepadDisabled"),ct=et("#gamepadRecognized"),ft=et("#gamepadNotRecognized");function ht(){var t,e,n=w.loadStorage(),r=(t="option",e=[],o.querySelectorAll(t).forEach(function(t){return e.push(t)}),e),i=!0,a=!1,s=void 0;try{for(var u,l=r[Symbol.iterator]();!(i=(u=l.next()).done);i=!0){var c=u.value,f=c.getAttribute("value");if(f){var h=n[f];if(h&&h.levelMaps){var d=h.levelMaps.slice(0,h.currentLevelNum).filter(function(t){return t}).length,v=h.levelMaps.filter(function(t){return t}).length,p=Math.floor(100*d/v);c.setAttribute("data-percent-complete","".concat(p)),c.setAttribute("data-last-played-at","".concat(h.lastPlayedAt)),c.textContent="".concat(h.title," (").concat(p,"% ").concat(b.format(h.lastPlayedAt),")")}else f&&(c.setAttribute("data-percent-complete","0"),c.setAttribute("data-last-played-at","0"))}}}catch(t){a=!0,s=t}finally{try{i||null==l.return||l.return()}finally{if(a)throw s}}var y=o.value,g=[],m=[],_=[],S=[],k=Date.now()-2592e6,E=!0,T=!1,O=void 0;try{for(var x,C=r[Symbol.iterator]();!(E=(x=C.next()).done);E=!0){var M=x.value,R=Number.parseInt(M.getAttribute("data-percent-complete")||"0",10),I=Number.parseInt(M.getAttribute("data-last-played-at")||"0",10);M.getAttribute("value")&&(100===R?S.push(M):I?I<k?_.push(M):g.push(M):m.push(M))}}catch(t){T=!0,O=t}finally{try{E||null==C.return||C.return()}finally{if(T)throw O}}var A=function(t,e){var n=Number.parseInt(t.getAttribute("data-last-played-at")||"0",10);return Number.parseInt(e.getAttribute("data-last-played-at")||"0",10)-n};g.sort(A),_.sort(A),S.sort(A),m.sort(function(t,e){var n=t.getAttribute("data-original-index"),r=e.getAttribute("data-original-index"),i=n?Number.parseInt(n,10):null,o=r?Number.parseInt(r,10):null;return null!==i&&null!==o?i-o:t.textContent?e.textContent&&t.textContent.toLowerCase()<e.textContent.toLowerCase()?-1:1:-1});var L=!0,P=!1,N=void 0;try{for(var D,G=r[Symbol.iterator]();!(L=(D=G.next()).done);L=!0){var B=D.value;o.removeChild(B)}}catch(t){P=!0,N=t}finally{try{L||null==G.return||G.return()}finally{if(P)throw N}}g.length>0&&g.unshift(dt("Continue playing")),m.length>0&&m.unshift(dt("New")),_.length>0&&_.unshift(dt("Uncompleted")),S.length>0&&S.unshift(dt("Completed"));var F=[].concat(g,m,_,S);o.append.apply(o,X(F));var j=o.querySelector("option[value='...more...']");j&&(j.remove(),o.appendChild(j)),o.value=y}function dt(t){var e=document.createElement("option");return e.setAttribute("disabled","disabled"),e.textContent="--- ".concat(t),e}var vt=et("#disableCss");function pt(t){t||ga&&ga("send","event","accessibility","toggle",vt.checked?"show":"hide"),vt.checked?i.classList.add("ps-ui-disabled"):i.classList.remove("ps-ui-disabled"),i.focus()}vt.addEventListener("change",function(){return pt(!1)}),pt(!0);var yt=et("#btnAdd"),gt=null;window.addEventListener("beforeinstallprompt",function(t){t.preventDefault(),gt=t,yt.classList.remove("hidden")}),yt.addEventListener("click",function(t){yt.classList.add("hidden"),gt&&gt.prompt(),gt&&gt.userChoice.then(function(){gt=null})});var mt=function(t,e){if(window.location.hash="#".concat(t,"|").concat(e),ga){var n=window.location,r=n.pathname,i=n.search;ga("set","page","".concat(r).concat(i,"#").concat(t,"|").concat(e)),ga("send","pageview")}};l.addEventListener("click",Q(regeneratorRuntime.mark(function t(){var e,n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e="You are playing level ".concat((w.levelNum||0)+1," of ").concat(w.gameId||"unknown-game"),n={body:e,icon:"./pwa-icon.png",badge:"./pwa-icon.png",vibrate:[200,100,200],actions:[{action:"action-1",title:"Option 1"},{action:"action-2",title:"Option 2"}]},t.next=4,new Promise(function(t){"undefined"!=typeof Notification?Notification.requestPermission(function(){var r=Q(regeneratorRuntime.mark(function r(i){var o,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(o=function(){new Notification("Test Title",n),t()},"granted"!==i){r.next=18;break}if(!navigator.serviceWorker){r.next=15;break}return r.next=5,navigator.serviceWorker.ready;case 5:if(!(a=r.sent).showNotification){r.next=12;break}return r.next=9,a.showNotification("Test Title",n);case 9:t(),r.next=13;break;case 12:o();case 13:r.next=16;break;case 15:o();case 16:r.next=20;break;case 18:alert(e),t();case 20:case"end":return r.stop()}},r,this)}));return function(t){return r.apply(this,arguments)}}()):(alert(e),t())});case 4:case"end":return t.stop()}},t,this)})))})}]);
//# sourceMappingURL=pwa-app.js.map